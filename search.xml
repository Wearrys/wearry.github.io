<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Cryptography Notes]]></title>
    <url>%2F2020%2Fcryptography%2F</url>
    <content type="text"><![CDATA[Some notes of ðŸ”’ cryptography lessons Preliminary: Discrete ProbabilitySuppose $U$ is a finite set. Probability Distribution a probability distribution $P$ over $U$ is a function P: U \rightarrow [0,1]s.t. \sum_{x \in U} P(x) = 1 Some examples: Uniform distribution: $\forall x \in U, P(x) = \dfrac{1}{|U|}$ Pointed distribution: $\exists x \in U, P(x) = 1$ Event an event is a subset $E$ of $U$, define the probability of $E$ under probability distribution $P$ as below: Pr[E] = \sum_{x \in E} P(x) The Union BoundBy definition, we can obviously get: Pr[A_1 \cap A_2] + Pr[A_1 \cup A_2] = Pr[A_1] + Pr[A_2]Which also implies that: Pr[A_1 \cup A_2] \le Pr[A_1] + Pr[A_2]Random Variable a random variable $X$ is a function X:U \rightarrow Vwhere $V$ is range of $X$ Example 1: \begin{aligned} X:\{0, 1\}^n \rightarrow \{0, 1\} \\ X(b) = LSB(b) \in \{0, 1\} \end{aligned}As you can see, random variable $X$ can also induce probability distribution from $U$ to $V$ (Suppose $P$ is a distribution on $U$): \forall v \in V, Q(v) = Pr[X = v] = Pr[X^{-1}(v)] 1. LSB is a function which gets the last significant bit of a bit-string &#8617; Uniform Random VariableSpecially, when $P$ is uniform distribution and $X(r) = r$ for all $r \in U$, then: \forall r \in U, Pr[X = r] = \frac{1}{|U|}this is called uniform random variable, denoted by $X \xleftarrow{R} U$ Independence Two events $A, B$ are independent iff: $Pr[A \cap B] = Pr[A] \times Pr[B]$ Two random variables $A, B$ are independent iff $\forall a \in V_A, b \in V_B$: Pr[A = a \,\,\mathrm{and}\,\, B = b] = Pr[A = a] \times Pr[B = b] For better understanding of independency, consider the example below:Suppose a dice numbered by $D = \{1, 2, \dots, 6\}$ and 2 random variables $A, B$: \begin{aligned} &A:D \rightarrow \{0, 1\} &A(x) = [x \equiv 0 \pmod 2] \\ &B:D \rightarrow \{0, 1\} &B(x) = [x \equiv 0 \pmod 3] \end{aligned}For uniform distribution of $D$, $A, B$ are obviously independent. Think about conditions below: $B(x) = [x \equiv 0 \pmod 4]$ $D = \{1, 2, \dots, 5\}$ I: Information Theoretic SecurityThroughout history, there were many ways of encryption, however, some of them have been proved unsafe. The question now is whether a particular cipher is secure. Cipher A cipher defined over a triple $(\mathcal{K, M, C})$ is a pair of efficient2 algos $(E, D)$ where: \begin{aligned} E: \mathcal{K \times M} \rightarrow \mathcal{C} \\ D: \mathcal{K \times C} \rightarrow \mathcal{M} \end{aligned}s.t. $\forall m \in \mathcal{M}, k \in \mathcal{K}$ m = D(k, E(k, m))and $\mathcal{K, M, C}$ denote the space of keys, messages and cipher texts. One Time PadAn example cipher over $\mathcal{K, M, C} = \{0, 1\}^n$ and: \begin{aligned} E(k, m) = k \oplus m \\ D(k, m) = k \oplus m \\ \end{aligned} 2. Theoretically, efficient means runs in polynomial time; Practically it means runs within a certain time period. &#8617; Perfect SecrecyThe basic idea behind perfect secrecy is: cipher text should reveal no â€œinfoâ€ about plain text. A cipher $(E, D)$ over $\{\mathcal{K, M, C}\}$ has perfect secrecy iff:$\forall m_0, m_1 \in \mathcal{M} \,\,\mathrm{that}\,\, |m_0| = |m_1|, c \in \mathcal{C}$: Pr[E(k, m_0) = c] = Pr[E(k, m_1) = c]where $k \xleftarrow{R} \mathcal{K}$]]></content>
      <tags>
        <tag>Number Theory</tag>
        <tag>Probability</tag>
        <tag>Induction</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è‹¥å¹²è¶£é¢˜]]></title>
    <url>%2F2020%2Fexercise-of-thoughts%2F</url>
    <content type="text"><![CDATA[å†™åœ¨å‰é¢å®…å®¶æ²¡äº‹çš„æ—¶å€™æ‰¾çš„ä¹å­ï¼Œä¸å®šæœŸæ›´æ–°ï¼Œå¤§æ¦‚ã€‚ 1Descriptionæœ‰ $n$ ä¸ªäººï¼Œå…¶ä¸­æœ‰å¥½æœ‰åï¼Œæ¯ä¸ªäººéƒ½çŸ¥é“å…¶ä»–ä»»ä½•äººæ˜¯å¥½æ˜¯åï¼ŒçŽ°åœ¨å¯ä»¥è¿›è¡Œè‹¥å¹²æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®å½¢å¦‚ $(i, j)$ï¼Œè¡¨ç¤ºé—®ç¬¬ $i$ ä¸ªäººç¬¬ $j$ ä¸ªäººæ˜¯å¦æ˜¯å¥½äºº $(i \neq j)$ï¼ŒåŒæ—¶å¥½äººä¸€å®šè¯´çœŸè¯ï¼Œåäººå¯èƒ½è¯´å‡è¯ï¼Œé—®ï¼š å¦‚æžœæœ‰å¤šäºŽä¸€åŠçš„äººæ˜¯å¥½çš„ï¼Œæ˜¯å¦å­˜åœ¨ç­–ç•¥èƒ½å¤Ÿåœ¨ä¸è¶…è¿‡ $n$ æ¬¡è¯¢é—®ä¸‹ç¡®å®šä¸€ä¸ªå¥½äººã€‚ å¦‚æžœæœ‰æ°å¥½ä¸€åŠçš„äººæ˜¯åäººï¼Œæ˜¯å¦å­˜åœ¨ä¸Šè¿°ç­–ç•¥ã€‚ Solution1è€ƒè™‘ç»´æŠ¤ä¸€ä¸ªåºåˆ—ï¼Œåˆå§‹æ—¶åŠ å…¥ç¼–å·ä¸º $1$ çš„äººï¼ŒæŽ¥ä¸‹æ¥ä¾æ¬¡å°†å…¶ä»–äººåŠ å…¥ï¼Œæ¯æ¬¡åŠ å…¥çš„æ—¶å€™è¯¢é—®åºåˆ—æœ«å°¾çš„äººè¿™ä¸ªäººæ˜¯å¥½äººè¿˜æ˜¯åäººï¼Œå¦‚æžœç­”æ¡ˆæ˜¯åäººåˆ™åˆ é™¤æœ«å°¾ï¼Œå¦åˆ™å°†è¿™ä¸ªæ–°åŠ å…¥çš„ä½œä¸ºæœ«å°¾ï¼Œæ­£ç¡®æ€§ä¸éš¾éªŒè¯ï¼š æ¯æ¬¡åˆ é™¤çš„è‡³å°‘æœ‰ä¸€ä¸ªåäººï¼Œå› æ­¤æœ€åŽåºåˆ—å‰©ä¸‹çš„äººä¸­è‡³å°‘æœ‰ä¸€ä¸ªå¥½äººã€‚ å¦‚æžœåºåˆ—ä¸­è‡³å°‘æœ‰ä¸€ä¸ªå¥½äººï¼Œåˆ™åºåˆ—çš„æœ«å°¾ä¸€å®šä¹Ÿæ˜¯å¥½äººã€‚ 2ä¸èƒ½ï¼Œå¦‚æžœæ‰€æœ‰åäººéƒ½æ°¸è¿œè¯´è°Žï¼Œåˆ™ä»–ä»¬ä¸Žå¥½äººæ²¡æœ‰åŒºåˆ«ã€‚ 2å·´å¡žå°”å…¬å¼ \sum_{n=1}^{\infty} \frac{1}{n^2} = \frac{\pi^2}{6}è¯æ˜Žé¦–å…ˆæ³¨æ„åˆ°ï¼š \begin{aligned} I=&\int_0^1 \mathrm{d} x \int_0^1 \frac{1}{1-xy} \mathrm{d} y \\ =&\iint_D \sum_{i=0}^{\infty} (xy)^i \mathrm{d}x\mathrm{d}y \\ =&\sum_{i=0}^{\infty} \iint_D (xy)^i \mathrm{d}x\mathrm{d}y \\ =&\sum_{i=0}^{\infty} \left(\int_0^1 x^i \mathrm{d} x\right)^2 \\ =&\sum_{i=1}^{\infty} \frac{1}{i^2} \end{aligned}æ•…åªéœ€è¯æ˜Ž $I = \dfrac{\pi^2}{6}$ å³å¯ï¼Œè€ƒè™‘å˜é‡æ›¿æ¢ï¼š \begin{cases} x = u + v \\ y = u - v \end{cases}, \frac{\partial(x, y)}{\partial(u, v)} = \left|\begin{matrix} 1 & 1 \\ 1 & -1 \end{matrix} \right| = -2åˆ™ï¼š \begin{aligned} I &= 2 \iint_{D_{uv}} \frac{1}{1 - u^2 + v^2} \mathrm{d} u \mathrm{d} v \\ &= 4 \left(\int_0^{\frac{1}{2}} \mathrm{d} u \int_0^{u} \frac{1}{1-u^2+v^2} \mathrm{d} v + \int_{\frac{1}{2}}^{1} \mathrm{d}u \int_0^{1-u} \frac{1}{1-u^2+v^2} \mathrm{d} v\right) \\ &= 4 \left(\int_0^{\frac{1}{2}} \frac{1}{\sqrt{1-u^2}} \arctan \frac{u}{\sqrt{1-u^2}} \mathrm{d} u + \int_{\frac{1}{2}}^{1} \frac{1}{\sqrt{1-u^2}} \arctan \frac{1-u}{\sqrt{1-u^2}} \mathrm{d} u\right) \\ &= 4 \left(\int_0^{\frac{1}{2}} \arctan \frac{u}{\sqrt{1-u^2}} \mathrm{d} \arctan \frac{u}{\sqrt{1-u^2}} -2 \int_{\frac{1}{2}}^1 \arctan \frac{1-u}{\sqrt{1-u^2}} \mathrm{d} \arctan \frac{1-u}{\sqrt{1-u^2}} \right) \\ &= 4 \times \frac{1}{2} \times \left(\frac{\pi}{6}\right)^2 + 4 \times \left(\frac{\pi}{6}\right)^2 = \frac{\pi^2}{6} \\ && \square \end{aligned}åº”ç”¨ ä»»å–ä¸¤ä¸ªæ­£æ•´æ•°ï¼Œæ±‚å®ƒä»¬äº’è´¨çš„æ¦‚çŽ‡ è€ƒè™‘ä»»æ„è´¨å› å­ $p$ï¼Œå¦‚æžœä¸¤ä¸ªæ•°åŒæ—¶æ˜¯ $p$ çš„å€æ•°ï¼Œåˆ™ä¸ä¼šäº’è´¨ï¼Œè¿™ä¸ªæ¦‚çŽ‡æ˜¾ç„¶ä¸º $\dfrac{1}{p^2}$ï¼Œå› æ­¤äº’è´¨çš„æ¦‚çŽ‡å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š \begin{aligned} P &= \prod_{p\, \mathrm{is\ prime}} \left(1 - \frac{1}{p^2}\right) \\ &= \prod_{p\, \mathrm{is\ prime}} \cfrac{1}{\sum_{i=0}^{\infty} \left(\cfrac{1}{p^2}\right)^i} \\ &= \frac{1}{\sum_{i=1}^{\infty} \frac{1}{i^2}} \\ &= \frac{6}{\pi^2} \end{aligned}]]></content>
      <tags>
        <tag>Combinatorial</tag>
        <tag>Induction</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[äº’æµ‹é¢˜æ€»ç»“]]></title>
    <url>%2F2018%2Fproblem-select%2F</url>
    <content type="text"><![CDATA[StringDescription ç§°ä¸€ä¸ªä»…ç”±a, b, cç»„æˆçš„å­—ç¬¦ä¸² $S$ æ˜¯å¹³è¡¡çš„å½“ä¸”ä»…å½“å¯¹äºŽ $S$ çš„ä»»æ„ä¸€ä¸ªè¿žç»­å­ä¸² $T$, ä»»æ„ä¸¤ç§å­—ç¬¦çš„å‡ºçŽ°æ¬¡æ•°ä¹‹å·®éƒ½å°äºŽç­‰äºŽ $k$, æ±‚é•¿åº¦ä¸º $n$ çš„å¹³è¡¡ä¸²çš„æ•°é‡. $n \le 10^9, K \le 8$ Solutionå®šä¹‰ $f_{a, b}(i)$ è¡¨ç¤ºåœ¨å‰ $i$ ä¸ªå­—ç¬¦ä¸­ a å’Œ b å‡ºçŽ°æ¬¡æ•°ä¹‹å·®, åœ¨åªè€ƒè™‘ a, b ä¸¤ç§å­—ç¬¦çš„æ¡ä»¶ç­‰ä»·äºŽ: \max_{i=1}^{n} f_{a, b}(i) - \min_{i=1}^{n} f_{a, b}(i) \le kæ³¨æ„åˆ°å¦‚æžœ $f_{a, b}$ çš„å€¼åŸŸåŒºé—´é•¿åº¦ä¸º $len$, åˆ™è¢«æ‰€æœ‰é•¿åº¦ä¸º $k$ çš„å€¼åŸŸåŒºé—´è®¡ç®—çš„æ¬¡æ•°æ˜¯ $k - len + 1$.è®° $g(x, y, z)$ è¡¨ç¤ºä¸‰ç§ $f$ çš„å€¼åŸŸåŒºé—´é•¿åº¦é™åˆ¶åˆ†åˆ«ä¸º $x, y, z$ æ—¶çš„æ–¹æ¡ˆæ•°, é‚£ä¹ˆå¯ä»¥å®¹æ–¥è®¡ç®—ç­”æ¡ˆ: ans = g(k, k, k) - 3 g(k, k, k-1) + 3 g(k, k-1, k-1) - g(k-1, k-1, k-1)è€ƒè™‘å¦‚ä½•è®¡ç®— $g(x, y, z)$, ä»¥ $x$ ä¸ºä¾‹, æ¯ä¸€ä¸ªåˆæ³•çš„åŒºé—´ä¸€å®šå¯ä»¥è¡¨ç¤ºæˆ $s_x + l_x \mid l_x \in [0, x]$ çš„å½¢å¼. å› ä¸ºåˆå§‹çŠ¶æ€çš„ $l$ ç¡®å®šäº† $s$ , æŽ¥ä¸‹æ¥çš„è½¬ç§»åªéœ€è¦ä¿è¯ $l$ çš„èŒƒå›´å³å¯, ç”±äºŽ: f_{a, b}(i) - f_{a, c}(i) = f_{c, b}(i)è€ƒè™‘å¯¹äºŽ $z$ çš„é™åˆ¶, æœ‰: s_z + s_y - s_x \le l_x - l_y \le s_z + s_y - s_x + l_zæ¯æ¬¡è½¬ç§»ä¹‹å‰æžšä¸¾ä¸€ä¸‹ $s_z + s_y - s_x$ å³å¯, è¿™æ ·çŠ¶æ€åªéœ€è¦è€ƒè™‘ $l_x, l_y$ å³å¯, å¹¶ä¸”åˆå§‹çŠ¶æ€å”¯ä¸€ç¡®å®š $s_x, s_y, s_z$. SequenceDescription å¯¹é•¿åº¦ä¸º $n$ çš„åºåˆ— $\{a_i\}$, å®šä¹‰ $sum(l, r)$ ä¸ºç¬¬ $l$ åˆ° $r$ é¡¹çš„å…ƒç´ ä¹‹å’Œ, $inc(l, r)$ ä¸ºç¬¬ $l$ åˆ° $r$ é¡¹çš„éžç©ºä¸Šå‡å­åºåˆ—çš„æœ€å¤§æƒå€¼å’Œ, æ±‚ $\max_{1 \le l,\, r \le n} sum(l, r) - inc(l, r)$, ä»¥åŠåŒæ—¶æ»¡è¶³åŒºé—´é•¿åº¦æœ€å°çš„ $(l, r)$ çš„æ•°é‡. $n \le 2 \times 10^5, |a_i| \le 40$ Solutionç”±äºŽæƒå€¼çš„èŒƒå›´æ¯”è¾ƒå°, $inc$ çš„èŒƒå›´ä¹Ÿä¸å¤§, åŒæ—¶ä¸€å®šå­˜åœ¨æ–¹æ¡ˆä½¿å¾— $inc$ ä¸­åªåŒ…å«æ­£æ•°. è€ƒè™‘ä»Žå·¦åˆ°å³æžšä¸¾å³ç«¯ç‚¹, ç”±äºŽæœ€å°åŒ–åŒºé—´é•¿åº¦çš„éœ€è¦, è®°å½• $dp(i, j)$ è¡¨ç¤ºå³è¾¹ç•Œä¸è¶…è¿‡å½“å‰æžšä¸¾çš„ä½ç½®, æœ€é•¿ä¸Šå‡å­åºåˆ—çš„æƒå€¼å’Œä¸º $i$ ä¸”æœ€åŽä¸€ä½çš„æƒå€¼ä¸º $j$ æ—¶æœ€é å³çš„å·¦ç«¯ç‚¹çš„ä½ç½®. è½¬ç§»å¯ä»¥åšåˆ° $O(n |a_i|^3)$ æŽ¥ä¸‹æ¥è€ƒè™‘è®¡ç®—ç­”æ¡ˆ, ä»Žå¤§åˆ°å°æžšä¸¾ $inc$ å¯èƒ½çš„å€¼, å¹¶æ±‚å…¶æœ€é å³çš„å·¦ç«¯ç‚¹å¦‚æžœå·¦ç«¯ç‚¹æ˜¯å•è°ƒå¢žçš„åˆ™è¯´æ˜Žé€‰æ‹©ä¸­é—´è¿™éƒ¨åˆ†çš„å·¦ç«¯ç‚¹ $inc$ ä¼šå‘ç”Ÿå˜åŒ–, æ‰¾ä¸€ä¸ªèƒ½æœ€ä¼˜åŒ– $sum$ çš„åŒæ—¶åŒºé—´é•¿åº¦æœ€å°çš„å·¦ç«¯ç‚¹å³å¯. GameDescription $n$ ä¸ªäººåœ¨ä¸€èµ·çŽ©æ¸¸æˆæ¯ä¸ªäººåˆå§‹æœ‰ä¸€å¼ ç‰Œ, ç‰Œä¸Šçš„æ•°å­—æž„æˆä¸€ä¸ª $1-n$ çš„æŽ’åˆ—, æ‰€æœ‰äººä»Žå·¦åˆ°å³è¿›è¡Œå†³ç­–: ç¿»å¼€è‡ªå·±çš„ç‰Œå¹¶ç•™åœ¨åŽŸåœ°, æˆ–è€…é€‰ä¸€ä¸ªä¹‹å‰çš„äººä¸Žå…¶äº¤æ¢æ‰‹ä¸­çš„ç‰Œå¹¶ç¦»å¼€æ¸¸æˆ, ä¹‹å‰çš„äººå°†ä»–çš„ç‰Œç¿»å¼€. æ¯ä¸ªäººéƒ½ä¼šé‡‡å–æœ€ä½³ç­–ç•¥, å¹¶å¸Œæœ›è‡ªå·±æ‰‹ä¸­çš„ç‰Œä¸Šçš„æ•°å­—å°½å¯èƒ½å¤§. å®šä¹‰ $E(n)$ ä¸º $n$ ä¸ªäººè¿›è¡Œæ¸¸æˆæœ€åŽç•™åœ¨åŽŸåœ°çš„äººçš„æ•°é‡çš„æœŸæœ›. \begin{aligned} S_k(n) = \begin{cases} E(n) & \text{k = 0} \\ \sum_{i=1}^{n} S_{k-1}(i) & \text{otherwise} \\ \end{cases} \end{aligned}æ±‚ $S_k(n)$, ä¿ç•™ $10$ ä½æœ‰æ•ˆæ•°å­—. $k \le 50, n \le 10^{15}$ Solutioné¦–å…ˆéœ€è¦åˆ†æžæ¯ä¸ªäººçš„ç­–ç•¥, å·²çŸ¥çš„ä¿¡æ¯æœ‰ä¸¤éƒ¨åˆ†, ç•™åœ¨åŽŸåœ°çš„äººæ‰‹ä¸­çš„æ•°å­—é›†åˆ$P$, æ²¡æœ‰è¿›è¡Œå†³ç­–çš„äººæ‰‹ä¸­çš„æ•°å­—é›†åˆ$R$. è€ƒè™‘è¯æ˜Žæœ€ä¼˜ç­–ç•¥ä¸‹å‘ç”Ÿäº¤æ¢å½“ä¸”ä»…å½“ $\min\{R\} &lt; \max\{P\}$. ä¸å¦¨ä½¿ç”¨æ•°å­¦å½’çº³æ³•è¯æ˜Ž, å¯¹äºŽæœ€åŽä¸€ä¸ªåšå†³ç­–çš„äºº, å†³ç­–æ­£ç¡®æ€§æ˜¾ç„¶, è€ƒè™‘å‰©ä¸‹çš„äºº: å½“ $\min\{R\} &gt; \max\{P\}$ æ—¶, æ˜¾ç„¶ç¿»å¼€æ‰‹ä¸­çš„ç‰Œæ— è®ºå¦‚ä½•éƒ½ä¸ä¼šå†åŠ£äºŽ $\max\{P\}$. å½“ $\min\{R\} &lt; \max\{P\}$ æ—¶, è€ƒè™‘åè¯ç¿»å¼€å½“å‰çš„ç‰Œä¸ä¼šæ¯” $\max\{P\}$ æ›´ä¼˜: å¦‚æžœç¿»å¼€çš„ç‰Œä¼˜äºŽ $\max\{P\}$, ç”±äºŽåœ¨è¿™ä¹‹å‰æœ‰ $\min\{R\} &lt; \max\{P\}$, åœ¨æœ€å°å€¼è¢«ç¿»å‡ºä¹‹å‰æŽ¥ä¸‹æ¥çš„äººéƒ½ä¼šé€‰æ‹©ä¸Žæœ€å¤§çš„ä½ç½®äº¤æ¢, å¦‚æžœæœ€å¤§å€¼æ‰€åœ¨çš„ä½ç½®æ²¡æœ‰å‘ç”Ÿå˜åŒ–è¿™ä¸ªä½ç½®æœ€åŽä¼šå˜æˆ $\min\{R\}$ ä¸”ä¸ä¼šæœ‰äººå†å’Œä»–äº¤æ¢æ‰‹ä¸­çš„ç‰Œ, å¦åˆ™è¿™ä¸ªä½ç½®éœ€è¦å…ˆå˜å¾—å°äºŽåŽŸæœ¬çš„ $\max\{P\}$. å¦‚æžœç¿»å¼€çš„ç‰ŒåŠ£äºŽ $\max\{P\}$ åˆ™ç±»ä¼¼ä¸Šè¿°æƒ…å†µä¸­å…ˆå˜å¾—å°äºŽåŽŸæœ¬ $\max\{P\}$ çš„æƒ…å†µ, æ¯ä¸€ä¸ªå®Œæ•´è¿‡ç¨‹ä¸­è¦ä¹ˆ $\max\{P\}$ å˜æˆ $\min\{R\}$, è¦ä¹ˆ $\max\{P\}$ çš„ä½ç½®å‘ç”Ÿå˜åŒ–, æœ€ç»ˆä¸€å®šéƒ½ä¼šåŠ£äºŽæœ€åˆçš„ $\max\{P\}$. æŽ¥ä¸‹æ¥è€ƒè™‘ $E(n)$, ç¬¬ $i$ ä¸ªäººé€‰æ‹©ç•™åœ¨åŽŸåœ°å½“ä¸”ä»…å½“ç¬¬ $i-1$ ä¸ªäººæ‰‹ä¸­çš„ç‰Œæ°å¥½æ˜¯åŽç¼€æœ€å°å€¼, äºŽæ˜¯: E(n) = \sum_{i=1}^{n} \frac{1}{i}è€ƒè™‘ç”Ÿæˆå‡½æ•°: \begin{aligned} F(x) &= \sum_{i=1}^{\infty} \frac{1}{i} x^i \\ &= \int \frac{1}{1 - x} \\ &= -\ln(1 - x) \\ \end{aligned} \begin{aligned} E(x) &= \frac{F(x)}{1 - x} \\ &= \frac{-\ln(1 - x)}{1 - x} \end{aligned}æŽ¥ä¸‹æ¥è®¡ç®— $S_k(n)$: \begin{aligned} S_k(x) &= \frac{S_{k-1}(x)}{1 - x} \\ &= \frac{-\ln(1 - x)}{(1 - x)^{k + 1}} \\ S_k'(x) &= \frac{(-\ln(1-x))'}{(1-x)^{k + 1}} - \ln(1 - x) \left( \frac{1}{(1 - x)^{k+1}} \right)' \\ &= \frac{1}{(1 - x)^{k + 2}} - \ln(1 - x) \left( -\frac{1}{(1 - x)^{2k + 2}} ((1-x)^{k+1})' \right) \\ &= \frac{1}{(1 - x)^{k + 2}} - \ln(1 - x) \frac{(k + 1) (1 - x)^k}{(1 - x)^{2k+2}} \\ &= \frac{1}{(1 - x)^{k + 2}} + (k + 1) S_{k+1}(x) \end{aligned}è€ƒè™‘ $x^n$ é¡¹çš„ç³»æ•°: (n+1)S_k(n+1)x^n = {n + k + 2 \choose k + 1}x^n + (k + 1) S_{k + 1}(n) x^nS_{k+1}(n) = \frac{(n+1)S_k(n+1) - {n + k + 2 \choose k + 1}}{k + 1}å¯¹äºŽ $S_0(n)$, ä½¿ç”¨è°ƒå’Œçº§æ•°çš„è¿‘ä¼¼å…¬å¼è®¡ç®—, å¦åˆ™é€’å½’å³å¯. PowerDescription $n$ ä¸ªè¿žç»­éšæœºå˜é‡, ç¬¬ $i$ ä¸ªå˜é‡ $x_i$ åœ¨ $[l_i, r_i]$ ä¸­å‡åŒ€éšæœº, æ±‚ $\max\{ (\sum{x_i})^m, a^m \}$ çš„æœŸæœ›å€¼å¯¹ $998244353$ å–æ¨¡çš„ç»“æžœ. $n \le 15, m \le 10^8, |a|, |l_i|, |r_i| \le 10^6$ Solutionè¿žç»­æ¦‚çŽ‡å®žé™…ä¸Šæ˜¯åˆæ³•çš„ç‚¹é›†åœ¨ $n$ ç»´è¶…ç«‹æ–¹ä½“ä¸­çš„ä½“ç§¯å æ¯”, ç‚¹é›†å†…éƒ¨ç”¨ç§¯åˆ†è®¡ç®—æœŸæœ›å³å¯. å¯¹äºŽ $[0, \infty)$ èŒƒå›´å†…çš„ $n$ ä¸ªè¿žç»­éšæœºå˜é‡ $\{x_i\}$, ä¸éš¾å½’çº³å¾—åˆ°æ»¡è¶³ $\sum x_i \le x$ çš„ç‚¹æž„æˆçš„ $n$ ç»´è¶…å‡ ä½•ä½“åœ¨ $n$ ç»´ç©ºé—´ä¸­çš„ä½“ç§¯æ˜¯ $\frac{x^n}{n!}$. è€ƒè™‘ $\sum{x_i}$ å’Œ $a$ çš„å¤§å°å…³ç³». $m$ ä¸ºå¥‡æ•°æ—¶, éœ€è¦è€ƒè™‘ä¸¤ä¸ªåŒºé—´, $[-\infty, a], [a, \infty]$. $m$ ä¸ºå¶æ•°æ—¶, éœ€è¦è®¡ç®—ä¸‰ä¸ªåŒºé—´çš„ç­”æ¡ˆ, $[-\infty, -a], [-a, a], [a, \infty]$. é‚£ä¹ˆè¦è®¡ç®—åœ¨æ¯ä¸ªåŒºé—´å†…éƒ¨çš„æœŸæœ›å€¼, è€ƒè™‘å°†æ¯ä¸ª $x_i$ è¡¨ç¤ºä¸º $l_i + y_i$ æˆ– $r_i + y_i$, $2^n$ æžšä¸¾æ‰€æœ‰ä¸åˆæ³•çš„å˜é‡é›†åˆè¿›è¡Œå®¹æ–¥, å¯¹äºŽ $\sum y_i \le K$ çš„é™åˆ¶å¯ä»¥è½¬åŒ–æˆè®¡ç®—: \int_{0}^{K} \frac{x^{n-1}}{(n-1)!} g(x) \mathrm{d}x$g(x)$ è¡¨ç¤ºå½“ $\sum y_i = x$ æ—¶çš„ç­”æ¡ˆ, åŒä¸€ä¸ªåŒºé—´å†…çš„å½¢å¼æ˜¯ç›¸åŒçš„. å¯¹äºŽ $\sum y_i \ge K$ çš„é™åˆ¶å¯ä»¥åè¿‡æ¥å°†æ¯ä¸ª $x_i$ è¡¨ç¤ºä¸º $r_i - y_i$ æˆ–è€… $l_i - y_i$, é™åˆ¶ $-\sum y_i \ge K$ å¯ä»¥è½¬åŒ–ä¸º $\sum y_i \le K$ çš„å½¢å¼. BiziDescription ç»™å‡ºä¸¤æ£µæœ‰æ ¹æ ‘, å¤§å°åˆ†åˆ«æ˜¯ $n_1, n_2$, å¯ä»¥è¿›è¡Œä¸‰ç§æ“ä½œ: ä¿®æ”¹: å°†ä¸€æ¡è¾¹çš„è¾¹æƒä»Ž $x$ æ”¹ä¸º $y$ , ä»£ä»·ä¸º $|x - y| \times c1$. æ”¶ç¼©: é€‰æ‹©ä¸€ä¸ªç‚¹, å°†å®ƒçš„æ‰€æœ‰å­æ ‘è¿žå‘ä»–çš„çˆ¶äº², ä»£ä»·ä¸ºè¿™ä¸ªç‚¹åˆ°çˆ¶äº²çš„è¾¹æƒ $w \times c2$. ç”Ÿé•¿: é€‰æ‹©ä»»æ„ä¸€ä¸ªç‚¹çš„ä¸€æ®µè¿žç»­çš„å­æ ‘, æ’å…¥ä¸€ä¸ªæ–°ç‚¹è¿žå‘é€‰æ‹©çš„ç‚¹å¹¶æˆä¸ºè¿™äº›å­æ ‘çš„çˆ¶äº², ä»£ä»·ä¸ºè¿žå‘åŽŸæ¥çš„ç‚¹çš„è¾¹æƒ $w \times c2$. æ±‚å‡ºä½¿å¾—ä¸¤é¢—æ ‘æ‹¬å·åºåˆ—å’Œè¾¹æƒç›¸åŒéœ€è¦çš„æœ€å°ä»£ä»·. $n1 \le 50,\, n2 \le 2000$ Solutioné¦–å…ˆä¸éš¾å‘çŽ°æ“ä½œä¸€å’Œæ“ä½œäºŒäº’ä¸ºé€†æ“ä½œ, æ‰€ä»¥å¯ä»¥åªè€ƒè™‘æ“ä½œäºŒ. å®šä¹‰ $dp(a, b, c, d)$ è¡¨ç¤ºç¬¬ä¸€é¢—æ ‘ä¸­ $[a, b]$ è¡¨ç¤ºçš„æ‹¬å·åºåˆ—åŒºé—´å’Œç¬¬äºŒæ£µæ ‘ä¸­ $[c, d]$ è¡¨ç¤ºçš„æ‹¬å·åºåˆ—åŒºé—´å˜å¾—ç›¸åŒéœ€è¦çš„æœ€å°ä»£ä»·, è€ƒè™‘å·¦ç«¯ç‚¹å¯¹åº”çš„æ‹¬å·åœ¨æœ€ç»ˆæƒ…å†µä¸‹çš„åŒ¹é…æƒ…å†µè¿›è¡Œè½¬ç§»: dp(a, b, c, d) = \min \begin{cases} dp(a + 1, b, c, d) + w_{a} \times c2 \\ dp(a, b, c + 1, d) + w_{c} \times c2 \\ dp(a + 1, p_{a} - 1, b + 1, p_{b} - 1) + dp(p_{a} + 1, b, p_{c} + 1, d) + |w_{a} - w_{b}| \times c1 \end{cases}$p_x$ è¡¨ç¤ºç¬¬ $x$ ä¸ªæ‹¬å·çš„åŒ¹é…æ‹¬å·çš„ä½ç½®, $w_x$ è¡¨ç¤ºç¬¬ $x$ ä¸ªæ‹¬å·å’Œå…¶çˆ¶äº²ç»“ç‚¹ä¹‹é—´è¿žè¾¹çš„è¾¹æƒ. çœ‹èµ·æ¥çŠ¶æ€æ•°æ˜¯ $O(n1^2n2^2)$ çš„, å®žé™…ä¸Šåˆ†æžåŽå‘çŽ°æœ‰ç”¨çš„çŠ¶æ€æ•°åªæœ‰ $O(n1^2n2\log{n2})$:å› ä¸ºè€ƒè™‘å·¦ç«¯ç‚¹è¿›è¡Œè½¬ç§»å’Œè€ƒè™‘å³ç«¯ç‚¹è¿›è¡Œè½¬ç§»æ˜¯ç­‰ä»·çš„, ä½†æ˜¯å¦‚æžœæ¯æ¬¡éƒ½é€‰æ‹©ç¬¬äºŒæ£µæ ‘ä¸­å­æ ‘å¤§å°è¾ƒå°çš„ä¸€ä¾§è¿›è¡Œè½¬ç§», å…³äºŽç¬¬äºŒæ£µæ ‘çš„çŠ¶æ€æ•°å°±æ˜¯è½»å„¿å­çš„å­æ ‘å¤§å°ä¹‹å’Œ, è€Œè¿™ä¸ªå€¼æ˜¯ä¸ä¼šè¶…è¿‡ $O(n2 \log{n2})$ çš„. CircleDescription å¹³é¢ä¸Šæœ‰ $n$ ä¸ªç‚¹, æ±‚æœ‰å¤šå°‘ä¸ªæ— åºä¸‰å…ƒç»„ $(i, j, k)$ æ»¡è¶³ç‚¹ $i$, $j$, $k$ ç¡®å®šçš„åœ†ç»è¿‡åæ ‡åŽŸç‚¹. $n \le 2000$ Solutionè¥¿å§†æ¾å®šç†: ä¸‰ä¸ªç‚¹ç¡®å®šçš„åœ†ä¸Šä»»é€‰ä¸€ç‚¹å‘è¿™ä¸‰ä¸ªç‚¹æž„æˆçš„ä¸‰è§’å½¢ä¸‰è¾¹æ‰€åœ¨ç›´çº¿åˆ†åˆ«ä½œåž‚çº¿, åž‚è¶³ä¸‰ç‚¹å…±çº¿. è¯æ˜Žå¯å‚è€ƒä¸‹å›¾: äºŽæ˜¯é—®é¢˜è½¬åŒ–ä¸ºæ±‚ä¸‰ç‚¹å…±çº¿çš„æ•°é‡. TriangleDescription æœ‰ä¸€æ£µ $n$ ä¸ªç‚¹çš„æ ‘, åˆå§‹æ—¶æ ‘ä¸Šæ²¡æœ‰çŸ³å­, å¯ä»¥è¿›è¡Œè‹¥å¹²æ¬¡å¦‚ä¸‹æ“ä½œ: å¦‚æžœç‚¹ $u$ çš„æ‰€æœ‰å­æ ‘ $v$ ä¸Šéƒ½æ°å¥½æœ‰ $w_v$ é¢—çŸ³å­, åˆ™å¯ä»¥ä»Žæ‰‹ä¸­æ‹¿å‡º $w_u$ é¢—çŸ³å­æ”¾åœ¨ç‚¹ $u$ ä¸Š. å°†æŸä¸ªç»“ç‚¹ä¸Šçš„æ‰€æœ‰çŸ³å­æ”¶å›žæ‰‹ä¸­. çŽ°åœ¨è¯¢é—®ä½ å¯¹äºŽæ¯ä¸€ä¸ªç‚¹ $i$, è¦ä½¿å¾— $i$ ä¸Šæ°å¥½æ”¾æœ‰ $w_i$ é¢—çŸ³å­, åˆå§‹æ—¶æ‰‹ä¸­è‡³å°‘éœ€è¦å¤šå°‘é¢—çŸ³å­. $n \le 10^5, w_i \le 10^9$ Solutioné¦–å…ˆå¯ä»¥å‘çŽ°æ“ä½œçš„è¿‡ç¨‹ç±»ä¼¼ä¸€ä¸ªæ‹“æ‰‘æŽ’åº, å¡«ä¸Šä¸€ä¸ªç»“ç‚¹çš„çŸ³å­ä¹‹å‰å…ˆè¦å°†å®ƒçš„æ‰€æœ‰å„¿å­éƒ½å¡«ä¸ŠçŸ³å­, æŽ¥ç€ä¼šç«‹å³æ”¶å›žå„¿å­ç»“ç‚¹ä¸Šçš„çŸ³å­. ä¸å¦¨åè¿‡æ¥è€ƒè™‘, å®šä¹‰ä¸€æ¬¡æ“ä½œä¸ºé€‰æ‹©ä¸€ä¸ªæ”¾æœ‰çŸ³å­çš„ç‚¹, å°†å®ƒçš„å„¿å­ç»“ç‚¹å…¨éƒ¨æ”¾ä¸ŠçŸ³å­, ç„¶åŽæ”¶å›žè¿™ä¸ªç‚¹çš„çŸ³å­. ç”±äºŽåªéœ€è¦è€ƒè™‘æ“ä½œè¿‡ç¨‹ä¸­çŸ³å­æ•°é‡çš„æœ€å¤§å€¼, å¯ä»¥å‘çŽ°åè½¬é¡ºåºå¹¶ä¸ä¼šå½±å“ç­”æ¡ˆ. ç”¨ä¸€ä¸ªäºŒå…ƒç»„ $(a, b)$ æè¿°ä¸€æ¬¡æ“ä½œ, $a$, $b$ åˆ†åˆ«è¡¨ç¤ºåœ¨æ“ä½œçš„è¿‡ç¨‹ä¸­çŸ³å­çš„æ€»å˜åŒ–é‡å’Œå˜åŒ–æœ€å¤§å€¼, æ³¨æ„åˆ°ä¸¤ä¸ªæ“ä½œå¯ä»¥æ–¹ä¾¿åœ°åˆå¹¶: (a, b) + (c, d) = (a + c, \max\{b, a + d\})æŽ¥ä¸‹æ¥è€ƒè™‘äºŒå…ƒç»„ $X = (a, b)$ å’Œ $Y = (c, d)$ ä¹‹é—´çš„ä¼˜å…ˆçº§, ä¸éš¾å¾—åˆ°ä»¥ä¸‹ä¼˜å…ˆçº§è§„åˆ™: $a \times c &lt; 0$ æ—¶, æ€»å˜åŒ–é‡å°äºŽ $0$ çš„äºŒå…ƒç»„ä¼˜å…ˆçº§æ›´é«˜. $a &lt; 0 ,\,\, c &lt; 0$ æ—¶, å˜åŒ–æœ€å¤§å€¼è¾ƒå°çš„äºŒå…ƒç»„ä¼˜å…ˆçº§æ›´é«˜. $a &gt; 0 ,\,\, c &gt; 0$ æ—¶, æ€»å˜åŒ–é‡å‡åŽ»å˜åŒ–æœ€å¤§å€¼è¾ƒå°çš„äºŒå…ƒç»„ä¼˜å…ˆçº§æ›´é«˜. ä»¥ä¸Šè§„åˆ™ä¹Ÿå¯åˆ©ç”¨äº¤æ¢æ³•è¯æ˜Žæ­£ç¡®æ€§. åˆå› ä¸ºä»»æ„ä¸¤ä¸ªäºŒå…ƒç»„åˆå¹¶å¾—åˆ°çš„æ–°äºŒå…ƒç»„ä¸ä¼šæ¯”åŽŸæ¥çš„ä¸¤ä¸ªäºŒå…ƒç»„éƒ½æ›´ä¼˜, æ‰€ä»¥å…¨å±€æœ€ä¼˜çš„äºŒå…ƒç»„åœ¨å¯ä»¥é€‰æ‹©çš„æ—¶å€™ä¸€å®šä¼šé©¬ä¸Šé€‰æ‹©, äºŽæ˜¯å¾—åˆ°ä¸€ä¸ªè´ªå¿ƒç­–ç•¥, æ¯æ¬¡é€‰æ‹©æœ€ä¼˜çš„äºŒå…ƒç»„å¹¶å°†å…¶å’Œçˆ¶äº²å½“å‰å¯¹åº”çš„äºŒå…ƒç»„è¿›è¡Œåˆå¹¶, å¯ä»¥å‘çŽ°è¿™æ ·èƒ½å¤Ÿå¾—åˆ°æ•´æ£µæ ‘çš„æ“ä½œåºåˆ—.]]></content>
      <tags>
        <tag>Summary</tag>
        <tag>Combinatorial</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ‹“å±•åŸƒæ°ç­›æ³•å°ç»“]]></title>
    <url>%2F2018%2Fex-eratos-sieve%2F</url>
    <content type="text"><![CDATA[å­¦å®Œæ´²é˜ç­›ä¹‹åŽå¿˜å¾—å·®ä¸å¤šäº†, ä¸è¿‡çŽ°åœ¨å·²ç»å¯ä»¥å°†æ´²é˜ç­›æ‰”è¿›åžƒåœ¾æ¡¶äº†â€¦ Descriptionæ±‚: h(n) = \sum_{i=1}^{n} f(i)å…¶ä¸­ $f$ æ˜¯å®šä¹‰åœ¨æ­£æ•´æ•°é›†ä¸‹çš„ç§¯æ€§å‡½æ•°, æ»¡è¶³ $f(p^c)$ èƒ½å¤Ÿå¿«é€Ÿè®¡ç®—. Conversioné¦–å…ˆå¯ä»¥å°†æ‰€æœ‰è¦æ±‚çš„æ•°æŒ‰ç…§æ˜¯å¦åªå«å¤§äºŽ $\sqrt{n}$ çš„è´¨å› å­åˆ†ä¸ºä¸¤ç±», å¯¹äºŽç¬¬ä¸€ç±»æ•°ä¸€å®šæ˜¯ä¸€ä¸ªè´¨æ•°, è€Œç¬¬äºŒç±»æ•°ä¸€å®šå¯ä»¥åœ¨æŸä¸ªè¾ƒå°çš„è´¨å› å­å¤„è€ƒè™‘åˆ°, äºŽæ˜¯æˆ‘ä»¬åªå…³æ³¨ä¸è¶…è¿‡ $\sqrt{n}$ çš„é‚£äº›è´¨å› å­. å®šä¹‰ $S_k(n, i)$ è¡¨ç¤ºå°äºŽç­‰äºŽ $n$ çš„æ•°ä¸­ä¸Žå‰ $i$ ä¸ªè´¨æ•°äº’è´¨çš„æ‰€æœ‰æ•°ä¸Žæ‰€æœ‰è´¨æ•°çš„ $k$ æ¬¡æ–¹å’Œ, å®¹æ˜“å¾—åˆ°è½¬ç§»: S_k(n, i) = \begin{cases} S_k(n, i-1) & n < p_i^2 \\ S_k(n, i-1) - p_i^k \times \left(S_k(\left \lfloor \frac{n}{p_i} \right \rfloor, i - 1) - S_k(p_{i-1}, i - 1)\right) & \mathrm{otherwise} \end{cases}åœ¨è€ƒè™‘å®Œ $\sqrt{n}$ ä»¥å†…çš„æ‰€æœ‰è´¨å› æ•°åŽ, $S_k(n)$ ä¸­ç•™ä¸‹äº†æ‰€æœ‰è´¨æ•°çš„ $k$ æ¬¡æ–¹, è¿™æ ·æ‰€æœ‰ç¬¬ä¸€ç±»æ•°çš„å‡½æ•°å€¼éƒ½å¯ä»¥å¿«é€Ÿè®¡ç®—. ç±»ä¼¼åœ°, å®šä¹‰ $G(n, i)$ è¡¨ç¤ºå°äºŽç­‰äºŽ $n$ çš„æ•°ä¸­ä»…ç”±ç¬¬ $i$ ä¸ªä»¥åŽçš„è´¨æ•°æž„æˆçš„æ•°ä¸Žæ‰€æœ‰è´¨æ•° $x$ çš„ $f(x)$ ä¹‹å’Œ, è½¬ç§»çš„æ–¹å¼ç±»ä¼¼: G(n, i) = G(n, i+1) + \sum_{c=0}^{\substack{p_i^{c+1} \le n}} f(p_i^{c+1}) + f(p_i^c) \times \left(G(\left \lfloor \frac{n}{p_i^c} \right \rfloor, i+1) - G(p_i, i+1)\right)å¤æ‚åº¦çº¦ä¸º $O\left(\frac{n^{\frac{3}{4}}}{\log{n}}\right)$ Code123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566namespace SIV &#123; const int M = 100000; ll n; int m; uint val[M + 5]; int prime[M + 5], pcnt; uint s[M + 5], S[M + 5]; uint f[M + 5], F[M + 5]; inline uint gets(ll x) &#123; return x &lt;= m ? s[x] : S[n / x]; &#125; inline uint getf(ll x) &#123; return x &lt;= m ? f[x] : F[n / x]; &#125; int my_sqrt(ll x) &#123; int r = 1; while(1ll * (r + 1) * (r + 1) &lt;= x) ++ r; return r; &#125; void init(ll _n) &#123; m = my_sqrt(n = _n); for(int i = 1; i &lt;= m; ++i) &#123; val[i] = 81 * i * i - 27 * i + 9; s[i] = i - 1; S[i] = (n / i) - 1; &#125; for(int p = 2; p &lt;= m; ++p) &#123; if(s[p] == s[p-1]) continue; prime[pcnt ++] = p; const uint _s = s[p - 1]; const ll q = 1ll * p * p, lim = min((ll) m, n / q), x = m / p, y = n / p; for(int i = 1; i &lt;= x; ++i) S[i] -= S[i * p] - _s; for(int i = x + 1; i &lt;= lim; ++i) S[i] -= s[y / i] - _s; for(int i = m; i &gt;= q; --i) s[i] -= s[i / p] - _s; &#125; for(int i = 1; i &lt;= m; ++i) &#123; f[i] = s[i] * 63; F[i] = S[i] * 63; &#125; for(int e = pcnt; e &gt;= 1; --e) &#123; int p = prime[e-1]; const ll q = 1ll * p * p, lim = min((ll) m, n / q); for(int i = 1; i &lt;= lim; ++i) &#123; ll cur = n / i; for(ll t = p, c = 1; t * p &lt;= cur; t *= p, ++ c) &#123; F[i] += (getf(cur / t) - e * 63) * val[c] + val[c + 1]; &#125; &#125; for(int i = m; i &gt;= q; --i) &#123; int cur = i; for(int t = p, c = 1; t &lt;= cur / p; t *= p, ++ c) &#123; f[i] += (getf(cur / t) - e * 63) * val[c] + val[c + 1]; &#125; &#125; &#125; &#125;&#125;]]></content>
      <tags>
        <tag>Number Theory</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®°NOI2018]]></title>
    <url>%2F2018%2Fnoi2018%2F</url>
    <content type="text"><![CDATA[æŠ˜è…¾äº†å¥½ä¹…ç»ˆäºŽæŠŠåšå®¢ä¿®å¥½äº†, æ¥å¡«ä¸€äº›å‘. Day -1ä¸Šåˆåœ¨å®¶æ— æ‰€äº‹äº‹, æ”¶äº†ä¸‹è¡ŒæŽ, ä¸‹åˆå°±åˆ°æ´‹æ¹–æŠ¥åˆ°åŽ»äº†, ç„¶åŽå¬è¯´ç¬”è¯•æ—¶é—´è°ƒæ•´åˆ°äº†ä¸Šåˆ, æ„Ÿè§‰æœ‰ç‚¹æ…Œæ•´ä¸ªæ™šä¸Šéƒ½åœ¨èƒŒç¬”è¯•. Day 0ä¸Šåˆè€ƒç¬”è¯•, æ¯”é¢„æ–™ä¸­çš„ç®€å•å¾ˆå¤š, æ²¡æœ‰ä»€ä¹ˆå¿«æ·é”®ä¹‹ç±»çš„å‘é¢˜ä¹Ÿæ²¡æœ‰æŒ‚åˆ†, è¯•æœºå°±æ‰“äº†ä¸€ä¸ªæœ€ç®€å•çš„é…ç½®å°±è·‘äº†. ä¸‹åˆæ‰¾äº†ä¸€é—´æ•™å®¤è‡ªä¹ , ä¸çŸ¥é“å¹²ä»€ä¹ˆ, æ™šä¸Šæ‡’å¾—å¤ä¹ ä»€ä¹ˆæ—©æ—©åœ°ç¡äº†, å¥‡æ€ªçš„æ˜¯å±…ç„¶ä¸æ¯«ä¸ç´§å¼ . Day 1ç¬¬ä¸€è¯•, çœ‹äº†çœ‹é¢˜, è§‰å¾—é¢˜æ„éƒ½æŒºå¥½ç†è§£çš„, éš¾åº¦ä¹ŸåŸºæœ¬æŒ‰ç…§é¢˜ç›®é¡ºåº. å°±ç›´æŽ¥å¼€å§‹å†™T1äº†, å†™å®Œ $\log^2$ è¿‡äº†å¤§æ ·ä¾‹ç›´æŽ¥ä¸¢åˆ°ä¸€è¾¹äº†, ç„¶åŽçœ‹T2, æŽ¨äº†ä¸€ä¸ªçœ‹èµ·æ¥æœ‰ç†æœ‰æ®çš„ç»“è®º, ä½†ä¸æ˜¯å¾ˆä¼šç®—ç­”æ¡ˆæžäº†å¾ˆä¹…å¤§æ ·ä¾‹å››ä¸ªå…¨é”™, æƒ³äº†ä¸€ä¸‹éšä¾¿æ‰“äº†ä¸ªç‰¹åˆ¤è¿‡äº†å…¶ä¸­ä¸¤ä¸ª, åˆæ”¹äº†ä¸€ä¸‹ç‰¹åˆ¤æ‰åœ¨è€ƒè¯•ä¸€åŠæ—¶é—´çš„æ—¶å€™è¿‡äº†å¤§æ ·ä¾‹. æœŸé—´åŽ»ä¸Šäº†ä¸€ä¸ªåŽ•æ‰€, ç”¨æŽ‰20minâ€¦ çœ‹T3æƒŠå–œåœ°å‘çŽ°68åˆ†ç‰¹åˆ«å‚»é€¼, é£žå¿«åœ°ç å®Œè¿‡äº†å¤§æ ·ä¾‹è¿˜æœ‰ä¸€ä¸ªåŠå°æ—¶, æ­£å‡†å¤‡å›žåŽ»ç»§ç»­åšT2æœ€åŽ20åˆ†çš„æ—¶å€™å‘çŽ°T1å¯èƒ½è·‘ä¸è¿‡, å¡äº†å¾ˆä¹…çš„å¸¸, æœŸé—´ç«Ÿç„¶æ£€æŸ¥å‡ºå¥½å¤šè‡´å‘½çš„é”™è¯¯, ç„¶åŽå¿ƒé‡Œç‰¹åˆ«è™šåœ°ä¸åœæ£€æŸ¥, T2ä¹Ÿæ²¡æœ‰ç»§ç»­æƒ³äº†. å¥½åœ¨æœ€åŽå¹¶æ²¡æœ‰æŒ‚åˆ†. Day 1.5é¸½äº†ç¤¾ä¼šæ´»åŠ¨, åœ¨è‡ªä¹ å®¤æžäº†ä¸€å¤©é¢“. ç›´æŽ¥æ‰“å‡ºäº†é˜²æ²‰è¿·è­¦å‘Šâ€¦ Day 2çœ‹å®Œé¢˜ç›®ä¸€ç›´åœ¨æƒ³å“ªé“é¢˜æœ€ç®€å•, ç„¶åŽT1è¡¥å……äº†ä¸€ä¸ªæ¡ä»¶â€¦ ç”¨äº†ä¸¤ä¸ªå°æ—¶éƒ½æ²¡æœ‰ä»ŽT1çš„å€’æ•°ç¬¬äºŒæ­¥æŽ¨å‡ºæœ€åŽä¸€æ­¥, æƒ³æƒ³å½“æ—¶å¯èƒ½çœŸçš„å—åˆ°äº†é™æ™ºæ‰“å‡», è¿˜è‡ªä¿¡åœ°è§‰å¾—T2æ¯”è¾ƒå¯åš, ç äº†å¾ˆä¹…å‘çŽ°æ˜¯å‡ç®—æ³•, æ„Ÿè§‰å¾ˆæ…Œæ»šåŽ»å†™T3æš´åŠ›, å›žæ¥æƒ³å…ˆå†™T2çš„45åˆ†åˆä¸æƒ³æ”¾å¼ƒT1, æœ€åŽè¿žT2çš„45åˆ†éƒ½æ²¡æ‹¿åˆ°â€¦ æ„Ÿè§‰å¿ƒæ€çœŸçš„å´©çš„åŽ‰å®³, è™½ç„¶æœ€åŽæŸ¥åˆ†å‘çŽ°æ„å¤–çš„å¤šäº†5åˆ†(å¤§é›¾). æ€»ç»“å¥½åƒä»ŽåŽ»å¹´NOIPä»¥æ¥, èº«ä¸Šä¸€ç›´æœ‰æŸç§äºŒè¯•Debuffå­˜åœ¨, å¯èƒ½ç»å¸¸æ€§çš„å› ä¸ºç¬¬ä¸€è¯•è€ƒå¾—ä¸é”™, è€Œå¯¹å¤šæ•°æƒ…å†µä¸‹æ›´éš¾çš„äºŒè¯•å¿ƒå­˜è½»è§†, ä¹Ÿæ²¡èƒ½è°ƒæ•´å¥½è‡ªå·±çš„å¿ƒæ€å§. ä¸ç®¡æ€Žæ ·, æŽ¥ä¸‹æ¥çš„OIç”Ÿæ¶¯, è¦æ›´åŠ çæƒœ!]]></content>
      <tags>
        <tag>Summary</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¹³é¢æ ‘è®¡æ•°]]></title>
    <url>%2F2017%2Fcount-plane-tree%2F</url>
    <content type="text"><![CDATA[ä¸å¸¸è§çš„ç»å…¸é—®é¢˜, é¡ºä¾¿æ€»ç»“ä¸€ä¸‹Burnsideå¼•ç†å§. é—®é¢˜æè¿° ç»™å®š $N$, æ±‚ $N$ ä¸ªç‚¹çš„æœ¬è´¨ä¸åŒçš„å¹³é¢æ ‘çš„æ•°é‡.ä¸¤æ£µå¹³é¢æ ‘æ˜¯ç­‰ä»·çš„å½“ä¸”ä»…å½“å…¶ä¸­ä¸€æ£µèƒ½å¤Ÿç§»åŠ¨ç‚¹çš„ä½ç½®ä¸Žå¦ä¸€æ£µé‡åˆ, ä¸”è¿‡ç¨‹ä¸­ä»ç„¶æ˜¯ä¸€æ£µå¹³é¢æ ‘. åšæ³•è€ƒè™‘æ¨¡åž‹è½¬åŒ–(è®¡ç®— $N+1$ ä¸ªç‚¹çš„ç­”æ¡ˆ):å–å•ä½åœ†, ç­‰è·åœ°å– $2N$ ä¸ªç‚¹, ç„¶åŽå°†è¿™äº›ç‚¹ä¸¤ä¸¤é…å¯¹è¿žè¾¹, æ»¡è¶³æ‰€æœ‰è¿žè¾¹ä¸ç›¸äº¤.å‘çŽ°å®ƒçš„å¯¹å¶å›¾æ°å¥½æ˜¯ä¸€æ£µå¹³é¢æ ‘, åƒè¿™æ ·: é‚£ä¹ˆå°±åªéœ€è¦è€ƒè™‘æœ¬è´¨ä¸åŒçš„è¿™æ ·çš„é…å¯¹çš„æ•°é‡å³å¯.ä¸¤ä¸ªåœ†æ˜¯ç­‰ä»·çš„å½“ä¸”ä»…å½“ä¸€ä¸ªåœ†å¯ä»¥é€šè¿‡æ—‹è½¬ä¸€å®šçš„è§’åº¦ä¸Žå¦ä¸€ä¸ªåœ†é‡åˆ.è€Œåœ¨è¿™ä¸ªåœ†ä¸Šå…±æœ‰ $2N$ ä¸ªç‚¹, å°±æ„å‘³ç€æœ‰ $2N$ ä¸ªç½®æ¢, æž„æˆä¸€ä¸ªç½®æ¢ç¾¤. ç½®æ¢ç¾¤ä¸‹çš„è®¡æ•°å¯ä»¥ç”¨åˆ° Burnsideå¼•ç† : N(G, C) = \frac{1}{|G|} { \sum_{f \in G} c(f) } åˆ™è½¬åŒ–ä¸ºæ±‚ç½®æ¢ä¸‹çš„ä¸åŠ¨ç‚¹çš„æ•°é‡: ä¸å­˜åœ¨ç½®æ¢çš„æƒ…å†µä¸‹, ç­”æ¡ˆä¸º $C_N$, $\mathrm{Catalan}$ æ•°çš„ç¬¬ $N$ é¡¹.å³å°†ç›¸äº’åŒ¹é…çš„ä½ç½®çœ‹ä½œå·¦å³æ‹¬å·, åˆ™æ‰€æœ‰åˆæ³•çš„æ‹¬å·åºåˆ—éƒ½å¯¹åº”ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„åœ†. $N$ ä¸ºå¥‡æ•°æ—¶, å¯èƒ½å­˜åœ¨ä¸€æ¡å¹³åˆ†åœ†çš„å¯¹è§’çº¿åœ¨ç½®æ¢ä¸‹ä¸å˜, è®¡ç®— $\frac{N+1}{2}$ ä¸ªç‚¹çš„ç­”æ¡ˆå³å¯. è€ƒè™‘æ—‹è½¬ç½®æ¢.ä¸ºäº†æ»¡è¶³æ—‹è½¬ä¹‹åŽçš„è¾¹é‡åˆ, ç‚¹ $i$ å’Œå®ƒçš„åŒ¹é…ç‚¹ $p_i$ åœ¨æ—‹è½¬åŽåº”è¯¥ä»ç„¶æ˜¯ç›¸åŒ¹é…çš„.åˆ™çŽ¯çš„æ•°é‡ä¸€å®šæ˜¯å¶æ•° $2d$, æ‰€ä»¥çŽ¯çš„é•¿åº¦å¯ä»¥è¡¨ç¤ºä¸º $\frac{2N}{2d} = \frac{N}{d}$. å‡å®šç½®æ¢çš„é˜¶æ˜¯ $e$, $e &gt; 1, e | N$, çŽ¯çš„æ•°é‡ $2d = \frac{2N}{e}$.çŽ¯ä¸Šä¸Ž $0$ åŒ¹é…çš„ç‚¹ä¸º $i$, ä¸éš¾å‘çŽ°åœ¨è¿™äº›ç‚¹ä¹‹é—´çš„ç‚¹çš„æ–¹æ¡ˆæ•°ä¸º $C_{i-1}$.å½“è¿™äº›ç‚¹ç¡®å®šä¹‹åŽ, å®ƒä»¬åœ¨çŽ¯ä¸Šä¾æ¬¡ç»è¿‡çš„ $e(i+1)$ ä¸ªç‚¹å°±ç¡®å®šäº†. ä»¤ $f(x)$ è¡¨ç¤º $\mathrm{Catalan}$ æ•°çš„ç”Ÿæˆå‡½æ•°, æ ¹æ® $\mathrm{Catalan}$ æ•°çš„é€’æŽ¨å¼, ä¸éš¾å¾—åˆ°: f(x) = xf^2(x) + 1æž„é€  $B_d$ è¡¨ç¤ºåŒ…å« $2d$ ä¸ªçŽ¯çš„ç½®æ¢ä¸‹ä¸åŠ¨ç‚¹çš„æ•°é‡. B_d = 2\sum_{i = 0}^{d-1} C_i B_{d-i-1}å…¶ä¸­å› å­ $2$ è€ƒè™‘çš„æ˜¯ $i &gt; 2d$ æ—¶ç”¨å½“å‰ç½®æ¢çš„é€†æ¥è®¡ç®—çš„æƒ…å†µ. åˆ™ $B_d$ çš„ç”Ÿæˆå‡½æ•° $g(x)$ æ»¡è¶³: g(x) = 2x g(x) f(x) + 1è§£å¾—: g(x) = (1 - 4x) ^ {-\frac{1}{2}}é—®é¢˜è§£å†³p(n) = \frac{1}{2n} ( [\mathrm{n \, is \, odd}]\binom{n}{\lfloor\frac{n}{2}\rfloor} - \binom{2n}{n-1} + \sum_{d|n}{\varphi(n/d)\binom {2d}{d}} )]]></content>
      <tags>
        <tag>Combinatorial</tag>
        <tag>Burnside</tag>
        <tag>Generating Function</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å†™åœ¨NOIP2017ä¹‹åŽ]]></title>
    <url>%2F2017%2Fafter-noip-2017%2F</url>
    <content type="text"><![CDATA[å¼• æœ¬æ¥åº”è¯¥æœ‰å¦ä¸€ç¯‡åšå®¢å«åšå†™åœ¨NOIP2017ä¹‹å‰çš„, ä½†è·‘å›žå®¶æ‰æ„è¯†åˆ°åšå®¢æ­åœ¨æœºæˆ¿çš„ç”µè„‘ä¸Š, äºŽæ˜¯â€¦â€¦ æ¯”èµ›è¿‡ç¨‹Day1çœ‹åˆ°è¿™ä¸ªT1ä¸é€åˆ†äº†, å¿ƒé‡Œè¿˜æ˜¯æœ‰ç‚¹è™š, è®¤çœŸåœ°è¯»å®Œäº†åŽé¢ä¸¤é¢˜å¹³å¤äº†ä¸€ä¸‹å¿ƒæ€.æƒ³ç€æ—¢ç„¶æ˜¯T1, è‚¯å®šä¸æ˜¯é€å°±æ˜¯å·, çœ‹ç€æ ·ä¾‹æ‰¾äº†æ‰¾è§„å¾‹, æŽ¨äº†ä¸ª $ a + b + (b \% a) (a &lt; b) $ çš„æ–¹æ³•, å‘çŽ°è¿‡ä¸äº†å¤§æ ·ä¾‹. äºŽæ˜¯ç›¯ç€å¤§æ ·ä¾‹å‘å‘†, çªç„¶å‘çŽ°äº†ä¸–ç•Œçš„å¥¥ç§˜.ç„¶åŽå†™T2, å†™å®Œçœ¼æŸ¥äº†ä¸€ä¸‹å¤§æ ·ä¾‹, æ­£è¦å…³é—­çª—å£çš„æ—¶å€™ Vimdiff äº†ä¸€æ³¢, å‘çŽ°è‡ªå·±å¤§å°å†™å†™é”™ä¸€å¤§å †â€¦T3æƒ³äº†æƒ³å†™äº†ä¸ªä¸è€ƒè™‘é›¶è¾¹çš„è®°å¿†åŒ–æœç´¢, å‘çŽ°å¤§æ ·ä¾‹è¿‡ä¸äº† è®¤çœŸæ€è€ƒäº†ä¸€ä¸‹å‘çŽ°æ˜¯æ²¡æœ‰è€ƒè™‘åˆ°è¾¾ç»ˆç‚¹åˆæŠ˜è¿”çš„æƒ…å†µ åˆæƒ³äº†æƒ³å‘çŽ° $-1$ æŒºå¥½åˆ¤çš„, å°±åŠ ä¸Šäº†. Day2åˆ°è¾¾è€ƒåœºæ—¶ç²¾ç¥žçŠ¶æ€ä¸å¤ªå¥½, æ„è¯†æ¨¡ç³Šåœ°æ‰“å¼€äº†é¢˜ç›®.çœ‹å®ŒT2ä¸€ç›´åœ¨æƒ³MSTä»€ä¹ˆçš„, æ„Ÿè§‰ä¸å¤ªä¼šåšå‡†å¤‡æ”¾å¼ƒæ—¶å‘çŽ°æ•°æ®èŒƒå›´åªæœ‰12, äºŽæ˜¯ç§’æ‡‚äº†.T3æ²¡æƒ³å¤šä¹…æŽ¨å‡ºä¸€ä¸ªå¹³è¡¡æ ‘çš„åšæ³•, å¯¹è‡ªå·±ä»£ç èƒ½åŠ›è¿‡äºŽè‡ªä¿¡æ²¡æœ‰å¤šæƒ³å°±å¼€å§‹å†™, ç»“æžœè°ƒåˆ°æœ€åŽä¸€åˆ»è¿˜æ˜¯GGäº†. åæ€é”™è¯¯æ„Ÿè§‰è¿™æ¬¡è™½ç„¶é¢˜ç›®æ¯”è¾ƒå¥‡æ€ª, ä½†å®žé™…éš¾åº¦è¿˜æ˜¯åˆç†çš„, å‡ºçŽ°äº†ä¸€äº›å¤±è¯¯æ°æ°æš´éœ²å‡ºèº«ä¸Šçš„ä¸€äº›é—®é¢˜. è€ƒè¯•çš„æ—¶å€™å¤§éƒ¨åˆ†å¤„åœ¨ä¸€ç§è¾¹æƒ³è¾¹å†™çš„çŠ¶æ€, ä¸€è¾¹å†™å¯èƒ½è¿˜è¦ä¸€è¾¹å®Œå–„ä¸€äº›ç»†èŠ‚. åˆ·äº†å¾ˆå¤šAtcoder çš„é¢˜ç›®ä¹‹åŽ, ä»£ç èƒ½åŠ›é€€åŒ–æ˜Žæ˜¾. è€ƒåœºçš„debuffæ¯”è¾ƒå¼º. å¯èƒ½åŽé¢ä¸¤æ¡è¿˜ç¨å¾®å¯ä»¥æŽ¥å—å§, ä½†æ˜¯ç¬¬ä¸€æ¡çš„ç¡®æ˜¯ç¡¬ä¼¤, è¿™æ ·åšç®€å•é¢˜æˆ–è€…åœ¨æ¯”è¾ƒæ¸…é†’çš„æ—¶å€™å†™é¢˜å¯èƒ½è¿˜å¥½, ç„¶è€Œä¸€æ—¦é‡åˆ°ä»£ç å®žçŽ°æ¯”è¾ƒå¤æ‚æˆ–è€…æ¡ä»¶æ¯”è¾ƒå¤šçš„é¢˜ç›®, å°±ä¼šæŒ‚å¾—å¾ˆæƒ¨, è¿™ä¸ªé—®é¢˜æ¨¡æ‹Ÿèµ›ä¸­ä¹Ÿå‡ºçŽ°è¿‡å‡ æ¬¡.è§£å†³çš„ç­–ç•¥å…¶å®žè¯´èµ·æ¥ä¹Ÿä¸éš¾, ä¸»è¦å°±æ˜¯æ¯é“é¢˜å†™ä¹‹å‰æŠŠç®—æ³•ç»†èŠ‚è€ƒè™‘åŸºæœ¬æ¸…æ¥š, åšåˆ° $ Think \,\, twice, Code \,\, once $ å§. è¿™æ ·ä¹Ÿä¸ä¼šå‡ºçŽ°æŸé“é¢˜å†™äº†å¾ˆä¹…æœ€åŽå‘çŽ°åšæ³•æ˜¯é”™è¯¯çš„è¿™ç§å°´å°¬çš„æƒ…å†µä¹Ÿèƒ½å¤Ÿé¿å…å†™ä¸€äº›ç‰¹åˆ«å¤æ‚çš„åšæ³•. å…³äºŽæœªæ¥é’ˆå¯¹è¿™æ¬¡è”èµ›çš„é—®é¢˜å’ŒåŽŸæ¥çš„ä¸€äº›å¼±ç‚¹, å¯¹æŽ¥ä¸‹æ¥çš„ä¸€æ®µå­¦ä¹ åšä¸€äº›è§„åˆ’ï¼š è¡¥ä¸€äº›æ•°å­¦ç›¸å…³çš„çŸ¥è¯†ï¼ˆä¸ä¸€å®šOIç›¸å…³ï¼‰ æé«˜ä¸€ä¸‹ä»£ç èƒ½åŠ›, å¤ä¹ ä¸€äº›ä¸ç†Ÿç»ƒçš„æ•°æ®ç»“æž„, åˆ·ä¸€äº›è´¨é‡æ¯”è¾ƒé«˜çš„é¢˜ç›® ç„¶åŽçš„è¯, å›žåŽ»å°±è¦è¡¥æ–‡åŒ–äº†å§.]]></content>
      <tags>
        <tag>Summary</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CTSC2017 æ¸¸æˆ]]></title>
    <url>%2F2017%2Fctsc2017-game%2F</url>
    <content type="text"><![CDATA[Description æœ‰$N$ å±€æ¸¸æˆ, é™¤ç¬¬ä¸€å±€æ¸¸æˆå¤–æ¯ä¸€å±€æ¸¸æˆçš„èŽ·èƒœæœºçŽ‡å‡ä¸Žä¸Šä¸€å±€æ¸¸æˆçš„ç»“æžœæœ‰å…³. çŽ°åœ¨å¯¹æ¸¸æˆè¿›è¡Œ$Q$æ¬¡ä¿®æ”¹, æ¯æ¬¡å‘Šè¯‰ä½ æŸä¸€å±€æ¸¸æˆçš„ç»“æžœæˆ–è€…åˆ é™¤ä¹‹å‰ç»™ä½ çš„ä¿¡æ¯, æ±‚ä¿®æ”¹åŽæœŸæœ›ä¸‹èŽ·èƒœçš„åœºæ•°ä¸ºå¤šå°‘. $ N, Q \le 2 \times 10 ^ 5 $ Solutioné¦–å…ˆä¸éš¾å‘çŽ°, æŸä¸€å±€çš„æ¸¸æˆçš„èƒœçŽ‡åªä¸Žå…¶å·¦å³çš„æœ€è¿‘æ¸¸æˆç»“æžœç›¸å…³, æ‰€ä»¥ç­”æ¡ˆå¯ä»¥åˆ†æ®µè®¡ç®—. è€ƒè™‘æœŸæœ›çš„çº¿æ€§æ€§, å¯ä»¥å°†æœŸæœ›èƒœåˆ©åœºæ•°è¡¨ç¤ºæˆæ¯ä¸€å±€æ¸¸æˆçš„èƒœçŽ‡ä¹‹å’Œ.è®° $X _ i$ è¡¨ç¤ºç¬¬$i$ åœºæ¸¸æˆçš„çŠ¶æ€. æ‰€æ±‚å³ä¸º $ \sum _ {l &lt; m &lt; r} P( X _ m = 1 | X _ l, X _ r) $. ç”±è´å¶æ–¯å…¬å¼: \begin{align} P(X _ m = 1 | X _ l, X _ r) &= \frac{P(X _ m = 1, X _ l, X _ r)}{P(X _ l) \cdot P(X _ r | X _ l) } \\ &= \frac{P(X _ l) \cdot P(X _ m = 1 | X _ l) \cdot P(X _ r | X _ l, X _ m = 1)}{P(X _ l) \cdot P(X _ r | X _ l)} \\ &= \frac{P(X _ m=1 | X _ l) \cdot P(X _ r | X _ l, X _ m = 1)}{P(X _ r | X _ l)} \\ &= \frac{P(X _ m=1 | X _ l) \cdot P(X _ r | X _ m = 1)}{P(X _ r | X _ l)} \end{align}å‘çŽ°åˆ†æ¯æ˜¯å¸¸æ•°, äºŽæ˜¯å¯ä»¥åˆå¹¶åˆ†å­.è€ƒè™‘åˆ†å­çš„æ„ä¹‰, å¤§æ¦‚æ˜¯åˆæ³•çŠ¶æ€ä¸‹å½“å‰ä½ç½®ä¸ºèƒœçš„æ¦‚çŽ‡.æ¯ä¸€æ®µå°±å¯ä»¥ç›´æŽ¥ç”¨$dp$æ¥å¤„ç†å‡ºç­”æ¡ˆ, è®°å½•æŸåœºæ¯”èµ›ä¸ºèƒœ/ è´Ÿçš„æ¦‚çŽ‡ä»¥åŠåˆ†å­çš„æœŸæœ›å³å¯.è¿™ä¸ªå¤æ‚åº¦æ˜¯æ¯æ¬¡è¯¢é—®$O(n)$çš„. å…¶å®žè¿™é“é¢˜è¦è®²çš„å·²ç»è®²å®Œäº†, æœ€åŽåªè¦ç”¨çŸ©ä¹˜å¿«é€Ÿåˆå¹¶$dp$å€¼, ç»´æŠ¤ä¸€ä¸‹å°±å¯ä»¥äº†.]]></content>
      <tags>
        <tag>Probability</tag>
        <tag>Data Structure</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸¤é“æ¦‚çŽ‡é¢˜]]></title>
    <url>%2F2017%2Fprobability-problems%2F</url>
    <content type="text"><![CDATA[çŽ›é‡Œè‹Ÿæ–¯Description ç»™ä½ ä¸€ä¸ªå¤§å°ä¸ºNçš„å¯é‡é›†åˆ, æ±‚è¯¥é›†åˆå­é›†å¼‚æˆ–å’Œçš„$K$æ¬¡æ–¹çš„æœŸæœ›, ä¿è¯ç­”æ¡ˆä¸è¶…è¿‡$2 ^ {64}$. $N \le 100000, K \le 5, A _ i \le 10 ^ 9$ Solution&emsp;&emsp; $K=1$ æ—¶æ»¡è¶³æœŸæœ›çš„çº¿æ€§æ€§, å¯ä»¥å¯¹æ¯ä¸€ä¸ªäºŒè¿›åˆ¶ä½åˆ†å¼€è®¡ç®—ç­”æ¡ˆ. ä¸éš¾å‘çŽ°æ¯ä¸€ä¸ªäºŒè¿›åˆ¶ä½å˜æˆ $1$ çš„æ¦‚çŽ‡æ°å¥½ä¸º $\frac {1}{2}$ (é›†åˆçš„å¥‡æ•°å’Œå¶æ•°å¤§å°çš„å­é›†æ•°ç›¸åŒ). &emsp;&emsp; $K=2$ æ—¶è¦æ±‚çš„æ˜¯æœŸæœ›çš„å¹³æ–¹, å³: \sum_{i=0}^{32} \sum_{j=0}^{32} b_i b_j 2^{i+j}å…¶ä¸­ $b_i$è¡¨ç¤ºæœŸæœ›äºŒè¿›åˆ¶ç¬¬ $i$ ä½çš„å€¼, æžšä¸¾ä¸¤ä¸ªäºŒè¿›åˆ¶ä½å†æ±‚ä¸€ä¸‹ä¸¤ä¸ªä½ç½®åŒæ—¶å–åˆ° $1$ çš„æ¦‚çŽ‡å³å¯. &emsp;&emsp; $K \ge 3$æ—¶ç”±äºŽç­”æ¡ˆä¸è¶…è¿‡ $2^{64}$, æ‰€ä»¥é›†åˆå†…çš„æ•°ä¹Ÿä¸ä¼šå¾ˆå¤§, ç›´æŽ¥ç”¨çº¿æ€§åŸºå¤„ç†. ä¸»æ—‹å¾‹Description æ±‚Nä¸ªç‚¹, Mæ¡è¾¹çš„æœ‰å‘å›¾æœ‰å¤šå°‘ç”Ÿæˆå­å›¾æ»¡è¶³æ•´ä¸ªå›¾æ˜¯å¼ºè”é€šçš„. $N \le 15, M \le N(N-1)$ Solution&emsp;&emsp; è¿™é¢˜ä¸€çœ¼çœ‹ä¸ŠåŽ»ä¸å¤ªå¥½åš, ä¸å¦¨ä»Žé—®é¢˜çš„åé¢æ¥è€ƒè™‘. é¦–å…ˆä¸€ä¸ªéžå¼ºè”é€šçš„å›¾ç¼©æŽ‰$Scc$ ä¹‹åŽä¼šå¾—åˆ°è‹¥å¹²ä¸ª $DAG$. å¦‚æžœçŸ¥é“$Scc$ çš„åˆ’åˆ†æƒ…å†µ, è®¡ç®—$DAG$ çš„æ•°é‡å°±å˜æˆä¸€ä¸ªç»å…¸é—®é¢˜äº†: E(S, T) = {|\{(u, v) \in E | u \in S, v \in T)\}|}F(S) = \sum _ {T \subset S, T \neq \varnothing} (-1) ^ {|T| - 1} \times 2 ^ {E(T, S-T)} F(T)&emsp;&emsp; ç„¶è€Œæ„Ÿè§‰æžšä¸¾$Scc$ åˆ’åˆ†æ›´ä¸å¯åš. å…ˆä¸è€ƒè™‘$Scc$ å¦‚ä½•åˆ’åˆ†, è€ƒè™‘å“ªä¸€äº›ç‚¹é›†æž„æˆå¤šå°‘ä¸ª$Scc$. å‡è®¾$G _ K(T)$è¡¨ç¤º$T$ é›†åˆåˆ†æˆ$K$ ä¸ª$Scc$ çš„æ–¹æ¡ˆæ•°, ç±»ä¼¼ä¸Šé¢å¼å­åœ°, æœ‰: F(S) = \sum _ {T \subset S, T \neq \varnothing} \sum _ {K = 1}^{|T|} (-1) ^ {K - 1} \times G _ K(T) \times 2 ^ {E(T, S-T) + E(S-T, S-T)}DP(S) = 2 ^ {E(S, S)} - F(S)&emsp;&emsp; å®žé™…ä¸Šåªéœ€è¦æ±‚å°†æŸä¸ªé›†åˆåˆ†æˆå¥‡æ•°ä¸ª$Scc$ ä¸Žå¶æ•°ä¸ª$Scc$ çš„æ–¹æ¡ˆæ•°ä¹‹å·® $P(S)$: P(S) = DP(S) + \sum _ {T \subset S, u \in T} - DP(T) \times P(S - T) å…¶ä¸­ $u \in T$ é¿å…é‡å¤è®¡æ•°. &emsp;&emsp; è¿™æ ·åŠ ä¸Šä¸€äº›é¢„å¤„ç†çš„æŠ€å·§å¯ä»¥åšåˆ° $O(3 ^ n)$.]]></content>
      <tags>
        <tag>Dynamic Programming</tag>
        <tag>Combinatorial</tag>
        <tag>Probability</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Atcoder é€‰åš]]></title>
    <url>%2F2017%2Fatcoder-select%2F</url>
    <content type="text"><![CDATA[&emsp;&emsp; å…¶å®žæ˜¯æ€»ç»“ä¸€ä¸‹æ¯”èµ›ä¸­é‡åˆ°çš„å¥½é¢˜, ç„¶åŽçžŽåšäº†å‡ åœº AGC çš„é¢˜ç›®ç»ƒä¹ , æ„Ÿè§‰è¿˜æ¯”è¾ƒæœ‰æ„æ€. AGCAGC002 F Leftmost Ball ç»™ä½ $N$ç§ä¸åŒé¢œè‰²çš„çƒ, æ¯ç§æœ‰$K$ä¸ª, çŽ°åœ¨ä½ å¯ä»¥å°†çƒä»»æ„æŽ’åˆ—, ä½†æœ€ç»ˆçš„åºåˆ—ä¸­æ¯ç§é¢œè‰²çš„ç¬¬ä¸€ä¸ªå‡ºçŽ°ä½ç½®è¦è¢«æŸ“æˆ$0$é¢œè‰², æ±‚èƒ½å¤Ÿå¾—åˆ°çš„æœ¬è´¨ä¸åŒçš„åºåˆ—æ•°, å¯¹$10^9 + 7$å–æ¨¡. $N, K \leq 2000$ &emsp;&emsp; è¿™é¢˜æ­£ç€å¤„ç†æ²¡æœ‰ä»€ä¹ˆæ€è·¯, ä½†æ˜¯å¦‚æžœä»Žå³å¾€å·¦æ¥ä¼šæ¯”è¾ƒå¥½è€ƒè™‘. æˆ‘ä»¬å¯ä»¥è®°$f(i, j)$è¡¨ç¤ºå½“å‰ä»Žå³å¾€å·¦å¡«å‰©ä¸‹$i$ä¸ª$0$é¢œè‰²çš„çƒ, è¿˜å‰©ä¸‹$j$ç§é¢œè‰²æ²¡æœ‰æ”¾çš„æ–¹æ¡ˆæ•°. é‚£ä¹ˆæ¯ä¸€æ¬¡çš„å†³ç­–å°±åŒ…æ‹¬æ”¾å…¥ä¸€ä¸ª$0$é¢œè‰²çš„çƒä»¥åŠæ·»åŠ ä¸€ç§é¢œè‰²çš„$k-1$ä¸ªçƒ: \begin{aligned} f(i-1, j) & \leftarrow f(i, j) \mid [i > j] \\ f(i, j-1) & \leftarrow f(i, j) \times {n-i + (n-j) \times (k-1) + k-2 \choose k-2} \end{aligned} åŽé¢é‚£ä¸ªå…¬å¼æ˜¯å¯é‡é›†, è¿˜æœ‰æœ€åŽçš„ç­”æ¡ˆè¦ä¹˜ä»¥$n!$. AGC005 D ~K Perm Counting æ±‚é•¿åº¦ä¸º$N$çš„æŽ’åˆ—ä¸­, æ»¡è¶³å¯¹ä»»æ„çš„$i$, éƒ½æœ‰$|a_i - i| \neq K$çš„æŽ’åˆ—æ•°é‡. $1 \leq K &lt; N \leq 2000$ &emsp;&emsp; è€ƒè™‘å®¹æ–¥, è®¡ç®—è‡³å°‘æœ‰$i$ä¸ªä½ç½®ä¸åˆæ³•çš„æ–¹æ¡ˆæ•°. ç”±äºŽ$K$æ˜¯ç¡®å®šçš„, é‚£ä¹ˆæ‰€æœ‰ä¸åˆæ³•çš„æ–¹æ¡ˆå¯ä»¥çœ‹æˆæ˜¯å®Œå…¨äºŒåˆ†å›¾åŒ¹é…ä¸­å‡ºçŽ°äº†ä¸€æ¡$(i, i+k)$çš„è¾¹æˆ–è€…ä¸€æ¡$(i, i-k)$çš„è¾¹. &emsp;&emsp; å°†è¿™æ ·çš„è¾¹åœ¨ç”»å‡ºæ¥å°±æ˜¯è‹¥å¹²æ¡äº¤å‰è·¯å¾„. è§‚å¯Ÿåˆ°è¿™æ ·çš„äº¤å‰è·¯å¾„ä¸ç›¸äº¤, æ‰€ä»¥å¯ä»¥æ‹†å¼€æ‹¼æˆä¸€ä¸ªåºåˆ—, ç„¶åŽåœ¨åºåˆ—ä¸Š$dp$å³å¯. AGC015 D A orâ€¦or B Problem æ±‚åœ¨$[A, B]$ä¸­ä»»æ„é€‰å‡ºä¸€ä¸ªéžç©ºæ•´æ•°é›†åˆçš„å…ƒç´ ä½æˆ–å’Œæœ‰å¤šå°‘ç§ä¸åŒçš„ç­”æ¡ˆ. $1 \le A \le B \le 2^{60}$ &emsp;&emsp; å…ˆè€ƒè™‘ä¸€äº›æ¯”è¾ƒç‰¹æ®Šçš„æƒ…å†µ(ä»¥ä¸‹é»˜è®¤$A, B$çš„ä½æ•°ç›¸åŒ): å½“$B$å¯ä»¥è¡¨ç¤ºä¸º$2^k - 1$æ—¶, è¿™ä¸ªä½æˆ–å’Œæ°å¥½å–é$[A, B]$ä¹‹é—´çš„æ‰€æœ‰æ•´æ•°. å½“$A$å¯ä»¥è¡¨ç¤ºä¸º$2^k$æ—¶, è¿™ä¸ªä½æˆ–å’Œåœ¨åŒºé—´$[A, A + 2^{t+1}) \mid t &lt; log_2 A$ä¸­, å…¶ä¸­$t$æ˜¯æœ€å¤§çš„æ»¡è¶³$B$çš„ç¬¬$t$ä½ä¸º$1$çš„æ•°. &emsp;&emsp; é‚£ä¹ˆä¸€èˆ¬æƒ…å†µä¸‹è¿™äº›æ¡ä»¶æœ‰ä»€ä¹ˆç”¨å‘¢? &emsp;&emsp; æˆ‘ä»¬è€ƒè™‘æ‰¾åˆ°æœ€å¤§çš„ä¸€ä¸ª$T$,ä½¿å¾—$B$çš„ç¬¬$T$ä½ä¸º$1$ä¸”$A$çš„ç¬¬$T$ä½ä¸ä¸º$1$, è®°$K = 2 ^ T$. å½“é€‰æ‹©çš„æ•°çš„é›†åˆåœ¨$[A, K)$ä»¥åŠåœ¨$[K, B]$ä¸­çš„æƒ…å†µå¯ä»¥ç›´æŽ¥ç”¨ä¸Šè¿°ç»“è®º. &emsp;&emsp; æŽ¥ä¸‹æ¥è€ƒè™‘åŒæ—¶é€‰å–ä¸¤ä¸ªé›†åˆä¸­çš„æ•°å¯èƒ½ä¼šäº§ç”Ÿçš„ç­”æ¡ˆ. å› ä¸ºè¿™æ—¶å°äºŽ$K$çš„éƒ¨åˆ†æ˜¯æ²¡æœ‰è´¡çŒ®çš„, æ‰€ä»¥ç›´æŽ¥å°†$[A, K)$ä¸­çš„æ‰€æœ‰ç­”æ¡ˆå–å‡º. ä¸éš¾å‘çŽ°$[K, B]$ä¸­å–ä»»æ„ä¸ªéƒ½ä¸Žåªä½¿ç”¨$K$æ²¡æœ‰åŒºåˆ«, é‚£ä¹ˆè¿™æ—¶å€™çš„èŒƒå›´æ˜¯$[K+A, 2\times K-1]$, æ³¨æ„å‡åŽ»é‡å¤è´¡çŒ®. AGC015 F Kenus the Ancient Greek Qç»„è¯¢é—®, æ¯ç»„è¯¢é—®çš„å½¢å¼ä¸ºA, B, è¡¨ç¤ºæ±‚$x \in [1, A], y \in [1, B]$çš„$g(x, y)$çš„æœ€å¤§å€¼, åŠæœ€å¤§å€¼çš„æ–¹æ¡ˆæ•°, å…¶ä¸­: g(x, y) = \begin{cases} 1, & \text{y = 0} \\ g(y, x), & \text{x > y} \\ g(y \; mod \; x, x) + 1, & \text{otherwise} \\ \end{cases}$1 \le Q \le 3 \times 10 ^ 5 \,\,, 1 \le A, B \le 10 ^ {18}$ &emsp;&emsp; ä»¥ä¸‹æ— ç‰¹æ®Šè¯´æ˜Ž, å‡é»˜è®¤æ‰€æœ‰$x &lt; y, A &lt; B$&emsp;&emsp; å…ˆè€ƒè™‘ç¬¬ä¸€é—®, å¦‚æžœæˆ‘ä»¬ç”±ä¸€ä¸ªç‰¹å®šçš„$(x, y)$, ä»Žå°åˆ°å¤§åœ°æž„é€ ä½¿å¾—$g(x, y)$çš„å€¼ä¸æ–­åœ°å˜å¤§, é‚£ä¹ˆå¦‚ä½•æž„é€ ä½¿å¾—è¿™ä¸ªå€¼æœ€å¤§å‘¢?&emsp;&emsp; å¯¹äºŽæ‰€æœ‰$(xâ€™, yâ€™)$æ»¡è¶³$g(xâ€™, yâ€™) = g(x, y) + 1$, æ˜¾ç„¶æœ‰: (x', y') \in \{ (y, x + ky) \mid k \in Z^+ \}&emsp;&emsp; åŒæ—¶, ä¸ºäº†ä½¿å¾—è¿™ä¸ªè¿‡ç¨‹å°½å¯èƒ½çš„å¤šæ¬¡è¿›è¡Œ,æˆ‘ä»¬ä»Ž$(0, 1)$å‡ºå‘, æ¯æ¬¡å–$k = 1$.å‘çŽ°è¿™æ ·ç”Ÿæˆäº†ä¸€ç»„$Fibonacci$æ•°åˆ—, è¿™é‡Œ$Fibonacci$æ•°åˆ—ä»Ž0å¼€å§‹æ ‡å·.&emsp;&emsp; é‚£ä¹ˆç¬¬ä¸€é—®çš„ç­”æ¡ˆå°±æ˜¯æ±‚æ»¡è¶³$Fib_k \le A,\; Fib_{k+1} \le B$çš„æœ€å¤§çš„$k$. åŒæ—¶, è¿™æ ·çš„æ•°å¯¹æ˜¯æ»¡è¶³$g(x, y) = k$çš„æœ€å°çš„æ•°å¯¹.&emsp;&emsp; æŽ¥ä¸‹æ¥è€ƒè™‘ç»Ÿè®¡æ–¹æ¡ˆæ•°. é¦–å…ˆ, å¯¹äºŽä¸€ç»„è¯¢é—®æˆ‘ä»¬åªéœ€è€ƒè™‘å…¶ä¸­ä¸Žæœ€ä¼˜è§£ç›¸å…³çš„$(x, y)$.&emsp;&emsp; è€ƒè™‘æ‰€æœ‰æœ€ä¼˜çš„$(x, y)$ä¼šå…·æœ‰çš„æ€§è´¨: $x \ge Fib_k, \; y \ge Fib_{k+1}$ ä¸å­˜åœ¨ä¸€ç»„$(xâ€™ &lt; x, yâ€™ &lt; y)$, ä½¿å¾—$g(xâ€™, yâ€™) &gt; g(x, y)$ &emsp;&emsp; ç„¶è€Œè¿™æ ·çš„$(x, y)$å¹¶ä¸ä¸€å®šæ˜¯æœ€ä¼˜çš„.&emsp;&emsp; æˆ‘ä»¬æŽ¥ç€åˆ†æžæ‰€æœ‰åœ¨æœ€ä¼˜è§£çš„$g$çš„è®¡ç®—è·¯å¾„ä¸Šçš„æ•°å¯¹$(x, y)$çš„æ€§è´¨: ä¸éš¾å‘çŽ°, ç»è¿‡ä¸€æ¬¡å˜åŒ–åŽå¾—åˆ°çš„$(xâ€™, yâ€™)$, ä¸€å®šæ»¡è¶³: $g(xâ€™, yâ€™) = k-1$ $xâ€™ \ge Fib_{k-1}, yâ€™ \ge Fib_{k}$ $yâ€™ \le Fib_{k+1} + Fib_{k-2}$ &emsp;&emsp; åŽé¢æ¡ä»¶çš„è§£é‡Š: è‹¥$yâ€™ &gt; Fib_{k+1} + Fib_{k-2}$, åˆ™: (x, y) = (y' > Fib_{k+1} + Fib_{k-2} > Fib_{k+1}, x' + py' \ge x' + y' > Fib_{k+2})&emsp;&emsp;$(x, y)$ä¸å†æ»¡è¶³ä¸Šè¿°æœ€ä¼˜æ€§è´¨2, çŸ›ç›¾.&emsp;&emsp; åŒæ—¶æ¯æ¬¡å‘ä¸‹ä¸€æ­¥è¿›è¡Œæž„é€ çš„æ—¶å€™åªæœ‰$(Fib_k, Fib_{k+1})$å¯èƒ½å–åˆ°$p = 2$æ‰€ä»¥è¿™æ ·çš„æ•°å¯¹ä¸ªæ•°æ˜¯$O(k)$çš„. æ‰€ä»¥æˆ‘ä»¬é¢„å¤„ç†æ‰€æœ‰çš„è¿™æ ·çš„æ•°å¯¹, ç„¶åŽç”¨é™¤æ³•ç®—ä¸‹ç­”æ¡ˆå°±å¥½äº†.&emsp;&emsp; å¤æ‚åº¦$O(log^2{MAX} + QlogMAX)$. ARCARC çš„é¢˜ç›®ä¸»è¦æ¥æºæ˜¯æ‰“è¿‡çš„å‡ åœºæ¯”èµ›, æš‚æ—¶ä¸å¤š. ARC074 E RGB Sequence ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º$N$çš„åºåˆ—å’Œ$M$ç»„çº¦æŸæ¡ä»¶, æ¯ç»„æ¡ä»¶å½¢å¦‚$L_i, R_i, X_i$, è¡¨ç¤ºåºåˆ—ä¸Šçš„$[L_i, R_i]$ä¸­æ°å¥½æœ‰$X_i$ç§é¢œè‰², çŽ°åœ¨è¦ä½ ç”¨ä¸‰ç§é¢œè‰²ç»™è¿™ä¸ªåºåˆ—æŸ“è‰², æ±‚æ»¡è¶³æ‰€æœ‰çº¦æŸçš„æ–¹æ¡ˆæ•°. $1 \le N, M \le 300$ &emsp;&emsp; $dp$çš„æ€è·¯åº”è¯¥æ¯”è¾ƒæ˜¾ç„¶, ç„¶è€Œæ™®é€šçš„çŠ¶æ€è¡¨ç¤ºä¸å¤ªå¥½å¤„ç†. æˆ‘ä»¬è®°$dp_{r, g, b}$è¡¨ç¤ºä¸‰ç§é¢œè‰²çš„çƒæœ€åŽä¸€æ¬¡å‡ºçŽ°çš„ä½ç½®åˆ†åˆ«æ˜¯$r, g, b$æ—¶çš„æ–¹æ¡ˆæ•°. &emsp;&emsp; ç„¶åŽè€ƒè™‘çŠ¶æ€çš„åˆæ³•æ€§, å¯ä»¥æŠŠæ¡ä»¶å­˜åœ¨$R_i$çš„ä½ç½®. å½“é€‰æ‹©ä¸€ä¸ªçŠ¶æ€æ—¶, è€ƒè™‘è¿™ä¸ªçŠ¶æ€çš„æœ€æœ«ä½çš„æ‰€æœ‰çº¦æŸå³å¯. ARC077 F SS å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²ä¸ºå¶çš„, å½“ä¸”ä»…å½“è¿™ä¸ªå­—ç¬¦ä¸²èƒ½å¤Ÿè¢«åˆ†æˆä¸¤ä¸ªå®Œå…¨ç›¸åŒçš„å­—ç¬¦ä¸². &emsp;&emsp; å®šä¹‰å‡½æ•°$f(s)$, å…¶ä¸­$s, f(s)$å‡æ˜¯å­—ç¬¦ä¸²,$f(s)$ä¸ºåœ¨å­—ç¬¦ä¸²$s$åŽæ·»åŠ éžç©ºçš„å­—ç¬¦æ»¡è¶³æ–°ä¸²ä¸ºå¶ä¸”é•¿åº¦æœ€å°çš„ä¸². çŽ°åœ¨ç»™ä½ ä¸²$s$(åˆå§‹ä¸ºå¶çš„), æ±‚$f^{10^{100}}(s)[L, R]$ä¸­å„ä¸ªå­—æ¯çš„å‡ºçŽ°æ¬¡æ•°.$1 \le |S| \le 2\times 10^5$$1 \le L \le R \le 10^{18}$ &emsp;&emsp; é¦–å…ˆå¯¹äºŽä¸€ä¸ªç»™å®šçš„$s$, å…¶$f(s)$å¿…å®šå”¯ä¸€. è€ƒè™‘æ¯æ¬¡æœ€å°‘åŠ ä¸€ä¸ªå­—ç¬¦,$f^{10^{100}}(s)$å°±ç­‰ä»·äºŽä¸€ä¸ªé•¿åº¦æ— ç©·çš„å­—ç¬¦ä¸². è¿™ä¸ªç­”æ¡ˆçš„å½¢å¼æ˜¾ç„¶å¯ä»¥å‰ç¼€å’Œ, åˆå› ä¸º$s$åœ¨å˜åŒ–è¿‡ç¨‹ä¸­å§‹ç»ˆæ˜¯å¶çš„, å®žé™…ä¸Šæˆ‘ä»¬åªéœ€è¦å…³æ³¨å·¦åŠéƒ¨åˆ†çš„å­—ç¬¦. &emsp;&emsp; æˆ‘ä»¬ä»Žæœ€ç®€å•çš„ä¸€æ¬¡æ“ä½œæ¥è€ƒè™‘. è®°åˆå§‹çš„å­—ç¬¦ä¸²$s$ä¸º$SS$, è®°ä¸€æ¬¡å˜åŒ–ä¹‹åŽå·¦è¾¹çš„éƒ¨åˆ†ä¸º$ST$, é‚£ä¹ˆå¾—åˆ°çš„æ–°ä¸²å°±æ˜¯$STST$. è¦ä½¿å¾—åŠ çš„å­—ç¬¦é•¿åº¦æœ€å°, å°±è¦åœ¨$S$ä¸­æ‰¾åˆ°æœ€é•¿å‰åŽç¼€åŒ¹é…é•¿åº¦, è¿™æ—¶$T$å°±æ˜¯$S$åŽ»æŽ‰æœ€é•¿åŒ¹é…åŽç¼€æ‰€å¾—. &emsp;&emsp; æˆ‘ä»¬å‘çŽ°, æ¯æ¬¡æ“ä½œéƒ½ç­‰ä»·äºŽæ‰¾åˆ°å‰åŽç¼€åŒ¹é…æœ€å¤§é•¿åº¦(å½“ç„¶è¦å°äºŽ$|S|$), ç„¶åŽå°†å‰©ä¸‹éƒ¨åˆ†çš„å‰ç¼€$T$æ·»åŠ åˆ°$S$çš„æœ«å°¾. å½“$|T| \mid |S|$æ—¶,$|S|$æœ‰é•¿ä¸º$|T|$çš„æœ€å°å‘¨æœŸ, æ¯æ¬¡åŠ å…¥çš„$|T|$ç›¸åŒ. å½“$|T| \nmid|S|$æ—¶, æˆ‘ä»¬é€šè¿‡æ‰“è¡¨å‘çŽ°, è¿™æ ·çš„$T$æ˜¯åœ¨æœ‰è§„å¾‹åœ°å˜åŒ–çš„, å› ä¸ºæ¯æ¬¡åŠ å…¥$T$ä¹‹åŽçš„ä¸²å‰åŽç¼€æœ€é•¿åŒ¹é…ä¸€å®šæ˜¯$|T|$, å¦åˆ™çš„è¯, ä¸Šä¸€æ­¥ä¸­æœ€é•¿åŒ¹é…çš„æ€§è´¨å°±ä¸ä¸€å®šä¼šæ»¡è¶³. &emsp;&emsp; ç„¶åŽæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª$Fibonacci$æ•°åˆ—? ç›´æŽ¥æš´åŠ›ç®—å°±å¥½äº†â€¦ å®žé™…ä¸Šç¬¬ä¸€ç§æƒ…å†µä¹Ÿå¯ä»¥ç›´æŽ¥ç®—, å› ä¸ºæ•´ä¸ªåºåˆ—éƒ½æ˜¯$T$çš„è‹¥å¹²æ¬¡é‡å¤å¾—åˆ°çš„.]]></content>
      <tags>
        <tag>Dynamic Programming</tag>
        <tag>Summary</tag>
        <tag>Combinatorial</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Codeforces Div2 418E]]></title>
    <url>%2F2017%2Fcf-418e%2F</url>
    <content type="text"><![CDATA[Description æ±‚æ»¡è¶³å¦‚ä¸‹æ¡ä»¶çš„ $N$ ä¸ªç‚¹çš„ç®€å•æ— å‘å›¾çš„ä¸ªæ•°å¯¹ $ 1e9 + 7 $ å–æ¨¡çš„ç»“æžœï¼š æ¯ä¸ªç‚¹çš„åº¦æ•°å‡ä¸º $2$ æˆ– $3$ ä»Žä¸€å·ç‚¹åˆ°ä»»ä½•ä¸€ä¸ªç‚¹çš„æœ€çŸ­è·¯å”¯ä¸€å¹¶ä¸”éšç€ç‚¹æ ‡å·ä¸Šå‡è€Œä¸é™. (ä¸¤ä¸ªå›¾ä¸åŒå½“ä¸”ä»…å½“è¾¹çš„é›†åˆä¸åŒ).$N &lt;= 50$ Solutionæˆ‘ä»¬å¯ä»¥è®°: $f_{i, j}$ è¡¨ç¤ºè€ƒè™‘å®Œå‰ $i$ ä¸ªç‚¹, æœ€åŽä¸€å±‚æ°å¥½æœ‰ $j$ ä¸ªç‚¹, ä¸”æœ€åŽä¸€å±‚ä¹‹å‰çš„ç‚¹åº¦æ•°å·²ç»æ»¡è¶³æ¡ä»¶æ—¶çš„æ–¹æ¡ˆæ•°. $g_{i, j, k}$ è¡¨ç¤ºå½“å‰å±‚æœ‰ $i$ ä¸ªç‚¹, ä¸Šä¸€å±‚å‰©ä¸‹æ¥ $j$ ä¸ªåº¦ä¸º $2$ çš„ç‚¹, $k$ ä¸ªåº¦ä¸º $3$ çš„ç‚¹æ—¶è¿žè¾¹çš„æ–¹æ¡ˆæ•°. é‚£ä¹ˆå®¹æ˜“å¾—åˆ°$f_{i, j} = \sum_{k} f_{i-j, k} \times g_{j, c0, c1}$, å…¶ä¸­$c0\,,c1$è¡¨ç¤ºæœ€åŽä¸€å±‚ $k$ ä¸ªç‚¹ä¸­åº¦ä¸º $2$ çš„ç‚¹å’Œåº¦ä¸º $3$ çš„ç‚¹çš„ä¸ªæ•°. å¯¹äºŽ $g$, ä¸éš¾å¾—åˆ°: g_{i, j, k} = \begin{cases} 1 & i = 0, j = 0, k = 0 \\ \sum_{l=2}^{k-1} \frac{l!}{2} {k-1 \choose l} g_{i, j, k-l-1} & i = 0, j = 0, k > 0 \\ (j-1) \cdot g_{i, j-2, k} + k \cdot g_{i, j, k-1} & i = 0, j > 0 \\ j \cdot g_{i-1, j-1, k} + k \cdot g_{i-1, j+1, k-1} & i > 0 \end{cases}Hintæ³¨æ„åœ¨ç¬¬äºŒä¸ªé€’æŽ¨å¼ä¸­ $l$ ä»Ž $2$ å¼€å§‹æžšä¸¾, å› ä¸ºä¸èƒ½æœ‰é‡è¾¹, æ‰€ä»¥ä¸å­˜åœ¨å¤§å°ä¸º $2$ çš„çŽ¯.]]></content>
      <tags>
        <tag>Dynamic Programming</tag>
        <tag>Combinatorial</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ZJOI2017 æ ‘çŠ¶æ•°ç»„]]></title>
    <url>%2F2017%2Fzjoi2017-bit%2F</url>
    <content type="text"><![CDATA[Description ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º $N$ çš„åºåˆ—ä»¥åŠ $M$ æ¬¡æ“ä½œ, æ¯æ¬¡ç­‰æ¦‚çŽ‡åœ°ä¿®æ”¹ $[L_i, R_i]$ åŒºé—´ä¸­ä¸€ä¸ªå€¼çš„å¥‡å¶æ€§, æˆ–è€…å¯¹äºŽè¯¢é—®$[L_i,R_i]$åŒºé—´ä¸­çš„å’Œçš„å¥‡å¶æ€§, åˆ¤æ–­ç»™å®šçš„ä¸€ç§é”™è¯¯ç®—æ³•è¾“å‡ºæ­£ç¡®ç­”æ¡ˆçš„æ¦‚çŽ‡æ˜¯å¤šå°‘$ N, M &lt;= 10^5 $ Solutionè€ƒè™‘è¿™ä¸ªé”™è¯¯ç®—æ³•, ç”±äºŽå¯ä»¥æŠŠ $ + lowbit $ å’Œ $ - lowbit $ éƒ½çœ‹æˆåœ¨ä¸€æ£µæ ‘ä¸Šå‘çˆ¶äº²èŠ‚ç‚¹è·³, æ ¹æ®è¿™ä¸ªæ€§è´¨å¯ä»¥çŸ¥é“é”™è¯¯ç®—æ³•æ±‚äº†ä¸€ä¸ªåŽç¼€å’Œ, æ‰€ä»¥å½“ä¸”ä»…å½“å¯¹äºŽè¯¢é—®åŒºé—´ $[L_i, R_i]$, æ»¡è¶³ $ a[L_i-1] = a[R_i] $ æ—¶å®ƒä¼šè¾“å‡ºæ­£ç¡®ç­”æ¡ˆ é‚£ä¹ˆæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª $ O(nm) $ çš„æš´åŠ›ç®—æ³•, å³æ¯ä¸€ä¸ªè¯¢é—®éƒ½æš´åŠ›æ‰«ä¹‹å‰çš„æ‰€æœ‰ä¿®æ”¹è®¡ç®—æ¦‚çŽ‡å³å¯. ç„¶è€Œè¿™æ ·è¿˜ä¸èƒ½é€šè¿‡æ‰€æœ‰æ•°æ®, è€ƒè™‘å°†åŒºé—´ $[L_i, R_i]$ è¡¨ç¤ºæˆäºŒç»´å¹³é¢ä¸Šçš„ä¸€ä¸ªç‚¹ $ (L_i, R_i)$. ç„¶åŽç”¨ä¸€ä¸ªäºŒç»´çº¿æ®µæ ‘åŽ»ç»´æŠ¤æ¯ä¸ªç‚¹ä»£è¡¨çš„ä¸¤ä¸ªç«¯ç‚¹çš„å€¼ä¸ç›¸ç­‰çš„æ¦‚çŽ‡.æ˜¾ç„¶åœ°, è¿™ä¸ªæ¦‚çŽ‡æ˜¯å¯ä»¥å¾ˆæ–¹ä¾¿çš„åˆå¹¶çš„.è¿™æ ·å¯¹äºŽæ¯æ¬¡ä¿®æ”¹$[L_i, R_i]$çš„æ“ä½œ, ç›¸å½“äºŽ: å°† $ x \in [L_i, R_i], y \in [L_i, R_i] $ ä¸­çš„ç‚¹ $(x, y)$ ä¸Ž $ \frac{2}{R_i - L_i+1} $ åˆå¹¶. å°† $ x \in [L_i, R_i], y \in (R_i, N] $ ä»¥åŠ $ x \in [0, L_i), y \in [L_i, R_i] $ ä¸Ž $ \frac{1}{R_i - L_i+1} $ åˆå¹¶. Hintæ³¨æ„åˆ°å¯¹äºŽ $ L_i = 1 $ çš„æƒ…å†µ, $ Find(0) $ ç›´æŽ¥è¿”å›žäº† $0$ è€Œéž $0$ çš„åŽç¼€å’Œè¿™ä¸ªæ—¶å€™å°±è¦ç‰¹åˆ¤ä¸€ä¸‹äº†, æ³¨æ„åˆ°æ¯æ¬¡ä¸ç®¡å¦‚ä½•ä¿®æ”¹, æœ€ç»ˆçš„æ­£ç¡®ç­”æ¡ˆæ˜¯ $R_i$ çš„å‰ç¼€å’Œ, è€Œé¢˜ä¸­æ‰€ç»™çš„æ–¹æ³•è¾“å‡ºçš„ç­”æ¡ˆæ˜¯ $R_i$ çš„åŽç¼€å’Œ. å½“å‰ä¿®æ”¹æ¬¡æ•°ä¸ºå¶æ•°, åˆ™å½“ä¸”ä»…å½“ $R_i = 0$ å‰åŽç¼€å’Œç›¸åŒ, ç›¸å½“äºŽæŸ¥è¯¢ $a[R_i] = 0$ çš„æ¦‚çŽ‡. å½“å‰ä¿®æ”¹æ¬¡æ•°ä¸ºå¥‡æ•°, åˆ™å½“ä¸”ä»…å½“ $R_i = 1$ å‰åŽç¼€å’Œç›¸åŒ, ç›¸å½“äºŽæŸ¥è¯¢ $a[R_i] = 1$ çš„æ¦‚çŽ‡. å› ä¸º $a[0]$ ä¸å¯èƒ½è¢«ä¿®æ”¹, æ‰€ä»¥ä¸Šè¿°é—®é¢˜ä¹Ÿå¯ä»¥è½¬åŒ–ä¸ºæŸ¥è¯¢ $[L_i, R_i]$ ç›¸ç­‰æ¦‚çŽ‡. Code123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112#include &lt;bits/stdc++.h&gt;using namespace std;typedef long long LL;typedef pair&lt;int, int&gt; pii;#define fst first#define snd second#define pb push_back#define getchar getchar_unlockedtemplate &lt;typename T&gt; inline bool chkmax(T&amp; a, T b) &#123; return a &lt; b ? a = b, 1 : 0; &#125;template &lt;typename T&gt; inline bool chkmin(T&amp; a, T b) &#123; return a &gt; b ? a = b, 1 : 0; &#125;const int oo = 0x3f3f3f3f;const int maxn = 1e5 + 5;const int mod = 998244353;int read() &#123; int n = 0, f = 1; char ch = getchar(); for( ;!isdigit(ch); ch = getchar()) if(ch == '-') f = -1; for( ; isdigit(ch); ch = getchar()) n = n * 10 + ch - 48; return n * f;&#125;inline int merge(int a, int b) &#123; return (a * (1LL - b + mod) % mod + b * (1LL - a + mod) % mod) % mod;&#125;int N, M, prob;namespace Seg_Tree &#123; const int SZ_X = (maxn &lt;&lt; 2) + 5; const int SZ_Y = (maxn * 400) + 5; int rt[SZ_X]; int val[SZ_Y]; int lc[SZ_Y], rc[SZ_Y], cnt;#define LC (u &lt;&lt; 1) #define RC (LC | 1)#define mid ((l+r) &gt;&gt; 1) void Add_Y(int&amp; u, int l, int r, int x, int y) &#123; if(!u) u = ++cnt; if(x &lt;= l &amp;&amp; r &lt;= y) &#123; val[u] = merge(val[u], prob); return; &#125; if(x &lt;= mid) Add_Y(lc[u], l, mid, x, y); if(y &gt; mid) Add_Y(rc[u], mid+1, r, x, y); &#125; void Add_X(int u, int l, int r, int x, int y, int x0, int y0) &#123; if(x &lt;= l &amp;&amp; r &lt;= y) &#123; Add_Y(rt[u], 0, N, x0, y0); return; &#125; if(x &lt;= mid) Add_X(LC, l, mid, x, y, x0, y0); if(y &gt; mid) Add_X(RC, mid+1, r, x, y, x0, y0); &#125; int query_Y(int u, int l, int r, int x) &#123; if(l == r) return val[u]; return merge(val[u], x &lt;= mid ? query_Y(lc[u], l, mid, x) : query_Y(rc[u], mid+1, r, x)); &#125; int query_X(int u, int l, int r, int x, int x0) &#123; if(l == r) return query_Y(rt[u], 0, N, x0); return merge(query_Y(rt[u], 0, N, x0), x &lt;= mid ? query_X(LC, l, mid, x, x0) : query_X(RC, mid+1, r, x, x0)); &#125;&#125;int fpm(int base, int exp) &#123; int res = 1; for(; exp &gt; 0; exp &gt;&gt;= 1) &#123; if(exp &amp; 1) res = 1LL * res * base % mod; base = 1LL * base * base % mod; &#125; return res;&#125;int tot = 0;void solve() &#123; N = read(); M = read(); while(M--) &#123; static int ty, l, r; ty = read(); l = read(); r = read(); if(ty == 1) &#123; static LL tmp; tmp = fpm(r-l+1, mod-2); prob = 2*tmp; Seg_Tree::Add_X(1, 0, N, l, r, l, r); prob = tmp; Seg_Tree::Add_X(1, 0, N, l, r, r+1, N); prob = tmp; Seg_Tree::Add_X(1, 0, N, 0, l-1, l, r); ++ tot; &#125;else &#123; static int ans; ans = (1-Seg_Tree::query_X(1, 0, N, l-1, r)+mod) % mod; if(!(l-1) &amp;&amp; (tot &amp; 1)) ans = (1-ans+mod) % mod; printf("%d\n", ans); &#125; &#125;&#125;int main() &#123;#ifndef ONLINE_JUDGE freopen("data.txt", "r", stdin); freopen("ans.txt", "w", stdout);#endif solve(); return 0;&#125;]]></content>
      <tags>
        <tag>Data Structure</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[NOI2016 ç½‘æ ¼]]></title>
    <url>%2F2017%2Fnoi2016-grid%2F</url>
    <content type="text"><![CDATA[Description ç»™å‡ºä¸€ä¸ª $ N \times M $ çš„ç½‘æ ¼å›¾å’Œå›¾ä¸Šçš„ $ C $ ä¸ªéšœç¢ç‰©, æ±‚æœ€å°‘åˆ åŽ»å¤šå°‘ä¸ªç‚¹å¯ä½¿å¾—åŽŸå›¾ç©ºæ ¼ä¸å››è¿žé€š.$ N, M &lt;= 10 ^ 9, C &lt;= 10 ^ 5 $ Solutionæˆ‘ä»¬å¯ä»¥å‘çŽ°, å¯èƒ½çš„ç­”æ¡ˆåªæœ‰ $ \{ -1, 0, 1, 2 \} $ å‡ ç§. è€ƒè™‘ä¸€äº›ç®€å•çš„æƒ…å†µ:ç­”æ¡ˆç­‰äºŽ $ -1 $ æ—¶, ç‚¹æ•°å°äºŽ $2$ æˆ–è€…æ°å¥½æœ‰ä¸¤ä¸ªç›¸é‚»çš„ç‚¹.ç­”æ¡ˆä¸º $ 0 $ æ—¶, æ˜¾ç„¶åŽŸå›¾ä¸è¿žé€š. é‚£ä¹ˆå°±åªéœ€çŸ¥é“ç­”æ¡ˆæ˜¯å¦ä¸º $ 1 $, å‘çŽ°ç­”æ¡ˆç­‰äºŽ $ 1 $ å½“ä¸”ä»…å½“åŽŸå›¾å­˜åœ¨å‰²ç‚¹, æš´åŠ›çš„è¯ä¸éš¾åšåˆ° $ O(n * m) $. å°†åˆ°è¾¾æ¯ä¸ªéšœç¢çš„æ›¼å“ˆé¡¿è·ç¦»ä¸è¶…è¿‡ $2$ çš„ç©ºæ ¼ç»™æå‡ºæ¥, ç„¶åŽåœ¨è¿™äº›ç‚¹ä¸­æ‰¾å‡ºä¸€ä¸ªå‰²ç‚¹, æ»¡è¶³åˆ°è¾¾æœ€è¿‘çš„éšœç¢çš„è·ç¦»ä¸è¶…è¿‡ $1$.è¿™æ ·çš„ç‚¹å°±ä¸€å®šæ˜¯åŽŸå›¾ä¸­çš„å‰²ç‚¹. Code123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282#include &lt;bits/stdc++.h&gt;using namespace std;typedef long long LL;typedef pair&lt;int, int&gt; pii;#define fst first#define snd second#define pb push_backtemplate &lt;typename T&gt; bool chkmax(T&amp; a, T b) &#123; return a &lt; b ? a = b, 1 : 0; &#125;template &lt;typename T&gt; bool chkmin(T&amp; a, T b) &#123; return a &gt; b ? a = b, 1 : 0; &#125;const int maxn = 2.5e6 + 10;const int oo = 0x3f3f3f3f;template&lt;typename T&gt; T read() &#123; T n = 0, f = 1; char ch = getchar(); for( ;!isdigit(ch); ch = getchar()) if(ch == '-') f = -1; for( ; isdigit(ch); ch = getchar()) n = n * 10 + ch - 48; return n * f;&#125;struct Hash_Map &#123; static const int mod = 1666667; int cnt = 0; int st[mod], nxt[maxn], X[maxn], Y[maxn]; inline void clear() &#123; cnt = 0; memset(st, 0, sizeof st); &#125; inline int idx(int x, int y) &#123; return ((233LL*x + (y^888))%mod + mod)%mod; &#125; int find(int x, int y) &#123; int u = idx(x, y); for(int i = st[u]; i; i = nxt[i]) if(X[i] == x &amp;&amp; Y[i] == y) return i; return -1; &#125; int insert(int x, int y) &#123; int u = idx(x, y); for(int i = st[u]; i; i = nxt[i]) if(X[i] == x &amp;&amp; Y[i] == y) return i; ++ cnt; X[cnt] = x, Y[cnt] = y; nxt[cnt] = st[u]; st[u] = cnt; return cnt; &#125;&#125;HM;LL n, m, c;const int dx[] = &#123; 0, 1, 0, -1, 1, -1, 1, -1 &#125;;const int dy[] = &#123; 1, 0, -1, 0, 1, -1, -1, 1 &#125;;int st[maxn], nxt[maxn &lt;&lt; 3], to[maxn &lt;&lt; 3], ecnt = 1;void addedge(int x, int y) &#123; to[++ecnt] = y; nxt[ecnt] = st[x]; st[x] = ecnt; to[++ecnt] = x; nxt[ecnt] = st[y]; st[y] = ecnt;&#125;int vis[maxn];int mark[maxn], now = 0;void init() &#123; ecnt = 1; HM.clear(); memset(st, 0, sizeof st);&#125;int flood_fill(int u) &#123; int res = 1; mark[u] = now; for(int i = st[u], v; i; i = nxt[i]) if(mark[v = to[i]] != now) res += flood_fill(v); return res;&#125;int area_count(int s) &#123; return ++ now, flood_fill(s); &#125;int chk() &#123; if(n*m-c &lt; 2) return -1; int res = area_count(c + 1); if(n*m == 2 || (res == 2 &amp;&amp; n*m-c == 2)) return -1; return -2;&#125;bool flag;int dfn[maxn], low[maxn], dfs_clock = 0;bool dfs(int u, int fa, bool f = false) &#123; low[u] = dfn[u] = ++dfs_clock; for(int i = st[u], v; i; i = nxt[i]) if((v = to[i]) ^ fa) &#123; if(!dfn[v]) &#123; if(dfs(v, u)) return true; if(vis[u] == 1 &amp;&amp; (low[v] &gt; dfn[u] || (!f &amp;&amp; low[v] == dfn[u]))) &#123; return true; &#125; chkmin(low[u], low[v]); &#125;else chkmin(low[u], dfn[v]); &#125;&#125;bool chk1() &#123; flag = 0; memset(dfn, dfs_clock = 0, sizeof dfn); for(int i = c+1; i &lt;= HM.cnt; i++) if(!dfn[i]) &#123; if(dfs(i, 0, 1)) return 1; &#125; return 0;&#125;#define x(i) HM.X[i]#define y(i) HM.Y[i]//char ch[1000][1000];int X[maxn], Y[maxn], idx[maxn];bool chk0() &#123; memset(idx, 0, sizeof idx); memset(vis, 0, sizeof vis); for(int i = 1; i &lt;= c; i++) HM.insert(X[i], Y[i]); for(int v = 1; v &lt;= c; v++) if(!vis[v]) &#123; vector&lt;int&gt; V; static int q[maxn]; int head = 0, tail = 0; ecnt = 1; vis[q[tail++] = v] = 3; while(head &lt; tail) &#123; int h = q[head++]; for(int i = 0; i &lt; 8; i++) &#123; int nx = x(h) + dx[i]; int ny = y(h) + dy[i]; if(nx &gt;= 1 &amp;&amp; nx &lt;= n &amp;&amp; ny &gt;= 1 &amp;&amp; ny &lt;= m) &#123; int Nxt = HM.insert(nx, ny); st[Nxt] = 0; if(Nxt &lt;= c) &#123; if(!vis[Nxt]) &#123; vis[Nxt] = 3; q[tail++] = Nxt; &#125; &#125;else if(idx[Nxt] != v) &#123; idx[Nxt] = v, V.pb(Nxt); &#125; &#125; &#125; &#125; for(int i = 0; i &lt; int(V.size()); i++) &#123; int u = V[i]; for(int j = 0; j &lt; 2; j++) &#123; int nx = x(u) + dx[j]; int ny = y(u) + dy[j]; if(nx &gt;= 1 &amp;&amp; nx &lt;= n &amp;&amp; ny &gt;= 1 &amp;&amp; ny &lt;= m) &#123; int Nxt = HM.find(nx, ny); if(idx[Nxt] == v) addedge(u, Nxt); &#125; &#125; &#125; if(V.size() &amp;&amp; area_count(V[0]) != int(V.size())) return true; &#125; return false;&#125;void build() &#123; memset(vis, 0, sizeof vis); int tail = 0; static int q[maxn]; for(int i = 1; i &lt;= c; i++) HM.insert(X[i], Y[i]), vis[i] = 3; for(int i = 1; i &lt;= c; i++) for(int j = 0; j &lt; 8; j++) &#123; int nx = X[i] + dx[j]; int ny = Y[i] + dy[j]; if(nx &gt;= 1 &amp;&amp; nx &lt;= n &amp;&amp; ny &gt;= 1 &amp;&amp; ny &lt;= m) &#123; int Nxt = HM.insert(nx, ny); if(!vis[Nxt]) &#123; vis[Nxt] = 1; q[tail++] = Nxt; &#125; &#125; &#125; int lim = tail; for(int i = 0; i &lt; lim; i++) &#123; for(int j = 0; j &lt; 8; j++) &#123; int nx = x(q[i]) + dx[j]; int ny = y(q[i]) + dy[j]; if(nx &gt;= 1 &amp;&amp; nx &lt;= n &amp;&amp; ny &gt;= 1 &amp;&amp; ny &lt;= m) &#123; int Nxt = HM.insert(nx, ny); if(!vis[Nxt]) &#123; vis[Nxt] = 2; q[tail++] = Nxt; &#125; &#125; &#125; &#125; for(int i = 0; i &lt; tail; i++) &#123; for(int j = 0; j &lt; 2; j++) &#123; int nx = x(q[i]) + dx[j]; int ny = y(q[i]) + dy[j]; if(nx &gt;= 1 &amp;&amp; nx &lt;= n &amp;&amp; ny &gt;= 1 &amp;&amp; ny &lt;= m) &#123; int Nxt = HM.find(nx, ny); if(Nxt &gt; c) addedge(q[i], Nxt); &#125; &#125; &#125;&#125;int spe() &#123; int res = 0; if(n == 1) &#123; Y[++c] = 0; Y[++c] = m+1; sort(Y+1, Y+c+1); for(int i = 2; i &lt;= c; i++) if(Y[i] - Y[i-1] &gt; 1) ++ res; &#125;else &#123; X[++c] = 0; X[++c] = n+1; sort(X+1, X+c+1); for(int i = 2; i &lt;= c; i++) if(X[i] - X[i-1] &gt; 1) ++ res; &#125; return res &gt;= 2 ? 0 : 1;&#125;int main() &#123;#ifndef ONLINE_JUDGE freopen("data.txt", "r", stdin); freopen("ans.txt", "w", stdout);#endif for(int T = read&lt;int&gt;(); T--; ) &#123; init(); n = read&lt;int&gt;(); m = read&lt;int&gt;(); c = read&lt;int&gt;(); for(int i = 1; i &lt;= c; i++) &#123; X[i] = read&lt;int&gt;(); Y[i] = read&lt;int&gt;(); &#125; if(chk0()) &#123; puts("0"); continue; &#125; init(); build(); static int ans; if((ans = chk()) != -2) &#123; &#125; else if(min(n, m) == 1) &#123; ans = spe(); &#125; else &#123; ans = chk1() ? 1 : 2; if(c == 0) ans = min(n, m) == 1 ? 1 : 2; &#125; printf("%d\n", ans); &#125; return 0;&#125;]]></content>
      <tags>
        <tag>Graph Theory</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Codeforces 553E Kyoya and Train]]></title>
    <url>%2F2017%2Fcf-553e%2F</url>
    <content type="text"><![CDATA[Description ç»™å®š $N$ ä¸ªç‚¹, $M$ æ¡è¾¹çš„æœ‰å‘å›¾.æ¯æ¡è¾¹æœ‰èŠ±è´¹: é€šè¿‡ç¬¬ $i$ æ¡è¾¹çš„æ—¶é—´æœ‰ $ P _ {i1} $ çš„æ¦‚çŽ‡ä¸º $1$, $P _ {i2}$ çš„æ¦‚çŽ‡ä¸º $2$â€¦å¦‚æžœæ€»ç”¨æ—¶è¶…è¿‡ $T$ åˆ™ä¼šè¢«ç½šé’± $X$ å…ƒ, æ±‚ä»Ž $1$ å·ç‚¹åˆ° $n$ å·ç‚¹çš„æœ€å°æœŸæœ›èŠ±è´¹.$ N \leq 50, M \leq 100, T \leq 100000 $ Solutionè€ƒè™‘æš´åŠ›DP, è®°çŠ¶æ€ $ dp _ {i, t} $ è¡¨ç¤ºåˆ°è¾¾ $i$ å·ç‚¹, ä¸”ç»è¿‡çš„æ—¶é—´ä¸º $t$ çš„æœ€å°æœŸæœ›èŠ±è´¹, è½¬ç§»ååˆ†æ˜¾ç„¶.åŒæ—¶å› ä¸ºçŠ¶æ€ä¹‹é—´æŒ‰ç…§æ—¶é—´æž„æˆä¸€ä¸ªæ‹“æ‰‘å›¾, æ‰€ä»¥è½¬ç§»ä¸å­˜åœ¨çŽ¯. å¯ä»¥è®° $S _ {e, t}$ è¡¨ç¤ºè¾¹ $e$ åœ¨æ—¶åˆ» $t$ ä¹‹åŽåŽç»§çŠ¶æ€çš„æœ€å°æœŸæœ›èŠ±è´¹. åˆ™å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªå¼å­è®¡ç®— $dp _ {e, t}$: dp _ {i, t} = min \left\{ S _ {e, t} + cost _ e \right\}$e$ æ˜¯ $i$ çš„å‡ºè¾¹. æŽ¥ä¸‹æ¥è€ƒè™‘å¦‚ä½•è®¡ç®— $S(e,t)$, åˆ©ç”¨å®šä¹‰: S _ {e, t} = \sum _ {i = 1}^{T} dp _ {to _ e, t + i} * P _ {ei}è¿™æ ·å˜æˆå·ç§¯å½¢å¼, åˆ†æ²» $FFT$ å³å¯. Code123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145#include&lt;bits/stdc++.h&gt;using namespace std;typedef long long LL;typedef pair&lt;int, int&gt; pii;const int oo = 0x3f3f3f3f;const int maxn = 200000 + 10;const double PI = acos(-1.0);template &lt;typename T&gt; bool chkmax(T&amp; a, T b) &#123; return a &lt; b ? a = b, 1 : 0; &#125;template &lt;typename T&gt; bool chkmin(T&amp; a, T b) &#123; return a &gt; b ? a = b, 1 : 0; &#125;#define fst first#define snd second#define debug(x) cerr &lt;&lt; #x &lt;&lt; ":" &lt;&lt; (x) &lt;&lt; endl#define REP(i, a, b) for(int i = (a), i##end = (b); i &lt; i##end; ++i)#define DREP(i, a, b) for(int i = (a)-1, i##bgn = (b); i &gt;= i##bgn; --i)template&lt;typename T&gt; T read() &#123; T n = 0, f = 1; char ch = getchar(); for( ;!isdigit(ch); ch = getchar()) if(ch == '-') f = -1; for( ; isdigit(ch); ch = getchar()) n = n * 10 + ch - 48; return n * f;&#125;struct Complex &#123; double real, imag; Complex(double r = 0.0, double i = 0.0): real(r), imag(i) &#123;&#125; Complex operator + (const Complex&amp; rhs) const &#123; return Complex(real + rhs.real, imag + rhs.imag); &#125; Complex operator - (const Complex&amp; rhs) const &#123; return Complex(real - rhs.real, imag - rhs.imag); &#125; Complex operator * (const Complex&amp; rhs) const &#123; return Complex(real*rhs.real - imag*rhs.imag, real*rhs.imag + imag*rhs.real); &#125; Complex operator / (const double&amp; div) const &#123; return Complex(real / div, imag / div); &#125;&#125;;int rev[maxn];void DFT(Complex *x, int N, int t) &#123; for(int i = 0; i &lt; N; i++) if(i &lt; rev[i]) swap(x[i], x[rev[i]]); for(int l = 2; l &lt;= N; l &lt;&lt;= 1) &#123; Complex wn = Complex(cos(2*PI*t/l), sin(2*PI*t/l)); for(int i = 0; i &lt; N; i += l) &#123; Complex w = Complex(1, 0); for(int j = 0; j &lt; (l &gt;&gt; 1); j++, w = w * wn) &#123; Complex L = x[i + j]; Complex R = x[i + j + (l &gt;&gt; 1)] * w; x[i + j] = L + R; x[i + j + (l &gt;&gt; 1)] = L - R; &#125; &#125; &#125; if(!~t) for(int i = 0; i &lt; N; i++) x[i] = x[i] / N;&#125;const int N = 100 + 5;int dis[N][N];int n, m, t, x;struct Edge &#123; int u, v, c; double p[maxn]; void input() &#123; u = read&lt;int&gt;(), v = read&lt;int&gt;(), c = read&lt;int&gt;(); chkmin(dis[u][v], c); for(int i = 1; i &lt;= t; i++) p[i] = double(read&lt;int&gt;()) / 100000.0; &#125;&#125;E[N];Complex A[maxn], B[maxn];double S[N][maxn], f[N][maxn];void calc(int l, int r, int mid) &#123; static int base, len; for(int k = 0; k &lt; m; k++) &#123; int v = E[k].v; for(base = 1, len = 0; base &lt;= 2*r-l-mid+1; base &lt;&lt;= 1) ++ len; for(int i = 0; i &lt; base; i++) rev[i] = (rev[i&gt;&gt;1] &gt;&gt; 1) | ((i&amp;1) &lt;&lt; (len-1)); for(int i = 0; i &lt; base; i++) A[i] = B[i] = Complex(0, 0); for(int i = 0; i &lt; r-mid; i++) A[i] = Complex(f[v][r-i], 0); for(int i = 1; i &lt;= r-l; i++) B[i-1] = Complex(E[k].p[i], 0); DFT(A, base, 1); DFT(B, base, 1); for(int i = 0; i &lt; base; i++) A[i] = A[i] * B[i]; DFT(A, base, -1); for(int i = l; i &lt;= mid; i++) S[k][i] += A[r-i-1].real; &#125;&#125;void cdq_solve(int l, int r) &#123; if(l == r) &#123; for(int i = 0; i &lt; m; i++) chkmin(f[E[i].u][l], S[i][l] + E[i].c); return; &#125; int mid = (l + r) &gt;&gt; 1; cdq_solve(mid+1, r); calc(l, r, mid); cdq_solve(l, mid);&#125;int main() &#123;#ifndef ONLINE_JUDGE freopen("data.txt", "r", stdin); freopen("ans.txt", "w", stdout);#endif memset(dis, oo, sizeof dis); n = read&lt;int&gt;(), m = read&lt;int&gt;(), t = read&lt;int&gt;(), x = read&lt;int&gt;(); for(int i = 1; i &lt;= n; i++) dis[i][i] = 0; for(int i = 0; i &lt; m; i++) E[i].input(); for(int k = 1; k &lt;= n; k++) for(int i = 1; i &lt;= n; i++) for(int j = 1; j &lt;= n; j++) chkmin(dis[i][j], dis[i][k] + dis[k][j]); for(int i = 1; i &lt;= n; i++) &#123; for(int T = 0; T &lt;= t; T++) f[i][T] = (i == n) ? 0 : oo; for(int T = t+1; T &lt;= 2*t; T++) f[i][T] = dis[i][n] + x; &#125; calc(1, t*2, t); cdq_solve(0, t); printf("%.10lf\n", f[1][0]); return 0;&#125;]]></content>
      <tags>
        <tag>Dynamic Programming</tag>
        <tag>Generating Function</tag>
        <tag>Probability</tag>
      </tags>
  </entry>
</search>
