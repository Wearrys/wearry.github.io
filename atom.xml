<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Wearry&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2020-08-17T01:50:55.954Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Wearry</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>A brief proof of Birthday Paradox</title>
    <link href="http://yoursite.com/2020/birthday-paradox/"/>
    <id>http://yoursite.com/2020/birthday-paradox/</id>
    <published>2020-08-16T15:07:06.000Z</published>
    <updated>2020-08-17T01:50:55.954Z</updated>
    
    <content type="html"><![CDATA[<h1 id="introduction"><em>Introduction</em></h1><h2 id="birthday-paradox"><em>Birthday Paradox</em></h2><blockquote><p>There are <span class="math inline">\(k\)</span> people whose birthdays are among set <span class="math inline">\(B\)</span> with size <span class="math inline">\(n\)</span>, the probability that there are <strong>at least</strong> a pair of people have the same birthday is greater than <span class="math inline">\(\frac{1}{2}\)</span> when <span class="math inline">\(k \ge 1.2 \sqrt{n} + 1\)</span></p></blockquote><a id="more"></a><h1 id="proof"><em>Proof</em></h1><p>Suppose each person's birthday is <strong>independent uniform</strong> in <span class="math inline">\(B\)</span>, then the probability that don't exist such a pair is:</p><p><span class="math display">\[P = \prod_{i=0}^{k-1} \left(1 - \frac{i}{n}\right)\]</span></p><p>to prove <span class="math inline">\(P \le \frac{1}{2}\)</span>, we use the result in analysis that:</p><blockquote><p><span class="math inline">\(\forall x \in \mathbb{R}, 1 + x \le \mathrm{e}^x\)</span> <img src="/img/exp.png"></p></blockquote><p>then:</p><p><span class="math display">\[\begin{aligned}P &amp;\le \exp \left(\sum_{i=0}^{k-1} -\cfrac{i}{n}\right) \\&amp;\le \exp \left(-\frac{(k-1)^2}{2n}\right) \\&amp;\le \exp \left(-\frac{(1.2 \sqrt{n})^2}{2n}\right) \\&amp;= \exp(-0.72) &lt; \frac{1}{2} \\\end{aligned}\]</span></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;introduction&quot;&gt;&lt;em&gt;Introduction&lt;/em&gt;&lt;/h1&gt;
&lt;h2 id=&quot;birthday-paradox&quot;&gt;&lt;em&gt;Birthday Paradox&lt;/em&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;There are &lt;span class=&quot;math inline&quot;&gt;\(k\)&lt;/span&gt; people whose birthdays are among set &lt;span class=&quot;math inline&quot;&gt;\(B\)&lt;/span&gt; with size &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt;, the probability that there are &lt;strong&gt;at least&lt;/strong&gt; a pair of people have the same birthday is greater than &lt;span class=&quot;math inline&quot;&gt;\(\frac{1}{2}\)&lt;/span&gt; when &lt;span class=&quot;math inline&quot;&gt;\(k \ge 1.2 \sqrt{n} + 1\)&lt;/span&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Probability" scheme="http://yoursite.com/tags/Probability/"/>
    
      <category term="Real Analysis" scheme="http://yoursite.com/tags/Real-Analysis/"/>
    
  </entry>
  
  <entry>
    <title>Cryptography Notes</title>
    <link href="http://yoursite.com/2020/cryptography/"/>
    <id>http://yoursite.com/2020/cryptography/</id>
    <published>2020-07-07T13:37:14.000Z</published>
    <updated>2020-08-26T18:32:29.702Z</updated>
    
    <content type="html"><![CDATA[<p>Some notes of ğŸ”’ cryptography lessons</p><p><strong>TODO</strong>:</p><ul class="task-list"><li><input type="checkbox" disabled checked>Reconstruct the architecture of this post</li><li><input type="checkbox" disabled>Complete other contents</li></ul><a id="more"></a><h1 id="preliminary-fundamental-discrete-probability"><em>Preliminary: Fundamental Discrete Probability</em></h1><p>Suppose <span class="math inline">\(U\)</span> is a finite set.</p><h2 id="probability-distribution"><em>Probability Distribution</em></h2><blockquote><p>a <code>probability distribution</code> <span class="math inline">\(P\)</span> over <span class="math inline">\(U\)</span> is a function <span class="math display">\[P: U \rightarrow [0,1]\]</span> s.t. <span class="math display">\[\sum_{x \in U} P(x) = 1\]</span></p></blockquote><p>Some examples:</p><ul><li>Uniform distribution: <span class="math inline">\(\forall x \in U, P(x) = \dfrac{1}{|U|}\)</span></li><li>Pointed distribution: <span class="math inline">\(\exists x \in U, P(x) = 1\)</span></li></ul><h2 id="event"><em>Event</em></h2><blockquote><p>an <code>event</code> is a subset <span class="math inline">\(E\)</span> of <span class="math inline">\(U\)</span>, define the probability of <span class="math inline">\(E\)</span> under <code>probability distribution</code> <span class="math inline">\(P\)</span> as below: <span class="math display">\[Pr[E] = \sum_{x \in E} P(x)\]</span></p></blockquote><h3 id="the-union-bound"><em>The Union Bound</em></h3><p>By definition, we can obviously get:</p><p><span class="math display">\[Pr[A_1 \cap A_2] + Pr[A_1 \cup A_2] = Pr[A_1] + Pr[A_2]\]</span></p><p>Which also implies that:</p><p><span class="math display">\[Pr[A_1 \cup A_2] \le Pr[A_1] + Pr[A_2]\]</span></p><h2 id="random-variable"><em>Random Variable</em></h2><blockquote><p>a <code>random variable</code> <span class="math inline">\(X\)</span> is a function <span class="math display">\[X:U \rightarrow V\]</span> where <span class="math inline">\(V\)</span> is <strong>range</strong> of <span class="math inline">\(X\)</span></p></blockquote><p>Example <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>:</p><p><span class="math display">\[\begin{aligned}X:\{0, 1\}^n \rightarrow \{0, 1\} \\X(b) = LSB(b) \in \{0, 1\}\end{aligned}\]</span></p><p>As you can see, <code>random variable</code> <span class="math inline">\(X\)</span> can also induce <code>probability distribution</code> from <span class="math inline">\(U\)</span> to <span class="math inline">\(V\)</span> (Suppose <span class="math inline">\(P\)</span> is a distribution on <span class="math inline">\(U\)</span>):</p><p><span class="math display">\[\forall v \in V, Q(v) = Pr[X = v] = Pr[X^{-1}(v)]\]</span></p><h3 id="uniform-random-variable"><em>Uniform Random Variable</em></h3><p>Specially, when <span class="math inline">\(P\)</span> is uniform distribution and <span class="math inline">\(X(r) = r\)</span> for all <span class="math inline">\(r \in U\)</span>, then:</p><p><span class="math display">\[\forall r \in U, Pr[X = r] = \frac{1}{|U|}\]</span></p><p>this is called <code>uniform random variable</code>, denoted by <span class="math inline">\(X \xleftarrow{R} U\)</span></p><h2 id="independence"><em>Independence</em></h2><ul><li>Two <code>events</code> <span class="math inline">\(A, B\)</span> are independent <strong>iff</strong>: <span class="math inline">\(Pr[A \cap B] = Pr[A] \times Pr[B]\)</span></li><li>Two <code>random variables</code> <span class="math inline">\(A, B\)</span> are independent <strong>iff</strong> <span class="math inline">\(\forall a \in V_A, b \in V_B\)</span>:</li></ul><p><span class="math display">\[Pr[A = a \,\,\mathrm{and}\,\, B = b] = Pr[A = a] \times Pr[B = b]\]</span></p><blockquote><p>For better understanding of independence, consider the example below: Suppose a dice numbered by <span class="math inline">\(D = \{1, 2, \dots, 6\}\)</span> and 2 <code>random variables</code> <span class="math inline">\(A, B\)</span>: <span class="math display">\[ \begin{aligned}&amp;A:D \rightarrow \{0, 1\} &amp;A(x) = [x \equiv 0 \pmod 2] \\&amp;B:D \rightarrow \{0, 1\} &amp;B(x) = [x \equiv 0 \pmod 3] \end{aligned} \]</span> For uniform distribution of <span class="math inline">\(D\)</span>, <span class="math inline">\(A, B\)</span> are obviously independent. Think about conditions below:</p><ol type="1"><li><span class="math inline">\(B(x) = [x \equiv 0 \pmod 4]\)</span></li><li><span class="math inline">\(D = \{1, 2, \dots, 5\}\)</span></li></ol></blockquote><h2 id="more-about-probability"><em>More about Probability</em></h2><p><a href="https://crypto.stanford.edu/~blynn/pr/" target="_blank" rel="noopener">See also</a></p><h1 id="i-pseudorandomness"><em>I: Pseudorandomness</em></h1><p><code>Pseudorandomness</code> measures the extent to which a sequence of numbers, though produced by a completely deterministic and repeatable process, appear to be patternless.</p><h2 id="pseudo-random-generator"><em>Pseudo-random Generator</em></h2><p>A <code>Pseudo-random Generator</code>, or <code>PRG</code> for short, is an efficient, deterministic algorithm <span class="math inline">\(G\)</span> that given as input a <code>seed</code> <span class="math inline">\(s\)</span>, computes an output <span class="math inline">\(r\)</span>. Both <span class="math inline">\(s\)</span> and <span class="math inline">\(r\)</span> come from a finite space, called <span class="math inline">\(\mathcal{S}\)</span> and <span class="math inline">\(\mathcal{R}\)</span> respectively.</p><p>Typically <span class="math inline">\(\mathcal{S}\)</span> and <span class="math inline">\(\mathcal{R}\)</span> are sets of bit strings of some prescribed length. We can also regard <span class="math inline">\(G\)</span> as an abstract function defined over <span class="math inline">\(\mathcal{(S, R)}\)</span>:</p><p><span class="math display">\[G: \mathcal{S} = \{0, 1\}^l \rightarrow \mathcal{R} = \{0, 1\}^L\]</span></p><h3 id="security"><em>Security</em></h3><p>We say a PRG <span class="math inline">\(G\)</span> is secure if <span class="math inline">\(G(s)\)</span> and <span class="math inline">\(r\)</span> are <strong>computational indistinguishable</strong>, among which <span class="math inline">\(s\)</span> is chosen uniform randomly from <span class="math inline">\(\mathcal{S}\)</span> and <span class="math inline">\(r\)</span> is chosen at random from <span class="math inline">\(\mathcal{R}\)</span>.</p><p>To illustrate <strong>computational indistinguishability</strong>, the definition is formulated as an attack game:</p><blockquote><h4 id="attack-game-prg-and-advantage"><em>Attack Game (PRG) and Advantage</em></h4><p>For a given PRG <span class="math inline">\(G\)</span> defined over <span class="math inline">\(\mathcal{(S, R)}\)</span>, and for a given adversary <span class="math inline">\(\mathcal{A}\)</span>, we define two experiments, Experiment <span class="math inline">\(0\)</span> and Experiment <span class="math inline">\(1\)</span>:</p><p><strong>Experiment</strong> <span class="math inline">\(b\)</span>:</p><ul><li><p>The Challenger computes <span class="math inline">\(r \in \mathcal{R}\)</span> as follows: <img src="/img/PRG-ADV.png" alt="PRG-ADV"></p><ul><li>if <span class="math inline">\(b = 0\)</span>, <span class="math inline">\(s \xleftarrow{R} \mathcal{S}, r \leftarrow G(s)\)</span></li><li>if <span class="math inline">\(b = 1\)</span>, <span class="math inline">\(r \xleftarrow{R} \mathcal{R}\)</span></li></ul></li><li><p>Given <span class="math inline">\(r\)</span>, the adversary computes and outputs a bit <span class="math inline">\(\hat{b} \in \{0, 1\}\)</span></p></li></ul><p>For <span class="math inline">\(b \in \{0, 1\}\)</span>, let <span class="math inline">\(W_b\)</span> be the event that <span class="math inline">\(\mathcal{A}\)</span> outputs <span class="math inline">\(\hat{b} = 1\)</span> in Experiment <span class="math inline">\(b\)</span>. We define <span class="math inline">\(\mathcal{A}\)</span>'s <code>advantage</code> with respect to <span class="math inline">\(G\)</span> as</p><p><span class="math display">\[PRG_{adv} [\mathcal{A}, G] = \left|Pr[W_0] - Pr[W_1]\right|\]</span></p></blockquote><p>Now we can define a PRG <span class="math inline">\(G\)</span> is <strong>secure</strong> if the value <span class="math inline">\(PRG_{adv} [\mathcal{A}, G]\)</span> is negligible <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> for all efficient adversaries <span class="math inline">\(\mathcal{A}\)</span>.</p><h2 id="pseudo-random-function"><em>Pseudo-random Function</em></h2><p>A <code>Pseudo-random Function(PRF)</code> <span class="math inline">\(F\)</span> is a deterministic algorithm that has two inputs: a <code>key</code> <span class="math inline">\(k\)</span> and an <code>input data block</code> <span class="math inline">\(x\)</span>; its output <span class="math inline">\(y := F(k, x)\)</span> is called an <code>output data block</code>. We denote the finite space of <span class="math inline">\(k, x, y\)</span> with <span class="math inline">\(\mathcal{(K, X, Y)}\)</span>, over which is <span class="math inline">\(F\)</span> defined.</p><p>Intuitively, our notion of security says that for a randomly chosen key <span class="math inline">\(k\)</span>, <span class="math inline">\(F(k, \cdot )\)</span> is indistinguishable from a random function from <span class="math inline">\(\mathcal{X}\)</span> to <span class="math inline">\(\mathcal{Y}\)</span></p><blockquote><h3 id="notation"><strong>Notation</strong></h3><p><span class="math display">\[Funs[\mathcal{X, Y}] = \{f: \mathcal{X} \rightarrow \mathcal{Y}\}\]</span> clearly we know that <span class="math display">\[|Funs[\mathcal{X, Y}]| = |\mathcal{Y}|^{|\mathcal{X}|}\]</span></p></blockquote><h3 id="attack-game-prf">Attack Game (PRF)</h3><p>Similarly we can define two experiments, Experiment <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>, for a PRF <span class="math inline">\(F\)</span> defined over <span class="math inline">\(\mathcal{(K, X, Y)}\)</span>:</p><p><strong>Experiment</strong> <span class="math inline">\(b\)</span>:</p><ul><li>The challenger selects <span class="math inline">\(f\)</span> as follows:<ul><li>if <span class="math inline">\(b = 0\)</span>, <span class="math inline">\(k \xleftarrow{R} \mathcal{K}, f \leftarrow F(k, \cdot)\)</span></li><li>if <span class="math inline">\(b = 1\)</span>, <span class="math inline">\(f \xleftarrow{R} Funs[\mathcal{X, Y}]\)</span></li></ul></li><li>The adversary <span class="math inline">\(\mathcal{A}\)</span> submits a sequence of queries <span class="math inline">\(x_1, \dots, x_q\)</span>, and receives <span class="math inline">\(y_i = f(x_i)\)</span> for each <span class="math inline">\(i\)</span> from the challenger</li><li>The adversary computes <span class="math inline">\(\hat{b} \in {0, 1}\)</span></li></ul><p>Let <span class="math inline">\(W_b\)</span> be the event <span class="math inline">\(\mathcal{A}\)</span> outputs <span class="math inline">\(1\)</span> in Experiment <span class="math inline">\(b\)</span>, the <code>advantage</code> is also defined by:</p><p><span class="math display">\[PRF_{adv} [\mathcal{A}, F] = |Pr[W_0] - Pr[W_1]|\]</span></p><p>We say a PRF <span class="math inline">\(F\)</span> is <strong>secure</strong> if all efficient adversary <span class="math inline">\(A\)</span> have a negligible advantage.</p><h2 id="pseudo-random-permutation"><em>Pseudo-random Permutation</em></h2><p>Also called <a href="#bc">Block Cipher</a>, is a special PRF which is also invertible.</p><h1 id="ii-cipher"><em>II: Cipher</em></h1><p>Throughout history, there were many ways of encryption, however, some of them have been proved unsafe. The question now is whether a particular <code>cipher</code> is <strong>secure</strong> and how to construct a <strong>secure</strong> one.</p><h2 id="stream-cipher"><em>Stream Cipher</em></h2><blockquote><p>A <code>cipher</code> defined over a triple <span class="math inline">\((\mathcal{K, M, C})\)</span> is a pair of <strong>efficient</strong><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> algos <span class="math inline">\((E, D)\)</span> where:</p><p><span class="math display">\[\begin{aligned}E: \mathcal{K \times M} \rightarrow \mathcal{C} \\D: \mathcal{K \times C} \rightarrow \mathcal{M}\end{aligned}\]</span> s.t. <span class="math inline">\(\forall m \in \mathcal{M}, k \in \mathcal{K}\)</span> <span class="math display">\[m = D(k, E(k, m))\]</span> and <span class="math inline">\(\mathcal{K, M, C}\)</span> denote the space of keys, messages and cipher texts.</p></blockquote><h3 id="otp"><em>One Time Pad</em></h3><p>An example cipher over <span class="math inline">\(\mathcal{K, M, C} = \{0, 1\}^n\)</span> and:</p><p><span class="math display">\[\begin{aligned}E(k, m) = k \oplus m \\D(k, m) = k \oplus m \\\end{aligned}\]</span></p><h2 id="perfect-secrecy"><em>Perfect Secrecy</em></h2><p>The basic idea behind perfect secrecy is: cipher text should reveal no "info" about plain text.</p><blockquote><p>A <code>cipher</code> <span class="math inline">\((E, D)\)</span> over <span class="math inline">\(\{\mathcal{K, M, C}\}\)</span> has <code>perfect secrecy</code> <strong>iff</strong>:</p><p><span class="math inline">\(\forall m_0, m_1 \in \mathcal{M} \,\,\mathrm{that}\,\, |m_0| = |m_1|, c \in \mathcal{C}\)</span>: <span class="math display">\[Pr[E(k, m_0) = c] = Pr[E(k, m_1) = c]\]</span> where <span class="math inline">\(k \xleftarrow{R} \mathcal{K}\)</span></p></blockquote><p>It's not hard to see that when attacker gets a cipher text, he will have no idea what the plain text is. By definition, we can also prove <a href="#otp">One Time Pad</a> has <code>perfect secrecy</code>.</p><p>However, <code>perfect secrecy</code> is too hard to satisfy because we have theorem below:</p><blockquote><p>If a <code>cipher</code> has <code>perfect secrecy</code>, then: <span class="math display">\[|\mathcal{K}| \ge |\mathcal{M}|\]</span> which means the length of keys mustn't less than length of messages.</p></blockquote><p>That somehow makes no sense for if we have some way sending and receiving such long keys secretly, then it's absolutely unnecessary to use <code>cipher</code>.</p><h2 id="bc"><em>Block Cipher</em></h2><h1 id="iii-mac"><em>III: MAC</em></h1><h1 id="iv-attack-security"><em>IV: Attack &amp; Security</em></h1><section class="footnotes" role="doc-endnotes"><hr><ol><li id="fn1" role="doc-endnote"><p>LSB is a function which gets the last significant bit of a bit-string.<a href="#fnref1" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li><li id="fn2" role="doc-endnote"><p>Negligible means small enough so that cannot be detected even by enormous samples.<a href="#fnref2" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li><li id="fn3" role="doc-endnote"><p>Theoretically, efficient means runs in polynomial time; Practically it means runs within a certain time period.<a href="#fnref3" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li></ol></section>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Some notes of ğŸ”’ cryptography lessons&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;TODO&lt;/strong&gt;:&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;input type=&quot;checkbox&quot; disabled checked&gt;
Reconstruct the architecture of this post&lt;/li&gt;
&lt;li&gt;&lt;input type=&quot;checkbox&quot; disabled&gt;
Complete other contents&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Probability" scheme="http://yoursite.com/tags/Probability/"/>
    
      <category term="Number Theory" scheme="http://yoursite.com/tags/Number-Theory/"/>
    
      <category term="Induction" scheme="http://yoursite.com/tags/Induction/"/>
    
  </entry>
  
  <entry>
    <title>è‹¥å¹²è¶£é¢˜</title>
    <link href="http://yoursite.com/2020/exercise-of-thoughts/"/>
    <id>http://yoursite.com/2020/exercise-of-thoughts/</id>
    <published>2020-02-10T14:04:22.000Z</published>
    <updated>2020-06-22T09:24:00.420Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å†™åœ¨å‰é¢">å†™åœ¨å‰é¢</h2><p>å®…å®¶æ²¡äº‹çš„æ—¶å€™æ‰¾çš„ä¹å­ï¼Œä¸å®šæœŸæ›´æ–°ï¼Œå¤§æ¦‚ã€‚</p><a id="more"></a><h2 id="section">1</h2><h3 id="description">Description</h3><p>æœ‰ <span class="math inline">\(n\)</span> ä¸ªäººï¼Œå…¶ä¸­æœ‰å¥½æœ‰åï¼Œæ¯ä¸ªäººéƒ½çŸ¥é“å…¶ä»–ä»»ä½•äººæ˜¯å¥½æ˜¯åï¼Œç°åœ¨å¯ä»¥è¿›è¡Œè‹¥å¹²æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®å½¢å¦‚ <span class="math inline">\((i, j)\)</span>ï¼Œè¡¨ç¤ºé—®ç¬¬ <span class="math inline">\(i\)</span> ä¸ªäººç¬¬ <span class="math inline">\(j\)</span> ä¸ªäººæ˜¯å¦æ˜¯å¥½äºº <span class="math inline">\((i \neq j)\)</span>ï¼ŒåŒæ—¶å¥½äººä¸€å®šè¯´çœŸè¯ï¼Œåäººå¯èƒ½è¯´å‡è¯ï¼Œé—®ï¼š</p><ol type="1"><li>å¦‚æœæœ‰å¤šäºä¸€åŠçš„äººæ˜¯å¥½çš„ï¼Œæ˜¯å¦å­˜åœ¨ç­–ç•¥èƒ½å¤Ÿåœ¨ä¸è¶…è¿‡ <span class="math inline">\(n\)</span> æ¬¡è¯¢é—®ä¸‹ç¡®å®šä¸€ä¸ªå¥½äººã€‚</li><li>å¦‚æœæœ‰æ°å¥½ä¸€åŠçš„äººæ˜¯åäººï¼Œæ˜¯å¦å­˜åœ¨ä¸Šè¿°ç­–ç•¥ã€‚</li></ol><h3 id="solution">Solution</h3><h4 id="section-1">1</h4><p>è€ƒè™‘ç»´æŠ¤ä¸€ä¸ªåºåˆ—ï¼Œåˆå§‹æ—¶åŠ å…¥ç¼–å·ä¸º <span class="math inline">\(1\)</span> çš„äººï¼Œæ¥ä¸‹æ¥ä¾æ¬¡å°†å…¶ä»–äººåŠ å…¥ï¼Œæ¯æ¬¡åŠ å…¥çš„æ—¶å€™è¯¢é—®åºåˆ—æœ«å°¾çš„äººè¿™ä¸ªäººæ˜¯å¥½äººè¿˜æ˜¯åäººï¼Œå¦‚æœç­”æ¡ˆæ˜¯åäººåˆ™åˆ é™¤æœ«å°¾ï¼Œå¦åˆ™å°†è¿™ä¸ªæ–°åŠ å…¥çš„ä½œä¸ºæœ«å°¾ï¼Œæ­£ç¡®æ€§ä¸éš¾éªŒè¯ï¼š</p><ol type="1"><li>æ¯æ¬¡åˆ é™¤çš„è‡³å°‘æœ‰ä¸€ä¸ªåäººï¼Œå› æ­¤æœ€ååºåˆ—å‰©ä¸‹çš„äººä¸­è‡³å°‘æœ‰ä¸€ä¸ªå¥½äººã€‚</li><li>å¦‚æœåºåˆ—ä¸­è‡³å°‘æœ‰ä¸€ä¸ªå¥½äººï¼Œåˆ™åºåˆ—çš„æœ«å°¾ä¸€å®šä¹Ÿæ˜¯å¥½äººã€‚</li></ol><h4 id="section-2">2</h4><p>ä¸èƒ½ï¼Œå¦‚æœæ‰€æœ‰åäººéƒ½æ°¸è¿œè¯´è°ï¼Œåˆ™ä»–ä»¬ä¸å¥½äººæ²¡æœ‰åŒºåˆ«ã€‚</p><h2 id="section-3">2</h2><h3 id="å·´å¡å°”å…¬å¼">å·´å¡å°”å…¬å¼</h3><p><span class="math display">\[    \sum_{n=1}^{\infty} \frac{1}{n^2} = \frac{\pi^2}{6}\]</span></p><h3 id="è¯æ˜">è¯æ˜</h3><p>é¦–å…ˆæ³¨æ„åˆ°ï¼š</p><p><span class="math display">\[\begin{aligned}    I=&amp;\int_0^1 \mathrm{d} x \int_0^1 \frac{1}{1-xy} \mathrm{d} y \\    =&amp;\iint_D \sum_{i=0}^{\infty} (xy)^i \mathrm{d}x\mathrm{d}y \\    =&amp;\sum_{i=0}^{\infty} \iint_D (xy)^i \mathrm{d}x\mathrm{d}y \\    =&amp;\sum_{i=0}^{\infty} \left(\int_0^1 x^i \mathrm{d} x\right)^2 \\    =&amp;\sum_{i=1}^{\infty} \frac{1}{i^2}\end{aligned}\]</span></p><p>æ•…åªéœ€è¯æ˜ <span class="math inline">\(I = \dfrac{\pi^2}{6}\)</span> å³å¯ï¼Œè€ƒè™‘å˜é‡æ›¿æ¢ï¼š</p><p><span class="math display">\[\begin{cases}    x = u + v \\    y = u - v\end{cases},\frac{\partial(x, y)}{\partial(u, v)} = \left|\begin{matrix} 1 &amp; 1 \\ 1 &amp; -1 \end{matrix} \right| = -2\]</span></p><p>åˆ™ï¼š</p><p><span class="math display">\[\begin{aligned}I &amp;= 2 \iint_{D_{uv}} \frac{1}{1 - u^2 + v^2} \mathrm{d} u \mathrm{d} v \\&amp;= 4 \left(\int_0^{\frac{1}{2}} \mathrm{d} u \int_0^{u} \frac{1}{1-u^2+v^2} \mathrm{d} v + \int_{\frac{1}{2}}^{1} \mathrm{d}u \int_0^{1-u} \frac{1}{1-u^2+v^2} \mathrm{d} v\right) \\&amp;= 4 \left(\int_0^{\frac{1}{2}} \frac{1}{\sqrt{1-u^2}} \arctan \frac{u}{\sqrt{1-u^2}} \mathrm{d} u + \int_{\frac{1}{2}}^{1} \frac{1}{\sqrt{1-u^2}} \arctan \frac{1-u}{\sqrt{1-u^2}} \mathrm{d} u\right) \\&amp;= 4 \left(\int_0^{\frac{1}{2}} \arctan \frac{u}{\sqrt{1-u^2}} \mathrm{d} \arctan \frac{u}{\sqrt{1-u^2}}   -2       \int_{\frac{1}{2}}^1 \arctan \frac{1-u}{\sqrt{1-u^2}} \mathrm{d} \arctan \frac{1-u}{\sqrt{1-u^2}} \right) \\&amp;= 4 \times \frac{1}{2} \times \left(\frac{\pi}{6}\right)^2 + 4 \times \left(\frac{\pi}{6}\right)^2 = \frac{\pi^2}{6} \\&amp;&amp; \square\end{aligned}\]</span></p><h3 id="åº”ç”¨">åº”ç”¨</h3><blockquote><p>ä»»å–ä¸¤ä¸ªæ­£æ•´æ•°ï¼Œæ±‚å®ƒä»¬äº’è´¨çš„æ¦‚ç‡</p></blockquote><p>è€ƒè™‘ä»»æ„è´¨å› å­ <span class="math inline">\(p\)</span>ï¼Œå¦‚æœä¸¤ä¸ªæ•°åŒæ—¶æ˜¯ <span class="math inline">\(p\)</span> çš„å€æ•°ï¼Œåˆ™ä¸ä¼šäº’è´¨ï¼Œè¿™ä¸ªæ¦‚ç‡æ˜¾ç„¶ä¸º <span class="math inline">\(\dfrac{1}{p^2}\)</span>ï¼Œå› æ­¤äº’è´¨çš„æ¦‚ç‡å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š</p><p><span class="math display">\[\begin{aligned}P &amp;= \prod_{p\, \mathrm{is\ prime}} \left(1 - \frac{1}{p^2}\right) \\&amp;= \prod_{p\, \mathrm{is\ prime}} \cfrac{1}{\sum_{i=0}^{\infty} \left(\cfrac{1}{p^2}\right)^i} \\&amp;= \frac{1}{\sum_{i=1}^{\infty} \frac{1}{i^2}} \\&amp;= \frac{6}{\pi^2}\end{aligned}\]</span></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å†™åœ¨å‰é¢&quot;&gt;å†™åœ¨å‰é¢&lt;/h2&gt;
&lt;p&gt;å®…å®¶æ²¡äº‹çš„æ—¶å€™æ‰¾çš„ä¹å­ï¼Œä¸å®šæœŸæ›´æ–°ï¼Œå¤§æ¦‚ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Combinatorial" scheme="http://yoursite.com/tags/Combinatorial/"/>
    
      <category term="Induction" scheme="http://yoursite.com/tags/Induction/"/>
    
  </entry>
  
  <entry>
    <title>äº’æµ‹é¢˜æ€»ç»“</title>
    <link href="http://yoursite.com/2018/problem-select/"/>
    <id>http://yoursite.com/2018/problem-select/</id>
    <published>2018-10-02T02:58:09.000Z</published>
    <updated>2020-07-14T12:02:42.206Z</updated>
    
    <content type="html"><![CDATA[<h3 id="string">String</h3><h4 id="description">Description</h4><blockquote><p>ç§°ä¸€ä¸ªä»…ç”±<code>a</code>, <code>b</code>, <code>c</code>ç»„æˆçš„å­—ç¬¦ä¸² <span class="math inline">\(S\)</span> æ˜¯å¹³è¡¡çš„å½“ä¸”ä»…å½“å¯¹äº <span class="math inline">\(S\)</span> çš„ä»»æ„ä¸€ä¸ªè¿ç»­å­ä¸² <span class="math inline">\(T\)</span>, ä»»æ„ä¸¤ç§å­—ç¬¦çš„å‡ºç°æ¬¡æ•°ä¹‹å·®éƒ½å°äºç­‰äº <span class="math inline">\(k\)</span>, æ±‚é•¿åº¦ä¸º <span class="math inline">\(n\)</span> çš„å¹³è¡¡ä¸²çš„æ•°é‡.</p></blockquote><p><span class="math inline">\(n \le 10^9, K \le 8\)</span></p><a id="more"></a><h4 id="solution">Solution</h4><p>å®šä¹‰ <span class="math inline">\(f_{a, b}(i)\)</span> è¡¨ç¤ºåœ¨å‰ <span class="math inline">\(i\)</span> ä¸ªå­—ç¬¦ä¸­ <code>a</code> å’Œ <code>b</code> å‡ºç°æ¬¡æ•°ä¹‹å·®, åœ¨åªè€ƒè™‘ <code>a</code>, <code>b</code> ä¸¤ç§å­—ç¬¦çš„æ¡ä»¶ç­‰ä»·äº:</p><p><span class="math display">\[\max_{i=1}^{n} f_{a, b}(i) - \min_{i=1}^{n} f_{a, b}(i) \le k\]</span></p><p>æ³¨æ„åˆ°å¦‚æœ <span class="math inline">\(f_{a, b}\)</span> çš„å€¼åŸŸåŒºé—´é•¿åº¦ä¸º <span class="math inline">\(len\)</span>, åˆ™è¢«æ‰€æœ‰é•¿åº¦ä¸º <span class="math inline">\(k\)</span> çš„å€¼åŸŸåŒºé—´è®¡ç®—çš„æ¬¡æ•°æ˜¯ <span class="math inline">\(k - len + 1\)</span>. è®° <span class="math inline">\(g(x, y, z)\)</span> è¡¨ç¤ºä¸‰ç§ <span class="math inline">\(f\)</span> çš„å€¼åŸŸåŒºé—´é•¿åº¦é™åˆ¶åˆ†åˆ«ä¸º <span class="math inline">\(x, y, z\)</span> æ—¶çš„æ–¹æ¡ˆæ•°, é‚£ä¹ˆå¯ä»¥å®¹æ–¥è®¡ç®—ç­”æ¡ˆ:</p><p><span class="math display">\[ans = g(k, k, k) - 3 g(k, k, k-1) + 3 g(k, k-1, k-1) - g(k-1, k-1, k-1)\]</span></p><p>è€ƒè™‘å¦‚ä½•è®¡ç®— <span class="math inline">\(g(x, y, z)\)</span>, ä»¥ <span class="math inline">\(x\)</span> ä¸ºä¾‹, æ¯ä¸€ä¸ªåˆæ³•çš„åŒºé—´ä¸€å®šå¯ä»¥è¡¨ç¤ºæˆ <span class="math inline">\(s_x + l_x \mid l_x \in [0, x]\)</span> çš„å½¢å¼.</p><p>å› ä¸ºåˆå§‹çŠ¶æ€çš„ <span class="math inline">\(l\)</span> ç¡®å®šäº† <span class="math inline">\(s\)</span> , æ¥ä¸‹æ¥çš„è½¬ç§»åªéœ€è¦ä¿è¯ <span class="math inline">\(l\)</span> çš„èŒƒå›´å³å¯, ç”±äº:</p><p><span class="math display">\[f_{a, b}(i) - f_{a, c}(i) = f_{c, b}(i)\]</span></p><p>è€ƒè™‘å¯¹äº <span class="math inline">\(z\)</span> çš„é™åˆ¶, æœ‰:</p><p><span class="math display">\[s_z + s_y - s_x \le l_x - l_y \le s_z + s_y - s_x + l_z\]</span></p><p>æ¯æ¬¡è½¬ç§»ä¹‹å‰æšä¸¾ä¸€ä¸‹ <span class="math inline">\(s_z + s_y - s_x\)</span> å³å¯, è¿™æ ·çŠ¶æ€åªéœ€è¦è€ƒè™‘ <span class="math inline">\(l_x, l_y\)</span> å³å¯, å¹¶ä¸”åˆå§‹çŠ¶æ€å”¯ä¸€ç¡®å®š <span class="math inline">\(s_x, s_y, s_z\)</span>.</p><h3 id="sequence">Sequence</h3><h4 id="description-1">Description</h4><blockquote><p>å¯¹é•¿åº¦ä¸º <span class="math inline">\(n\)</span> çš„åºåˆ— <span class="math inline">\(\{a_i\}\)</span>, å®šä¹‰ <span class="math inline">\(sum(l, r)\)</span> ä¸ºç¬¬ <span class="math inline">\(l\)</span> åˆ° <span class="math inline">\(r\)</span> é¡¹çš„å…ƒç´ ä¹‹å’Œ, <span class="math inline">\(inc(l, r)\)</span> ä¸ºç¬¬ <span class="math inline">\(l\)</span> åˆ° <span class="math inline">\(r\)</span> é¡¹çš„éç©ºä¸Šå‡å­åºåˆ—çš„æœ€å¤§æƒå€¼å’Œ, æ±‚ <span class="math inline">\(\max_{1 \le l,\, r \le n} sum(l, r) - inc(l, r)\)</span>, ä»¥åŠåŒæ—¶æ»¡è¶³åŒºé—´é•¿åº¦æœ€å°çš„ <span class="math inline">\((l, r)\)</span> çš„æ•°é‡.</p></blockquote><p><span class="math inline">\(n \le 2 \times 10^5, |a_i| \le 40\)</span></p><h4 id="solution-1">Solution</h4><p>ç”±äºæƒå€¼çš„èŒƒå›´æ¯”è¾ƒå°, <span class="math inline">\(inc\)</span> çš„èŒƒå›´ä¹Ÿä¸å¤§, åŒæ—¶ä¸€å®šå­˜åœ¨æ–¹æ¡ˆä½¿å¾— <span class="math inline">\(inc\)</span> ä¸­åªåŒ…å«æ­£æ•°.</p><p>è€ƒè™‘ä»å·¦åˆ°å³æšä¸¾å³ç«¯ç‚¹, ç”±äºæœ€å°åŒ–åŒºé—´é•¿åº¦çš„éœ€è¦, è®°å½• <span class="math inline">\(dp(i, j)\)</span> è¡¨ç¤ºå³è¾¹ç•Œä¸è¶…è¿‡å½“å‰æšä¸¾çš„ä½ç½®, æœ€é•¿ä¸Šå‡å­åºåˆ—çš„æƒå€¼å’Œä¸º <span class="math inline">\(i\)</span> ä¸”æœ€åä¸€ä½çš„æƒå€¼ä¸º <span class="math inline">\(j\)</span> æ—¶æœ€é å³çš„å·¦ç«¯ç‚¹çš„ä½ç½®. è½¬ç§»å¯ä»¥åšåˆ° <span class="math inline">\(O(n |a_i|^3)\)</span></p><p>æ¥ä¸‹æ¥è€ƒè™‘è®¡ç®—ç­”æ¡ˆ, ä»å¤§åˆ°å°æšä¸¾ <span class="math inline">\(inc\)</span> å¯èƒ½çš„å€¼, å¹¶æ±‚å…¶æœ€é å³çš„å·¦ç«¯ç‚¹å¦‚æœå·¦ç«¯ç‚¹æ˜¯å•è°ƒå¢çš„åˆ™è¯´æ˜é€‰æ‹©ä¸­é—´è¿™éƒ¨åˆ†çš„å·¦ç«¯ç‚¹ <span class="math inline">\(inc\)</span> ä¼šå‘ç”Ÿå˜åŒ–, æ‰¾ä¸€ä¸ªèƒ½æœ€ä¼˜åŒ– <span class="math inline">\(sum\)</span> çš„åŒæ—¶åŒºé—´é•¿åº¦æœ€å°çš„å·¦ç«¯ç‚¹å³å¯.</p><h3 id="game">Game</h3><h4 id="description-2">Description</h4><blockquote><p><span class="math inline">\(n\)</span> ä¸ªäººåœ¨ä¸€èµ·ç©æ¸¸æˆæ¯ä¸ªäººåˆå§‹æœ‰ä¸€å¼ ç‰Œ, ç‰Œä¸Šçš„æ•°å­—æ„æˆä¸€ä¸ª <span class="math inline">\(1-n\)</span> çš„æ’åˆ—, æ‰€æœ‰äººä»å·¦åˆ°å³è¿›è¡Œå†³ç­–: ç¿»å¼€è‡ªå·±çš„ç‰Œå¹¶ç•™åœ¨åŸåœ°, æˆ–è€…é€‰ä¸€ä¸ªä¹‹å‰çš„äººä¸å…¶äº¤æ¢æ‰‹ä¸­çš„ç‰Œå¹¶ç¦»å¼€æ¸¸æˆ, ä¹‹å‰çš„äººå°†ä»–çš„ç‰Œç¿»å¼€. æ¯ä¸ªäººéƒ½ä¼šé‡‡å–æœ€ä½³ç­–ç•¥, å¹¶å¸Œæœ›è‡ªå·±æ‰‹ä¸­çš„ç‰Œä¸Šçš„æ•°å­—å°½å¯èƒ½å¤§. å®šä¹‰ <span class="math inline">\(E(n)\)</span> ä¸º <span class="math inline">\(n\)</span> ä¸ªäººè¿›è¡Œæ¸¸æˆæœ€åç•™åœ¨åŸåœ°çš„äººçš„æ•°é‡çš„æœŸæœ›.</p></blockquote><p><span class="math display">\[\begin{aligned}S_k(n) = \begin{cases}    E(n)  &amp; \text{k = 0} \\    \sum_{i=1}^{n} S_{k-1}(i) &amp; \text{otherwise} \\\end{cases}\end{aligned}\]</span></p><p>æ±‚ <span class="math inline">\(S_k(n)\)</span>, ä¿ç•™ <span class="math inline">\(10\)</span> ä½æœ‰æ•ˆæ•°å­—.</p><p><span class="math inline">\(k \le 50, n \le 10^{15}\)</span></p><h4 id="solution-2">Solution</h4><p>é¦–å…ˆéœ€è¦åˆ†ææ¯ä¸ªäººçš„ç­–ç•¥, å·²çŸ¥çš„ä¿¡æ¯æœ‰ä¸¤éƒ¨åˆ†, ç•™åœ¨åŸåœ°çš„äººæ‰‹ä¸­çš„æ•°å­—é›†åˆ<span class="math inline">\(P\)</span>, æ²¡æœ‰è¿›è¡Œå†³ç­–çš„äººæ‰‹ä¸­çš„æ•°å­—é›†åˆ<span class="math inline">\(R\)</span>. è€ƒè™‘è¯æ˜æœ€ä¼˜ç­–ç•¥ä¸‹å‘ç”Ÿäº¤æ¢å½“ä¸”ä»…å½“ <span class="math inline">\(\min\{R\} &lt; \max\{P\}\)</span>.</p><p>ä¸å¦¨ä½¿ç”¨æ•°å­¦å½’çº³æ³•è¯æ˜, å¯¹äºæœ€åä¸€ä¸ªåšå†³ç­–çš„äºº, å†³ç­–æ­£ç¡®æ€§æ˜¾ç„¶, è€ƒè™‘å‰©ä¸‹çš„äºº:</p><ul><li><p>å½“ <span class="math inline">\(\min\{R\} &gt; \max\{P\}\)</span> æ—¶, æ˜¾ç„¶ç¿»å¼€æ‰‹ä¸­çš„ç‰Œæ— è®ºå¦‚ä½•éƒ½ä¸ä¼šå†åŠ£äº <span class="math inline">\(\max\{P\}\)</span>.</p></li><li><p>å½“ <span class="math inline">\(\min\{R\} &lt; \max\{P\}\)</span> æ—¶, è€ƒè™‘åè¯ç¿»å¼€å½“å‰çš„ç‰Œä¸ä¼šæ¯” <span class="math inline">\(\max\{P\}\)</span> æ›´ä¼˜:</p><ul><li>å¦‚æœç¿»å¼€çš„ç‰Œä¼˜äº <span class="math inline">\(\max\{P\}\)</span>, ç”±äºåœ¨è¿™ä¹‹å‰æœ‰ <span class="math inline">\(\min\{R\} &lt; \max\{P\}\)</span>, åœ¨æœ€å°å€¼è¢«ç¿»å‡ºä¹‹å‰æ¥ä¸‹æ¥çš„äººéƒ½ä¼šé€‰æ‹©ä¸æœ€å¤§çš„ä½ç½®äº¤æ¢, å¦‚æœæœ€å¤§å€¼æ‰€åœ¨çš„ä½ç½®æ²¡æœ‰å‘ç”Ÿå˜åŒ–è¿™ä¸ªä½ç½®æœ€åä¼šå˜æˆ <span class="math inline">\(\min\{R\}\)</span> ä¸”ä¸ä¼šæœ‰äººå†å’Œä»–äº¤æ¢æ‰‹ä¸­çš„ç‰Œ, å¦åˆ™è¿™ä¸ªä½ç½®éœ€è¦å…ˆå˜å¾—å°äºåŸæœ¬çš„ <span class="math inline">\(\max\{P\}\)</span>.</li><li>å¦‚æœç¿»å¼€çš„ç‰ŒåŠ£äº <span class="math inline">\(\max\{P\}\)</span> åˆ™ç±»ä¼¼ä¸Šè¿°æƒ…å†µä¸­å…ˆå˜å¾—å°äºåŸæœ¬ <span class="math inline">\(\max\{P\}\)</span> çš„æƒ…å†µ, æ¯ä¸€ä¸ªå®Œæ•´è¿‡ç¨‹ä¸­è¦ä¹ˆ <span class="math inline">\(\max\{P\}\)</span> å˜æˆ <span class="math inline">\(\min\{R\}\)</span>, è¦ä¹ˆ <span class="math inline">\(\max\{P\}\)</span> çš„ä½ç½®å‘ç”Ÿå˜åŒ–, æœ€ç»ˆä¸€å®šéƒ½ä¼šåŠ£äºæœ€åˆçš„ <span class="math inline">\(\max\{P\}\)</span>.</li></ul></li></ul><p>æ¥ä¸‹æ¥è€ƒè™‘ <span class="math inline">\(E(n)\)</span>, ç¬¬ <span class="math inline">\(i\)</span> ä¸ªäººé€‰æ‹©ç•™åœ¨åŸåœ°å½“ä¸”ä»…å½“ç¬¬ <span class="math inline">\(i-1\)</span> ä¸ªäººæ‰‹ä¸­çš„ç‰Œæ°å¥½æ˜¯åç¼€æœ€å°å€¼, äºæ˜¯:</p><p><span class="math display">\[E(n) = \sum_{i=1}^{n} \frac{1}{i}\]</span></p><p>è€ƒè™‘ç”Ÿæˆå‡½æ•°:</p><p><span class="math display">\[\begin{aligned}F(x) &amp;= \sum_{i=1}^{\infty} \frac{1}{i} x^i \\     &amp;= \int \frac{1}{1 - x} \\     &amp;= -\ln(1 - x) \\\end{aligned}\]</span></p><p><span class="math display">\[\begin{aligned}E(x) &amp;= \frac{F(x)}{1 - x} \\     &amp;= \frac{-\ln(1 - x)}{1 - x}\end{aligned}\]</span></p><p>æ¥ä¸‹æ¥è®¡ç®— <span class="math inline">\(S_k(n)\)</span>:</p><p><span class="math display">\[ \begin{aligned}S_k(x) &amp;= \frac{S_{k-1}(x)}{1 - x} \\       &amp;= \frac{-\ln(1 - x)}{(1 - x)^{k + 1}} \\S_k&#39;(x) &amp;= \frac{(-\ln(1-x))&#39;}{(1-x)^{k + 1}} - \ln(1 - x) \left( \frac{1}{(1 - x)^{k+1}} \right)&#39; \\        &amp;= \frac{1}{(1 - x)^{k + 2}} - \ln(1 - x) \left( -\frac{1}{(1 - x)^{2k + 2}} ((1-x)^{k+1})&#39; \right) \\        &amp;= \frac{1}{(1 - x)^{k + 2}} - \ln(1 - x) \frac{(k + 1) (1 - x)^k}{(1 - x)^{2k+2}} \\        &amp;= \frac{1}{(1 - x)^{k + 2}} + (k + 1) S_{k+1}(x)\end{aligned}\]</span></p><p>è€ƒè™‘ <span class="math inline">\(x^n\)</span> é¡¹çš„ç³»æ•°:</p><p><span class="math display">\[(n+1)S_k(n+1)x^n = {n + k + 2 \choose k + 1}x^n + (k + 1) S_{k + 1}(n) x^n\]</span></p><p><span class="math display">\[S_{k+1}(n) = \frac{(n+1)S_k(n+1) - {n + k + 2 \choose k + 1}}{k + 1}\]</span></p><p>å¯¹äº <span class="math inline">\(S_0(n)\)</span>, ä½¿ç”¨è°ƒå’Œçº§æ•°çš„è¿‘ä¼¼å…¬å¼è®¡ç®—, å¦åˆ™é€’å½’å³å¯.</p><h3 id="power">Power</h3><h4 id="description-3">Description</h4><blockquote><p><span class="math inline">\(n\)</span> ä¸ªè¿ç»­éšæœºå˜é‡, ç¬¬ <span class="math inline">\(i\)</span> ä¸ªå˜é‡ <span class="math inline">\(x_i\)</span> åœ¨ <span class="math inline">\([l_i, r_i]\)</span> ä¸­å‡åŒ€éšæœº, æ±‚ <span class="math inline">\(\max\{ (\sum{x_i})^m, a^m \}\)</span> çš„æœŸæœ›å€¼å¯¹ <span class="math inline">\(998244353\)</span> å–æ¨¡çš„ç»“æœ.</p></blockquote><p><span class="math inline">\(n \le 15, m \le 10^8, |a|, |l_i|, |r_i| \le 10^6\)</span></p><h4 id="solution-3">Solution</h4><p>è¿ç»­æ¦‚ç‡å®é™…ä¸Šæ˜¯åˆæ³•çš„ç‚¹é›†åœ¨ <span class="math inline">\(n\)</span> ç»´è¶…ç«‹æ–¹ä½“ä¸­çš„ä½“ç§¯å æ¯”, ç‚¹é›†å†…éƒ¨ç”¨ç§¯åˆ†è®¡ç®—æœŸæœ›å³å¯. å¯¹äº <span class="math inline">\([0, \infty)\)</span> èŒƒå›´å†…çš„ <span class="math inline">\(n\)</span> ä¸ªè¿ç»­éšæœºå˜é‡ <span class="math inline">\(\{x_i\}\)</span>, ä¸éš¾å½’çº³å¾—åˆ°æ»¡è¶³ <span class="math inline">\(\sum x_i \le x\)</span> çš„ç‚¹æ„æˆçš„ <span class="math inline">\(n\)</span> ç»´è¶…å‡ ä½•ä½“åœ¨ <span class="math inline">\(n\)</span> ç»´ç©ºé—´ä¸­çš„ä½“ç§¯æ˜¯ <span class="math inline">\(\frac{x^n}{n!}\)</span>.</p><p>è€ƒè™‘ <span class="math inline">\(\sum{x_i}\)</span> å’Œ <span class="math inline">\(a\)</span> çš„å¤§å°å…³ç³».</p><ul><li><span class="math inline">\(m\)</span> ä¸ºå¥‡æ•°æ—¶, éœ€è¦è€ƒè™‘ä¸¤ä¸ªåŒºé—´, <span class="math inline">\([-\infty, a], [a, \infty]\)</span>.</li><li><span class="math inline">\(m\)</span> ä¸ºå¶æ•°æ—¶, éœ€è¦è®¡ç®—ä¸‰ä¸ªåŒºé—´çš„ç­”æ¡ˆ, <span class="math inline">\([-\infty, -a], [-a, a], [a, \infty]\)</span>.</li></ul><p>é‚£ä¹ˆè¦è®¡ç®—åœ¨æ¯ä¸ªåŒºé—´å†…éƒ¨çš„æœŸæœ›å€¼, è€ƒè™‘å°†æ¯ä¸ª <span class="math inline">\(x_i\)</span> è¡¨ç¤ºä¸º <span class="math inline">\(l_i + y_i\)</span> æˆ– <span class="math inline">\(r_i + y_i\)</span>, <span class="math inline">\(2^n\)</span> æšä¸¾æ‰€æœ‰ä¸åˆæ³•çš„å˜é‡é›†åˆè¿›è¡Œå®¹æ–¥, å¯¹äº <span class="math inline">\(\sum y_i \le K\)</span> çš„é™åˆ¶å¯ä»¥è½¬åŒ–æˆè®¡ç®—:</p><p><span class="math display">\[\int_{0}^{K} \frac{x^{n-1}}{(n-1)!} g(x) \mathrm{d}x\]</span></p><p><span class="math inline">\(g(x)\)</span> è¡¨ç¤ºå½“ <span class="math inline">\(\sum y_i = x\)</span> æ—¶çš„ç­”æ¡ˆ, åŒä¸€ä¸ªåŒºé—´å†…çš„å½¢å¼æ˜¯ç›¸åŒçš„.</p><p>å¯¹äº <span class="math inline">\(\sum y_i \ge K\)</span> çš„é™åˆ¶å¯ä»¥åè¿‡æ¥å°†æ¯ä¸ª <span class="math inline">\(x_i\)</span> è¡¨ç¤ºä¸º <span class="math inline">\(r_i - y_i\)</span> æˆ–è€… <span class="math inline">\(l_i - y_i\)</span>, é™åˆ¶ <span class="math inline">\(-\sum y_i \ge K\)</span> å¯ä»¥è½¬åŒ–ä¸º <span class="math inline">\(\sum y_i \le K\)</span> çš„å½¢å¼.</p><h3 id="bizi">Bizi</h3><h4 id="description-4">Description</h4><blockquote><p>ç»™å‡ºä¸¤æ£µæœ‰æ ¹æ ‘, å¤§å°åˆ†åˆ«æ˜¯ <span class="math inline">\(n_1, n_2\)</span>, å¯ä»¥è¿›è¡Œä¸‰ç§æ“ä½œ: 1. ä¿®æ”¹: å°†ä¸€æ¡è¾¹çš„è¾¹æƒä» <span class="math inline">\(x\)</span> æ”¹ä¸º <span class="math inline">\(y\)</span> , ä»£ä»·ä¸º <span class="math inline">\(|x - y| \times c1\)</span>. 2. æ”¶ç¼©: é€‰æ‹©ä¸€ä¸ªç‚¹, å°†å®ƒçš„æ‰€æœ‰å­æ ‘è¿å‘ä»–çš„çˆ¶äº², ä»£ä»·ä¸ºè¿™ä¸ªç‚¹åˆ°çˆ¶äº²çš„è¾¹æƒ <span class="math inline">\(w \times c2\)</span>. 3. ç”Ÿé•¿: é€‰æ‹©ä»»æ„ä¸€ä¸ªç‚¹çš„ä¸€æ®µè¿ç»­çš„å­æ ‘, æ’å…¥ä¸€ä¸ªæ–°ç‚¹è¿å‘é€‰æ‹©çš„ç‚¹å¹¶æˆä¸ºè¿™äº›å­æ ‘çš„çˆ¶äº², ä»£ä»·ä¸ºè¿å‘åŸæ¥çš„ç‚¹çš„è¾¹æƒ <span class="math inline">\(w \times c2\)</span>.</p></blockquote><blockquote><p>æ±‚å‡ºä½¿å¾—ä¸¤é¢—æ ‘æ‹¬å·åºåˆ—å’Œè¾¹æƒç›¸åŒéœ€è¦çš„æœ€å°ä»£ä»·.</p></blockquote><p><span class="math inline">\(n1 \le 50,\, n2 \le 2000\)</span></p><h4 id="solution-4">Solution</h4><p>é¦–å…ˆä¸éš¾å‘ç°æ“ä½œä¸€å’Œæ“ä½œäºŒäº’ä¸ºé€†æ“ä½œ, æ‰€ä»¥å¯ä»¥åªè€ƒè™‘æ“ä½œäºŒ.</p><p>å®šä¹‰ <span class="math inline">\(dp(a, b, c, d)\)</span> è¡¨ç¤ºç¬¬ä¸€é¢—æ ‘ä¸­ <span class="math inline">\([a, b]\)</span> è¡¨ç¤ºçš„æ‹¬å·åºåˆ—åŒºé—´å’Œç¬¬äºŒæ£µæ ‘ä¸­ <span class="math inline">\([c, d]\)</span> è¡¨ç¤ºçš„æ‹¬å·åºåˆ—åŒºé—´å˜å¾—ç›¸åŒéœ€è¦çš„æœ€å°ä»£ä»·, è€ƒè™‘å·¦ç«¯ç‚¹å¯¹åº”çš„æ‹¬å·åœ¨æœ€ç»ˆæƒ…å†µä¸‹çš„åŒ¹é…æƒ…å†µè¿›è¡Œè½¬ç§»:</p><p><span class="math display">\[dp(a, b, c, d) = \min \begin{cases} dp(a + 1, b, c, d) + w_{a} \times c2 \\dp(a, b, c + 1, d) + w_{c} \times c2 \\dp(a + 1, p_{a} - 1, b + 1, p_{b} - 1) + dp(p_{a} + 1, b, p_{c} + 1, d) + |w_{a} - w_{b}| \times c1\end{cases}\]</span></p><p><span class="math inline">\(p_x\)</span> è¡¨ç¤ºç¬¬ <span class="math inline">\(x\)</span> ä¸ªæ‹¬å·çš„åŒ¹é…æ‹¬å·çš„ä½ç½®, <span class="math inline">\(w_x\)</span> è¡¨ç¤ºç¬¬ <span class="math inline">\(x\)</span> ä¸ªæ‹¬å·å’Œå…¶çˆ¶äº²ç»“ç‚¹ä¹‹é—´è¿è¾¹çš„è¾¹æƒ.</p><p>çœ‹èµ·æ¥çŠ¶æ€æ•°æ˜¯ <span class="math inline">\(O(n1^2n2^2)\)</span> çš„, å®é™…ä¸Šåˆ†æåå‘ç°æœ‰ç”¨çš„çŠ¶æ€æ•°åªæœ‰ <span class="math inline">\(O(n1^2n2\log{n2})\)</span>: å› ä¸ºè€ƒè™‘å·¦ç«¯ç‚¹è¿›è¡Œè½¬ç§»å’Œè€ƒè™‘å³ç«¯ç‚¹è¿›è¡Œè½¬ç§»æ˜¯ç­‰ä»·çš„, ä½†æ˜¯å¦‚æœæ¯æ¬¡éƒ½é€‰æ‹©ç¬¬äºŒæ£µæ ‘ä¸­å­æ ‘å¤§å°è¾ƒå°çš„ä¸€ä¾§è¿›è¡Œè½¬ç§», å…³äºç¬¬äºŒæ£µæ ‘çš„çŠ¶æ€æ•°å°±æ˜¯è½»å„¿å­çš„å­æ ‘å¤§å°ä¹‹å’Œ, è€Œè¿™ä¸ªå€¼æ˜¯ä¸ä¼šè¶…è¿‡ <span class="math inline">\(O(n2 \log{n2})\)</span> çš„.</p><h3 id="circle">Circle</h3><h4 id="description-5">Description</h4><blockquote><p>å¹³é¢ä¸Šæœ‰ <span class="math inline">\(n\)</span> ä¸ªç‚¹, æ±‚æœ‰å¤šå°‘ä¸ªæ— åºä¸‰å…ƒç»„ <span class="math inline">\((i, j, k)\)</span> æ»¡è¶³ç‚¹ <span class="math inline">\(i\)</span>, <span class="math inline">\(j\)</span>, <span class="math inline">\(k\)</span> ç¡®å®šçš„åœ†ç»è¿‡åæ ‡åŸç‚¹.</p></blockquote><p><span class="math inline">\(n \le 2000\)</span></p><h4 id="solution-5">Solution</h4><p>è¥¿å§†æ¾å®šç†:</p><blockquote><p>ä¸‰ä¸ªç‚¹ç¡®å®šçš„åœ†ä¸Šä»»é€‰ä¸€ç‚¹å‘è¿™ä¸‰ä¸ªç‚¹æ„æˆçš„ä¸‰è§’å½¢ä¸‰è¾¹æ‰€åœ¨ç›´çº¿åˆ†åˆ«ä½œå‚çº¿, å‚è¶³ä¸‰ç‚¹å…±çº¿.</p></blockquote><p>è¯æ˜å¯å‚è€ƒä¸‹å›¾:</p><p><img src="/img/simson.png"></p><p>äºæ˜¯é—®é¢˜è½¬åŒ–ä¸ºæ±‚ä¸‰ç‚¹å…±çº¿çš„æ•°é‡.</p><h3 id="triangle">Triangle</h3><h4 id="description-6">Description</h4><blockquote><p>æœ‰ä¸€æ£µ <span class="math inline">\(n\)</span> ä¸ªç‚¹çš„æ ‘, åˆå§‹æ—¶æ ‘ä¸Šæ²¡æœ‰çŸ³å­, å¯ä»¥è¿›è¡Œè‹¥å¹²æ¬¡å¦‚ä¸‹æ“ä½œ: 1. å¦‚æœç‚¹ <span class="math inline">\(u\)</span> çš„æ‰€æœ‰å­æ ‘ <span class="math inline">\(v\)</span> ä¸Šéƒ½æ°å¥½æœ‰ <span class="math inline">\(w_v\)</span> é¢—çŸ³å­, åˆ™å¯ä»¥ä»æ‰‹ä¸­æ‹¿å‡º <span class="math inline">\(w_u\)</span> é¢—çŸ³å­æ”¾åœ¨ç‚¹ <span class="math inline">\(u\)</span> ä¸Š. 2. å°†æŸä¸ªç»“ç‚¹ä¸Šçš„æ‰€æœ‰çŸ³å­æ”¶å›æ‰‹ä¸­.</p><p>ç°åœ¨è¯¢é—®ä½ å¯¹äºæ¯ä¸€ä¸ªç‚¹ <span class="math inline">\(i\)</span>, è¦ä½¿å¾— <span class="math inline">\(i\)</span> ä¸Šæ°å¥½æ”¾æœ‰ <span class="math inline">\(w_i\)</span> é¢—çŸ³å­, åˆå§‹æ—¶æ‰‹ä¸­è‡³å°‘éœ€è¦å¤šå°‘é¢—çŸ³å­.</p></blockquote><p><span class="math inline">\(n \le 10^5, w_i \le 10^9\)</span></p><h4 id="solution-6">Solution</h4><p>é¦–å…ˆå¯ä»¥å‘ç°æ“ä½œçš„è¿‡ç¨‹ç±»ä¼¼ä¸€ä¸ªæ‹“æ‰‘æ’åº, å¡«ä¸Šä¸€ä¸ªç»“ç‚¹çš„çŸ³å­ä¹‹å‰å…ˆè¦å°†å®ƒçš„æ‰€æœ‰å„¿å­éƒ½å¡«ä¸ŠçŸ³å­, æ¥ç€ä¼šç«‹å³æ”¶å›å„¿å­ç»“ç‚¹ä¸Šçš„çŸ³å­.</p><p>ä¸å¦¨åè¿‡æ¥è€ƒè™‘, å®šä¹‰ä¸€æ¬¡æ“ä½œä¸ºé€‰æ‹©ä¸€ä¸ªæ”¾æœ‰çŸ³å­çš„ç‚¹, å°†å®ƒçš„å„¿å­ç»“ç‚¹å…¨éƒ¨æ”¾ä¸ŠçŸ³å­, ç„¶åæ”¶å›è¿™ä¸ªç‚¹çš„çŸ³å­. ç”±äºåªéœ€è¦è€ƒè™‘æ“ä½œè¿‡ç¨‹ä¸­çŸ³å­æ•°é‡çš„æœ€å¤§å€¼, å¯ä»¥å‘ç°åè½¬é¡ºåºå¹¶ä¸ä¼šå½±å“ç­”æ¡ˆ.</p><p>ç”¨ä¸€ä¸ªäºŒå…ƒç»„ <span class="math inline">\((a, b)\)</span> æè¿°ä¸€æ¬¡æ“ä½œ, <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> åˆ†åˆ«è¡¨ç¤ºåœ¨æ“ä½œçš„è¿‡ç¨‹ä¸­çŸ³å­çš„æ€»å˜åŒ–é‡å’Œå˜åŒ–æœ€å¤§å€¼, æ³¨æ„åˆ°ä¸¤ä¸ªæ“ä½œå¯ä»¥æ–¹ä¾¿åœ°åˆå¹¶:</p><p><span class="math display">\[(a, b) + (c, d) = (a + c, \max\{b, a + d\})\]</span></p><p>æ¥ä¸‹æ¥è€ƒè™‘äºŒå…ƒç»„ <span class="math inline">\(X = (a, b)\)</span> å’Œ <span class="math inline">\(Y = (c, d)\)</span> ä¹‹é—´çš„ä¼˜å…ˆçº§, ä¸éš¾å¾—åˆ°ä»¥ä¸‹ä¼˜å…ˆçº§è§„åˆ™:</p><ol type="1"><li><span class="math inline">\(a \times c &lt; 0\)</span> æ—¶, æ€»å˜åŒ–é‡å°äº <span class="math inline">\(0\)</span> çš„äºŒå…ƒç»„ä¼˜å…ˆçº§æ›´é«˜.</li><li><span class="math inline">\(a &lt; 0 ,\,\, c &lt; 0\)</span> æ—¶, å˜åŒ–æœ€å¤§å€¼è¾ƒå°çš„äºŒå…ƒç»„ä¼˜å…ˆçº§æ›´é«˜.</li><li><span class="math inline">\(a &gt; 0 ,\,\, c &gt; 0\)</span> æ—¶, æ€»å˜åŒ–é‡å‡å»å˜åŒ–æœ€å¤§å€¼è¾ƒå°çš„äºŒå…ƒç»„ä¼˜å…ˆçº§æ›´é«˜.</li></ol><p>ä»¥ä¸Šè§„åˆ™ä¹Ÿå¯åˆ©ç”¨äº¤æ¢æ³•è¯æ˜æ­£ç¡®æ€§. åˆå› ä¸ºä»»æ„ä¸¤ä¸ªäºŒå…ƒç»„åˆå¹¶å¾—åˆ°çš„æ–°äºŒå…ƒç»„ä¸ä¼šæ¯”åŸæ¥çš„ä¸¤ä¸ªäºŒå…ƒç»„éƒ½æ›´ä¼˜, æ‰€ä»¥å…¨å±€æœ€ä¼˜çš„äºŒå…ƒç»„åœ¨å¯ä»¥é€‰æ‹©çš„æ—¶å€™ä¸€å®šä¼šé©¬ä¸Šé€‰æ‹©, äºæ˜¯å¾—åˆ°ä¸€ä¸ªè´ªå¿ƒç­–ç•¥, æ¯æ¬¡é€‰æ‹©æœ€ä¼˜çš„äºŒå…ƒç»„å¹¶å°†å…¶å’Œçˆ¶äº²å½“å‰å¯¹åº”çš„äºŒå…ƒç»„è¿›è¡Œåˆå¹¶, å¯ä»¥å‘ç°è¿™æ ·èƒ½å¤Ÿå¾—åˆ°æ•´æ£µæ ‘çš„æ“ä½œåºåˆ—.</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;string&quot;&gt;String&lt;/h3&gt;
&lt;h4 id=&quot;description&quot;&gt;Description&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ç§°ä¸€ä¸ªä»…ç”±&lt;code&gt;a&lt;/code&gt;, &lt;code&gt;b&lt;/code&gt;, &lt;code&gt;c&lt;/code&gt;ç»„æˆçš„å­—ç¬¦ä¸² &lt;span class=&quot;math inline&quot;&gt;\(S\)&lt;/span&gt; æ˜¯å¹³è¡¡çš„å½“ä¸”ä»…å½“å¯¹äº &lt;span class=&quot;math inline&quot;&gt;\(S\)&lt;/span&gt; çš„ä»»æ„ä¸€ä¸ªè¿ç»­å­ä¸² &lt;span class=&quot;math inline&quot;&gt;\(T\)&lt;/span&gt;, ä»»æ„ä¸¤ç§å­—ç¬¦çš„å‡ºç°æ¬¡æ•°ä¹‹å·®éƒ½å°äºç­‰äº &lt;span class=&quot;math inline&quot;&gt;\(k\)&lt;/span&gt;, æ±‚é•¿åº¦ä¸º &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; çš„å¹³è¡¡ä¸²çš„æ•°é‡.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(n \le 10^9, K \le 8\)&lt;/span&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Combinatorial" scheme="http://yoursite.com/tags/Combinatorial/"/>
    
      <category term="Summary" scheme="http://yoursite.com/tags/Summary/"/>
    
  </entry>
  
  <entry>
    <title>æ‹“å±•åŸƒæ°ç­›æ³•å°ç»“</title>
    <link href="http://yoursite.com/2018/ex-eratos-sieve/"/>
    <id>http://yoursite.com/2018/ex-eratos-sieve/</id>
    <published>2018-08-21T11:42:41.000Z</published>
    <updated>2018-11-29T19:43:50.000Z</updated>
    
    <content type="html"><![CDATA[<p>å­¦å®Œæ´²é˜ç­›ä¹‹åå¿˜å¾—å·®ä¸å¤šäº†, ä¸è¿‡ç°åœ¨å·²ç»å¯ä»¥å°†æ´²é˜ç­›æ‰”è¿›åƒåœ¾æ¡¶äº†...</p><a id="more"></a><h3 id="description">Description</h3><p>æ±‚:</p><p><span class="math display">\[h(n) = \sum_{i=1}^{n} f(i)\]</span></p><p>å…¶ä¸­ <span class="math inline">\(f\)</span> æ˜¯å®šä¹‰åœ¨æ­£æ•´æ•°é›†ä¸‹çš„ç§¯æ€§å‡½æ•°, æ»¡è¶³ <span class="math inline">\(f(p^c)\)</span> èƒ½å¤Ÿå¿«é€Ÿè®¡ç®—.</p><h3 id="conversion">Conversion</h3><p>é¦–å…ˆå¯ä»¥å°†æ‰€æœ‰è¦æ±‚çš„æ•°æŒ‰ç…§æ˜¯å¦åªå«å¤§äº <span class="math inline">\(\sqrt{n}\)</span> çš„è´¨å› å­åˆ†ä¸ºä¸¤ç±», å¯¹äºç¬¬ä¸€ç±»æ•°ä¸€å®šæ˜¯ä¸€ä¸ªè´¨æ•°, è€Œç¬¬äºŒç±»æ•°ä¸€å®šå¯ä»¥åœ¨æŸä¸ªè¾ƒå°çš„è´¨å› å­å¤„è€ƒè™‘åˆ°, äºæ˜¯æˆ‘ä»¬åªå…³æ³¨ä¸è¶…è¿‡ <span class="math inline">\(\sqrt{n}\)</span> çš„é‚£äº›è´¨å› å­.</p><p>å®šä¹‰ <span class="math inline">\(S_k(n, i)\)</span> è¡¨ç¤ºå°äºç­‰äº <span class="math inline">\(n\)</span> çš„æ•°ä¸­ä¸å‰ <span class="math inline">\(i\)</span> ä¸ªè´¨æ•°äº’è´¨çš„æ‰€æœ‰æ•°ä¸<strong>æ‰€æœ‰è´¨æ•°</strong>çš„ <span class="math inline">\(k\)</span> æ¬¡æ–¹å’Œ, å®¹æ˜“å¾—åˆ°è½¬ç§»:</p><p><span class="math display">\[S_k(n, i) = \begin{cases}S_k(n, i-1) &amp; n &lt; p_i^2 \\S_k(n, i-1) - p_i^k \times \left(S_k(\left \lfloor \frac{n}{p_i} \right \rfloor, i - 1) - S_k(p_{i-1}, i - 1)\right) &amp; \mathrm{otherwise} \end{cases}\]</span></p><p>åœ¨è€ƒè™‘å®Œ <span class="math inline">\(\sqrt{n}\)</span> ä»¥å†…çš„æ‰€æœ‰è´¨å› æ•°å, <span class="math inline">\(S_k(n)\)</span> ä¸­ç•™ä¸‹äº†æ‰€æœ‰è´¨æ•°çš„ <span class="math inline">\(k\)</span> æ¬¡æ–¹, è¿™æ ·æ‰€æœ‰ç¬¬ä¸€ç±»æ•°çš„å‡½æ•°å€¼éƒ½å¯ä»¥å¿«é€Ÿè®¡ç®—.</p><p>ç±»ä¼¼åœ°, å®šä¹‰ <span class="math inline">\(G(n, i)\)</span> è¡¨ç¤ºå°äºç­‰äº <span class="math inline">\(n\)</span> çš„æ•°ä¸­ä»…ç”±ç¬¬ <span class="math inline">\(i\)</span> ä¸ªä»¥åçš„è´¨æ•°æ„æˆçš„æ•°ä¸<strong>æ‰€æœ‰è´¨æ•°</strong> <span class="math inline">\(x\)</span> çš„ <span class="math inline">\(f(x)\)</span> ä¹‹å’Œ, è½¬ç§»çš„æ–¹å¼ç±»ä¼¼:</p><p><span class="math display">\[G(n, i) = G(n, i+1) + \sum_{c=0}^{\substack{p_i^{c+1} \le n}} f(p_i^{c+1}) + f(p_i^c) \times \left(G(\left \lfloor \frac{n}{p_i^c} \right \rfloor, i+1) - G(p_i, i+1)\right)\]</span></p><p>å¤æ‚åº¦çº¦ä¸º <span class="math inline">\(O\left(\frac{n^{\frac{3}{4}}}{\log{n}}\right)\)</span></p><h3 id="code">Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> SIV &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">100000</span>;</span><br><span class="line"></span><br><span class="line">    ll n;</span><br><span class="line">    <span class="keyword">int</span> m;</span><br><span class="line">    uint val[M + <span class="number">5</span>];</span><br><span class="line">    <span class="keyword">int</span> prime[M + <span class="number">5</span>], pcnt;</span><br><span class="line">    uint s[M + <span class="number">5</span>], S[M + <span class="number">5</span>];</span><br><span class="line">    uint f[M + <span class="number">5</span>], F[M + <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> uint <span class="title">gets</span><span class="params">(ll x)</span> </span>&#123; <span class="keyword">return</span> x &lt;= m ? s[x] : S[n / x]; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> uint <span class="title">getf</span><span class="params">(ll x)</span> </span>&#123; <span class="keyword">return</span> x &lt;= m ? f[x] : F[n / x]; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">my_sqrt</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> r = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1l</span>l * (r + <span class="number">1</span>) * (r + <span class="number">1</span>) &lt;= x) ++ r;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(ll _n)</span> </span>&#123;</span><br><span class="line">        m = my_sqrt(n = _n);</span><br><span class="line">       </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">            val[i] = <span class="number">81</span> * i * i - <span class="number">27</span> * i + <span class="number">9</span>;</span><br><span class="line">            s[i] = i - <span class="number">1</span>;</span><br><span class="line">            S[i] = (n / i) - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> p = <span class="number">2</span>; p &lt;= m; ++p) &#123;</span><br><span class="line">            <span class="keyword">if</span>(s[p] == s[p<span class="number">-1</span>]) <span class="keyword">continue</span>;</span><br><span class="line">            prime[pcnt ++] = p;</span><br><span class="line">             </span><br><span class="line">            <span class="keyword">const</span> uint _s = s[p - <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">const</span> ll q = <span class="number">1l</span>l * p * p, lim = min((ll) m, n / q), x = m / p, y = n / p;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= x; ++i) S[i] -= S[i * p] - _s;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = x + <span class="number">1</span>; i &lt;= lim; ++i) S[i] -= s[y / i] - _s;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = m; i &gt;= q; --i) s[i] -= s[i / p] - _s;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">            f[i] = s[i] * <span class="number">63</span>;</span><br><span class="line">            F[i] = S[i] * <span class="number">63</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> e = pcnt; e &gt;= <span class="number">1</span>; --e) &#123;</span><br><span class="line">            <span class="keyword">int</span> p = prime[e<span class="number">-1</span>];</span><br><span class="line">            <span class="keyword">const</span> ll q = <span class="number">1l</span>l * p * p, lim = min((ll) m, n / q);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= lim; ++i) &#123;</span><br><span class="line">                ll cur = n / i;</span><br><span class="line">                <span class="keyword">for</span>(ll t = p, c = <span class="number">1</span>; t * p &lt;= cur; t *= p, ++ c) &#123;</span><br><span class="line">                    F[i] += (getf(cur / t) - e * <span class="number">63</span>) * val[c] + val[c + <span class="number">1</span>];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = m; i &gt;= q; --i) &#123;</span><br><span class="line">                <span class="keyword">int</span> cur = i;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> t = p, c = <span class="number">1</span>; t &lt;= cur / p; t *= p, ++ c) &#123;</span><br><span class="line">                    f[i] += (getf(cur / t) - e * <span class="number">63</span>) * val[c] + val[c + <span class="number">1</span>];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å­¦å®Œæ´²é˜ç­›ä¹‹åå¿˜å¾—å·®ä¸å¤šäº†, ä¸è¿‡ç°åœ¨å·²ç»å¯ä»¥å°†æ´²é˜ç­›æ‰”è¿›åƒåœ¾æ¡¶äº†...&lt;/p&gt;
    
    </summary>
    
    
      <category term="Number Theory" scheme="http://yoursite.com/tags/Number-Theory/"/>
    
  </entry>
  
  <entry>
    <title>è®°NOI2018</title>
    <link href="http://yoursite.com/2018/noi2018/"/>
    <id>http://yoursite.com/2018/noi2018/</id>
    <published>2018-07-30T00:38:56.000Z</published>
    <updated>2018-11-29T19:43:50.000Z</updated>
    
    <content type="html"><![CDATA[<p>æŠ˜è…¾äº†å¥½ä¹…ç»ˆäºæŠŠåšå®¢ä¿®å¥½äº†, æ¥å¡«ä¸€äº›å‘.</p><a id="more"></a><h3 id="day--1">Day -1</h3><p>ä¸Šåˆåœ¨å®¶æ— æ‰€äº‹äº‹, æ”¶äº†ä¸‹è¡Œæ, ä¸‹åˆå°±åˆ°æ´‹æ¹–æŠ¥åˆ°å»äº†, ç„¶åå¬è¯´ç¬”è¯•æ—¶é—´è°ƒæ•´åˆ°äº†ä¸Šåˆ, æ„Ÿè§‰æœ‰ç‚¹æ…Œæ•´ä¸ªæ™šä¸Šéƒ½åœ¨èƒŒç¬”è¯•.</p><h3 id="day-0">Day 0</h3><p>ä¸Šåˆè€ƒç¬”è¯•, æ¯”é¢„æ–™ä¸­çš„ç®€å•å¾ˆå¤š, æ²¡æœ‰ä»€ä¹ˆå¿«æ·é”®ä¹‹ç±»çš„å‘é¢˜ä¹Ÿæ²¡æœ‰æŒ‚åˆ†, è¯•æœºå°±æ‰“äº†ä¸€ä¸ªæœ€ç®€å•çš„é…ç½®å°±è·‘äº†.</p><p>ä¸‹åˆæ‰¾äº†ä¸€é—´æ•™å®¤è‡ªä¹ , ä¸çŸ¥é“å¹²ä»€ä¹ˆ, æ™šä¸Šæ‡’å¾—å¤ä¹ ä»€ä¹ˆæ—©æ—©åœ°ç¡äº†, å¥‡æ€ªçš„æ˜¯å±…ç„¶ä¸æ¯«ä¸ç´§å¼ .</p><h3 id="day-1">Day 1</h3><p>ç¬¬ä¸€è¯•, çœ‹äº†çœ‹é¢˜, è§‰å¾—é¢˜æ„éƒ½æŒºå¥½ç†è§£çš„, éš¾åº¦ä¹ŸåŸºæœ¬æŒ‰ç…§é¢˜ç›®é¡ºåº.</p><p>å°±ç›´æ¥å¼€å§‹å†™T1äº†, å†™å®Œ <span class="math inline">\(\log^2\)</span> è¿‡äº†å¤§æ ·ä¾‹ç›´æ¥ä¸¢åˆ°ä¸€è¾¹äº†, ç„¶åçœ‹T2, æ¨äº†ä¸€ä¸ªçœ‹èµ·æ¥æœ‰ç†æœ‰æ®çš„ç»“è®º, ä½†ä¸æ˜¯å¾ˆä¼šç®—ç­”æ¡ˆæäº†å¾ˆä¹…å¤§æ ·ä¾‹å››ä¸ªå…¨é”™, æƒ³äº†ä¸€ä¸‹éšä¾¿æ‰“äº†ä¸ªç‰¹åˆ¤è¿‡äº†å…¶ä¸­ä¸¤ä¸ª, åˆæ”¹äº†ä¸€ä¸‹ç‰¹åˆ¤æ‰åœ¨è€ƒè¯•ä¸€åŠæ—¶é—´çš„æ—¶å€™è¿‡äº†å¤§æ ·ä¾‹.</p><p>æœŸé—´å»ä¸Šäº†ä¸€ä¸ªå•æ‰€, ç”¨æ‰20min...</p><p>çœ‹T3æƒŠå–œåœ°å‘ç°68åˆ†ç‰¹åˆ«å‚»é€¼, é£å¿«åœ°ç å®Œè¿‡äº†å¤§æ ·ä¾‹è¿˜æœ‰ä¸€ä¸ªåŠå°æ—¶, æ­£å‡†å¤‡å›å»ç»§ç»­åšT2æœ€å20åˆ†çš„æ—¶å€™å‘ç°T1å¯èƒ½è·‘ä¸è¿‡, å¡äº†å¾ˆä¹…çš„å¸¸, æœŸé—´ç«Ÿç„¶æ£€æŸ¥å‡ºå¥½å¤šè‡´å‘½çš„é”™è¯¯, ç„¶åå¿ƒé‡Œç‰¹åˆ«è™šåœ°ä¸åœæ£€æŸ¥, T2ä¹Ÿæ²¡æœ‰ç»§ç»­æƒ³äº†.</p><p>å¥½åœ¨æœ€åå¹¶æ²¡æœ‰æŒ‚åˆ†.</p><h3 id="day-1.5">Day 1.5</h3><p>é¸½äº†ç¤¾ä¼šæ´»åŠ¨, åœ¨è‡ªä¹ å®¤æäº†ä¸€å¤©é¢“.</p><p>ç›´æ¥æ‰“å‡ºäº†é˜²æ²‰è¿·è­¦å‘Š...</p><h3 id="day-2">Day 2</h3><p>çœ‹å®Œé¢˜ç›®ä¸€ç›´åœ¨æƒ³å“ªé“é¢˜æœ€ç®€å•, ç„¶åT1è¡¥å……äº†ä¸€ä¸ªæ¡ä»¶...</p><p>ç”¨äº†ä¸¤ä¸ªå°æ—¶éƒ½æ²¡æœ‰ä»T1çš„å€’æ•°ç¬¬äºŒæ­¥æ¨å‡ºæœ€åä¸€æ­¥, æƒ³æƒ³å½“æ—¶å¯èƒ½çœŸçš„å—åˆ°äº†é™æ™ºæ‰“å‡», è¿˜è‡ªä¿¡åœ°è§‰å¾—T2æ¯”è¾ƒå¯åš, ç äº†å¾ˆä¹…å‘ç°æ˜¯å‡ç®—æ³•, æ„Ÿè§‰å¾ˆæ…Œæ»šå»å†™T3æš´åŠ›, å›æ¥æƒ³å…ˆå†™T2çš„45åˆ†åˆä¸æƒ³æ”¾å¼ƒT1, æœ€åè¿T2çš„45åˆ†éƒ½æ²¡æ‹¿åˆ°...</p><p>æ„Ÿè§‰å¿ƒæ€çœŸçš„å´©çš„å‰å®³, è™½ç„¶æœ€åæŸ¥åˆ†å‘ç°æ„å¤–çš„å¤šäº†5åˆ†(å¤§é›¾).</p><h3 id="æ€»ç»“">æ€»ç»“</h3><p>å¥½åƒä»å»å¹´NOIPä»¥æ¥, èº«ä¸Šä¸€ç›´æœ‰æŸç§äºŒè¯•Debuffå­˜åœ¨, å¯èƒ½ç»å¸¸æ€§çš„å› ä¸ºç¬¬ä¸€è¯•è€ƒå¾—ä¸é”™, è€Œå¯¹å¤šæ•°æƒ…å†µä¸‹æ›´éš¾çš„äºŒè¯•å¿ƒå­˜è½»è§†, ä¹Ÿæ²¡èƒ½è°ƒæ•´å¥½è‡ªå·±çš„å¿ƒæ€å§.</p><p>ä¸ç®¡æ€æ ·, æ¥ä¸‹æ¥çš„OIç”Ÿæ¶¯, è¦æ›´åŠ çæƒœ!</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æŠ˜è…¾äº†å¥½ä¹…ç»ˆäºæŠŠåšå®¢ä¿®å¥½äº†, æ¥å¡«ä¸€äº›å‘.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Summary" scheme="http://yoursite.com/tags/Summary/"/>
    
  </entry>
  
  <entry>
    <title>å¹³é¢æ ‘è®¡æ•°</title>
    <link href="http://yoursite.com/2017/count-plane-tree/"/>
    <id>http://yoursite.com/2017/count-plane-tree/</id>
    <published>2017-12-01T03:03:04.000Z</published>
    <updated>2020-07-14T12:05:04.113Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸å¸¸è§çš„ç»å…¸é—®é¢˜, é¡ºä¾¿æ€»ç»“ä¸€ä¸‹Burnsideå¼•ç†å§.</p><a id="more"></a><h3 id="é—®é¢˜æè¿°">é—®é¢˜æè¿°</h3><blockquote><p>ç»™å®š <span class="math inline">\(N\)</span>, æ±‚ <span class="math inline">\(N\)</span> ä¸ªç‚¹çš„æœ¬è´¨ä¸åŒçš„å¹³é¢æ ‘çš„æ•°é‡. ä¸¤æ£µå¹³é¢æ ‘æ˜¯ç­‰ä»·çš„å½“ä¸”ä»…å½“å…¶ä¸­ä¸€æ£µèƒ½å¤Ÿç§»åŠ¨ç‚¹çš„ä½ç½®ä¸å¦ä¸€æ£µé‡åˆ, ä¸”è¿‡ç¨‹ä¸­ä»ç„¶æ˜¯ä¸€æ£µå¹³é¢æ ‘.</p></blockquote><h3 id="åšæ³•">åšæ³•</h3><p>è€ƒè™‘æ¨¡å‹è½¬åŒ–(è®¡ç®— <span class="math inline">\(N+1\)</span> ä¸ªç‚¹çš„ç­”æ¡ˆ): å–å•ä½åœ†, ç­‰è·åœ°å– <span class="math inline">\(2N\)</span> ä¸ªç‚¹, ç„¶åå°†è¿™äº›ç‚¹ä¸¤ä¸¤é…å¯¹è¿è¾¹, æ»¡è¶³æ‰€æœ‰è¿è¾¹ä¸ç›¸äº¤. å‘ç°å®ƒçš„å¯¹å¶å›¾æ°å¥½æ˜¯ä¸€æ£µå¹³é¢æ ‘, åƒè¿™æ ·:</p><p><img src="/img/plane-tree.png"></p><p>é‚£ä¹ˆå°±åªéœ€è¦è€ƒè™‘æœ¬è´¨ä¸åŒçš„è¿™æ ·çš„é…å¯¹çš„æ•°é‡å³å¯. ä¸¤ä¸ªåœ†æ˜¯ç­‰ä»·çš„å½“ä¸”ä»…å½“ä¸€ä¸ªåœ†å¯ä»¥é€šè¿‡æ—‹è½¬ä¸€å®šçš„è§’åº¦ä¸å¦ä¸€ä¸ªåœ†é‡åˆ. è€Œåœ¨è¿™ä¸ªåœ†ä¸Šå…±æœ‰ <span class="math inline">\(2N\)</span> ä¸ªç‚¹, å°±æ„å‘³ç€æœ‰ <span class="math inline">\(2N\)</span> ä¸ªç½®æ¢, æ„æˆä¸€ä¸ªç½®æ¢ç¾¤.</p><p>ç½®æ¢ç¾¤ä¸‹çš„è®¡æ•°å¯ä»¥ç”¨åˆ° Burnsideå¼•ç† :</p><blockquote><p><span class="math display">\[ N(G, C) = \frac{1}{|G|} { \sum_{f \in G} c(f) } \]</span></p></blockquote><p>åˆ™è½¬åŒ–ä¸ºæ±‚ç½®æ¢ä¸‹çš„ä¸åŠ¨ç‚¹çš„æ•°é‡:</p><ul><li><p>ä¸å­˜åœ¨ç½®æ¢çš„æƒ…å†µä¸‹, ç­”æ¡ˆä¸º <span class="math inline">\(C_N\)</span>, <span class="math inline">\(\mathrm{Catalan}\)</span> æ•°çš„ç¬¬ <span class="math inline">\(N\)</span> é¡¹. å³å°†ç›¸äº’åŒ¹é…çš„ä½ç½®çœ‹ä½œå·¦å³æ‹¬å·, åˆ™æ‰€æœ‰åˆæ³•çš„æ‹¬å·åºåˆ—éƒ½å¯¹åº”ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„åœ†.</p></li><li><p><span class="math inline">\(N\)</span> ä¸ºå¥‡æ•°æ—¶, å¯èƒ½å­˜åœ¨ä¸€æ¡å¹³åˆ†åœ†çš„å¯¹è§’çº¿åœ¨ç½®æ¢ä¸‹ä¸å˜, è®¡ç®— <span class="math inline">\(\frac{N+1}{2}\)</span> ä¸ªç‚¹çš„ç­”æ¡ˆå³å¯.</p></li><li><p>è€ƒè™‘æ—‹è½¬ç½®æ¢:</p><p>ä¸ºäº†æ»¡è¶³æ—‹è½¬ä¹‹åçš„è¾¹é‡åˆ, ç‚¹ <span class="math inline">\(i\)</span> å’Œå®ƒçš„åŒ¹é…ç‚¹ <span class="math inline">\(p_i\)</span> åœ¨æ—‹è½¬ååº”è¯¥ä»ç„¶æ˜¯ç›¸åŒ¹é…çš„. åˆ™ç¯çš„æ•°é‡ä¸€å®šæ˜¯å¶æ•° <span class="math inline">\(2d\)</span>, æ‰€ä»¥ç¯çš„é•¿åº¦å¯ä»¥è¡¨ç¤ºä¸º <span class="math inline">\(\frac{2N}{2d} = \frac{N}{d}\)</span>.</p><p>å‡å®šç½®æ¢çš„é˜¶æ˜¯ <span class="math inline">\(e\)</span>, <span class="math inline">\(e &gt; 1, e | N\)</span>, ç¯çš„æ•°é‡ <span class="math inline">\(2d = \frac{2N}{e}\)</span>. ç¯ä¸Šä¸ <span class="math inline">\(0\)</span> åŒ¹é…çš„ç‚¹ä¸º <span class="math inline">\(i\)</span>, ä¸éš¾å‘ç°åœ¨è¿™äº›ç‚¹ä¹‹é—´çš„ç‚¹çš„æ–¹æ¡ˆæ•°ä¸º <span class="math inline">\(C_{i-1}\)</span>. å½“è¿™äº›ç‚¹ç¡®å®šä¹‹å, å®ƒä»¬åœ¨ç¯ä¸Šä¾æ¬¡ç»è¿‡çš„ <span class="math inline">\(e(i+1)\)</span> ä¸ªç‚¹å°±ç¡®å®šäº†.</p></li></ul><p>ä»¤ <span class="math inline">\(f(x)\)</span> è¡¨ç¤º <span class="math inline">\(\mathrm{Catalan}\)</span> æ•°çš„ç”Ÿæˆå‡½æ•°, æ ¹æ® <span class="math inline">\(\mathrm{Catalan}\)</span> æ•°çš„é€’æ¨å¼, ä¸éš¾å¾—åˆ°:</p><p><span class="math display">\[ f(x) = xf^2(x) + 1 \]</span></p><p>æ„é€  <span class="math inline">\(B_d\)</span> è¡¨ç¤ºåŒ…å« <span class="math inline">\(2d\)</span> ä¸ªç¯çš„ç½®æ¢ä¸‹ä¸åŠ¨ç‚¹çš„æ•°é‡.</p><p><span class="math display">\[ B_d = 2\sum_{i = 0}^{d-1} C_i B_{d-i-1} \]</span></p><p>å…¶ä¸­å› å­ <span class="math inline">\(2\)</span> è€ƒè™‘çš„æ˜¯ <span class="math inline">\(i &gt; 2d\)</span> æ—¶ç”¨å½“å‰ç½®æ¢çš„é€†æ¥è®¡ç®—çš„æƒ…å†µ.</p><p>åˆ™ <span class="math inline">\(B_d\)</span> çš„ç”Ÿæˆå‡½æ•° <span class="math inline">\(g(x)\)</span> æ»¡è¶³:</p><p><span class="math display">\[ g(x) = 2x g(x) f(x) + 1 \]</span></p><p>è§£å¾—:</p><p><span class="math display">\[ g(x) = (1 - 4x) ^ {-\frac{1}{2}} \]</span></p><h3 id="é—®é¢˜è§£å†³">é—®é¢˜è§£å†³</h3><p><span class="math display">\[ p(n) = \frac{1}{2n} \left( [\mathrm{n \, is \, odd}]\binom{n}{\lfloor\frac{n}{2}\rfloor} - \binom{2n}{n-1} + \sum_{d|n}{\varphi(n/d)\binom {2d}{d}} \right)\]</span></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸å¸¸è§çš„ç»å…¸é—®é¢˜, é¡ºä¾¿æ€»ç»“ä¸€ä¸‹Burnsideå¼•ç†å§.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Combinatorial" scheme="http://yoursite.com/tags/Combinatorial/"/>
    
      <category term="Burnside" scheme="http://yoursite.com/tags/Burnside/"/>
    
      <category term="Generating Function" scheme="http://yoursite.com/tags/Generating-Function/"/>
    
  </entry>
  
  <entry>
    <title>å†™åœ¨NOIP2017ä¹‹å</title>
    <link href="http://yoursite.com/2017/after-noip-2017/"/>
    <id>http://yoursite.com/2017/after-noip-2017/</id>
    <published>2017-11-13T00:24:59.000Z</published>
    <updated>2020-08-17T13:12:31.964Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¼•">å¼•</h3><blockquote><p>æœ¬æ¥åº”è¯¥æœ‰å¦ä¸€ç¯‡åšå®¢å«åšå†™åœ¨NOIP2017ä¹‹å‰çš„, ä½†è·‘å›å®¶æ‰æ„è¯†åˆ°åšå®¢æ­åœ¨æœºæˆ¿çš„ç”µè„‘ä¸Š, äºæ˜¯......</p></blockquote><a id="more"></a><h3 id="æ¯”èµ›è¿‡ç¨‹">æ¯”èµ›è¿‡ç¨‹</h3><h4 id="day1">Day1</h4><p>çœ‹åˆ°è¿™ä¸ªT1ä¸é€åˆ†äº†, å¿ƒé‡Œè¿˜æ˜¯æœ‰ç‚¹è™š, è®¤çœŸåœ°è¯»å®Œäº†åé¢ä¸¤é¢˜å¹³å¤äº†ä¸€ä¸‹å¿ƒæ€. æƒ³ç€æ—¢ç„¶æ˜¯T1, è‚¯å®šä¸æ˜¯é€å°±æ˜¯å·, çœ‹ç€æ ·ä¾‹æ‰¾äº†æ‰¾è§„å¾‹, æ¨äº†ä¸ª <span class="math inline">\(a + b + (b \% a) (a &lt; b)\)</span> çš„æ–¹æ³•, å‘ç°è¿‡ä¸äº†å¤§æ ·ä¾‹. äºæ˜¯ç›¯ç€å¤§æ ·ä¾‹å‘å‘†, çªç„¶å‘ç°äº†ä¸–ç•Œçš„å¥¥ç§˜. ç„¶åå†™T2, å†™å®Œçœ¼æŸ¥äº†ä¸€ä¸‹å¤§æ ·ä¾‹, æ­£è¦å…³é—­çª—å£çš„æ—¶å€™ Vimdiff äº†ä¸€æ³¢, å‘ç°è‡ªå·±å¤§å°å†™å†™é”™ä¸€å¤§å †... T3æƒ³äº†æƒ³å†™äº†ä¸ªä¸è€ƒè™‘é›¶è¾¹çš„è®°å¿†åŒ–æœç´¢, å‘ç°å¤§æ ·ä¾‹è¿‡ä¸äº† è®¤çœŸæ€è€ƒäº†ä¸€ä¸‹å‘ç°æ˜¯æ²¡æœ‰è€ƒè™‘åˆ°è¾¾ç»ˆç‚¹åˆæŠ˜è¿”çš„æƒ…å†µ åˆæƒ³äº†æƒ³å‘ç° <span class="math inline">\(-1\)</span> æŒºå¥½åˆ¤çš„, å°±åŠ ä¸Šäº†.</p><h4 id="day2">Day2</h4><p>åˆ°è¾¾è€ƒåœºæ—¶ç²¾ç¥çŠ¶æ€ä¸å¤ªå¥½, æ„è¯†æ¨¡ç³Šåœ°æ‰“å¼€äº†é¢˜ç›®. çœ‹å®ŒT2ä¸€ç›´åœ¨æƒ³MSTä»€ä¹ˆçš„, æ„Ÿè§‰ä¸å¤ªä¼šåšå‡†å¤‡æ”¾å¼ƒæ—¶å‘ç°æ•°æ®èŒƒå›´åªæœ‰12, äºæ˜¯ç§’æ‡‚äº†. T3æ²¡æƒ³å¤šä¹…æ¨å‡ºä¸€ä¸ªå¹³è¡¡æ ‘çš„åšæ³•, å¯¹è‡ªå·±ä»£ç èƒ½åŠ›è¿‡äºè‡ªä¿¡æ²¡æœ‰å¤šæƒ³å°±å¼€å§‹å†™, ç»“æœè°ƒåˆ°æœ€åä¸€åˆ»è¿˜æ˜¯GGäº†.</p><h3 id="åæ€é”™è¯¯">åæ€é”™è¯¯</h3><p>æ„Ÿè§‰è¿™æ¬¡è™½ç„¶é¢˜ç›®æ¯”è¾ƒå¥‡æ€ª, ä½†å®é™…éš¾åº¦è¿˜æ˜¯åˆç†çš„, å‡ºç°äº†ä¸€äº›å¤±è¯¯æ°æ°æš´éœ²å‡ºèº«ä¸Šçš„ä¸€äº›é—®é¢˜.</p><ul><li>è€ƒè¯•çš„æ—¶å€™å¤§éƒ¨åˆ†å¤„åœ¨ä¸€ç§è¾¹æƒ³è¾¹å†™çš„çŠ¶æ€, ä¸€è¾¹å†™å¯èƒ½è¿˜è¦ä¸€è¾¹å®Œå–„ä¸€äº›ç»†èŠ‚.</li><li>åˆ·äº†å¾ˆå¤šAtcoder çš„é¢˜ç›®ä¹‹å, ä»£ç èƒ½åŠ›é€€åŒ–æ˜æ˜¾.</li><li>è€ƒåœºçš„debuffæ¯”è¾ƒå¼º.</li></ul><p>å¯èƒ½åé¢ä¸¤æ¡è¿˜ç¨å¾®å¯ä»¥æ¥å—å§, ä½†æ˜¯ç¬¬ä¸€æ¡çš„ç¡®æ˜¯ç¡¬ä¼¤, è¿™æ ·åšç®€å•é¢˜æˆ–è€…åœ¨æ¯”è¾ƒæ¸…é†’çš„æ—¶å€™å†™é¢˜å¯èƒ½è¿˜å¥½, ç„¶è€Œä¸€æ—¦é‡åˆ°ä»£ç å®ç°æ¯”è¾ƒå¤æ‚æˆ–è€…æ¡ä»¶æ¯”è¾ƒå¤šçš„é¢˜ç›®, å°±ä¼šæŒ‚å¾—å¾ˆæƒ¨, è¿™ä¸ªé—®é¢˜æ¨¡æ‹Ÿèµ›ä¸­ä¹Ÿå‡ºç°è¿‡å‡ æ¬¡. è§£å†³çš„ç­–ç•¥å…¶å®è¯´èµ·æ¥ä¹Ÿä¸éš¾, ä¸»è¦å°±æ˜¯æ¯é“é¢˜å†™ä¹‹å‰æŠŠç®—æ³•ç»†èŠ‚è€ƒè™‘åŸºæœ¬æ¸…æ¥š, åšåˆ° <code>Think twice, Code once</code> å§. è¿™æ ·ä¹Ÿä¸ä¼šå‡ºç°æŸé“é¢˜å†™äº†å¾ˆä¹…æœ€åå‘ç°åšæ³•æ˜¯é”™è¯¯çš„è¿™ç§å°´å°¬çš„æƒ…å†µä¹Ÿèƒ½å¤Ÿé¿å…å†™ä¸€äº›ç‰¹åˆ«å¤æ‚çš„åšæ³•.</p><h3 id="å…³äºæœªæ¥">å…³äºæœªæ¥</h3><p>é’ˆå¯¹è¿™æ¬¡è”èµ›çš„é—®é¢˜å’ŒåŸæ¥çš„ä¸€äº›å¼±ç‚¹, å¯¹æ¥ä¸‹æ¥çš„ä¸€æ®µå­¦ä¹ åšä¸€äº›è§„åˆ’ï¼š</p><ul><li>è¡¥ä¸€äº›æ•°å­¦ç›¸å…³çš„çŸ¥è¯†ï¼ˆä¸ä¸€å®šOIç›¸å…³ï¼‰</li><li>æé«˜ä¸€ä¸‹ä»£ç èƒ½åŠ›, å¤ä¹ ä¸€äº›ä¸ç†Ÿç»ƒçš„æ•°æ®ç»“æ„, åˆ·ä¸€äº›è´¨é‡æ¯”è¾ƒé«˜çš„é¢˜ç›®</li></ul><p>ç„¶åçš„è¯, å›å»å°±è¦è¡¥æ–‡åŒ–äº†å§.</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;å¼•&quot;&gt;å¼•&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ¬æ¥åº”è¯¥æœ‰å¦ä¸€ç¯‡åšå®¢å«åšå†™åœ¨NOIP2017ä¹‹å‰çš„, ä½†è·‘å›å®¶æ‰æ„è¯†åˆ°åšå®¢æ­åœ¨æœºæˆ¿çš„ç”µè„‘ä¸Š, äºæ˜¯......&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Summary" scheme="http://yoursite.com/tags/Summary/"/>
    
  </entry>
  
  <entry>
    <title>CTSC2017 æ¸¸æˆ</title>
    <link href="http://yoursite.com/2017/ctsc2017-game/"/>
    <id>http://yoursite.com/2017/ctsc2017-game/</id>
    <published>2017-08-22T12:21:17.000Z</published>
    <updated>2020-08-17T13:11:33.656Z</updated>
    
    <content type="html"><![CDATA[<h3 id="description">Description</h3><blockquote><p>æœ‰<span class="math inline">\(N\)</span> å±€æ¸¸æˆ, é™¤ç¬¬ä¸€å±€æ¸¸æˆå¤–æ¯ä¸€å±€æ¸¸æˆçš„è·èƒœæœºç‡å‡ä¸ä¸Šä¸€å±€æ¸¸æˆçš„ç»“æœæœ‰å…³. ç°åœ¨å¯¹æ¸¸æˆè¿›è¡Œ<span class="math inline">\(Q\)</span>æ¬¡ä¿®æ”¹, æ¯æ¬¡å‘Šè¯‰ä½ æŸä¸€å±€æ¸¸æˆçš„ç»“æœæˆ–è€…åˆ é™¤ä¹‹å‰ç»™ä½ çš„ä¿¡æ¯, æ±‚ä¿®æ”¹åæœŸæœ›ä¸‹è·èƒœçš„åœºæ•°ä¸ºå¤šå°‘.</p></blockquote><p><span class="math inline">\(N, Q \le 2 \times 10 ^ 5\)</span></p><a id="more"></a><h3 id="solution">Solution</h3><p>é¦–å…ˆä¸éš¾å‘ç°, æŸä¸€å±€çš„æ¸¸æˆçš„èƒœç‡åªä¸å…¶å·¦å³çš„æœ€è¿‘æ¸¸æˆç»“æœç›¸å…³, æ‰€ä»¥ç­”æ¡ˆå¯ä»¥åˆ†æ®µè®¡ç®—.</p><p>è€ƒè™‘æœŸæœ›çš„çº¿æ€§æ€§, å¯ä»¥å°†æœŸæœ›èƒœåˆ©åœºæ•°è¡¨ç¤ºæˆæ¯ä¸€å±€æ¸¸æˆçš„èƒœç‡ä¹‹å’Œ. è®° <span class="math inline">\(X_i\)</span> è¡¨ç¤ºç¬¬<span class="math inline">\(i\)</span> åœºæ¸¸æˆçš„çŠ¶æ€. æ‰€æ±‚å³ä¸º <span class="math inline">\(\sum _ {l &lt; m &lt; r} P( X _ m = 1 | X _ l, X _ r)\)</span></p><p>ç”±è´å¶æ–¯å…¬å¼: <span class="math display">\[\begin{align}P(X _ m = 1 | X _ l, X _ r) &amp;= \frac{P(X _ m = 1, X _ l, X _ r)}{P(X _ l) \cdot P(X _ r | X _ l) } \\&amp;= \frac{P(X _ l) \cdot P(X _ m = 1 | X _ l) \cdot P(X _ r | X _ l, X _ m = 1)}{P(X _ l) \cdot P(X _ r | X _ l)} \\&amp;= \frac{P(X _ m=1 | X _ l) \cdot P(X _ r | X _ l, X _ m = 1)}{P(X _ r | X _ l)} \\&amp;= \frac{P(X _ m=1 | X _ l) \cdot P(X _ r | X _ m = 1)}{P(X _ r | X _ l)} \end{align}\]</span></p><p>å‘ç°åˆ†æ¯æ˜¯å¸¸æ•°, äºæ˜¯å¯ä»¥åˆå¹¶åˆ†å­. è€ƒè™‘åˆ†å­çš„æ„ä¹‰, å¤§æ¦‚æ˜¯åˆæ³•çŠ¶æ€ä¸‹å½“å‰ä½ç½®ä¸ºèƒœçš„æ¦‚ç‡. æ¯ä¸€æ®µå°±å¯ä»¥ç›´æ¥ç”¨<span class="math inline">\(dp\)</span>æ¥å¤„ç†å‡ºç­”æ¡ˆ, è®°å½•æŸåœºæ¯”èµ›ä¸ºèƒœ/ è´Ÿçš„æ¦‚ç‡ä»¥åŠåˆ†å­çš„æœŸæœ›å³å¯. è¿™ä¸ªå¤æ‚åº¦æ˜¯æ¯æ¬¡è¯¢é—®<span class="math inline">\(O(n)\)</span>çš„.</p><p>å…¶å®è¿™é“é¢˜è¦è®²çš„å·²ç»è®²å®Œäº†, æœ€ååªè¦ç”¨çŸ©ä¹˜å¿«é€Ÿåˆå¹¶<span class="math inline">\(dp\)</span>å€¼, ç»´æŠ¤ä¸€ä¸‹å°±å¯ä»¥äº†.</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;description&quot;&gt;Description&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ‰&lt;span class=&quot;math inline&quot;&gt;\(N\)&lt;/span&gt; å±€æ¸¸æˆ, é™¤ç¬¬ä¸€å±€æ¸¸æˆå¤–æ¯ä¸€å±€æ¸¸æˆçš„è·èƒœæœºç‡å‡ä¸ä¸Šä¸€å±€æ¸¸æˆçš„ç»“æœæœ‰å…³. ç°åœ¨å¯¹æ¸¸æˆè¿›è¡Œ&lt;span class=&quot;math inline&quot;&gt;\(Q\)&lt;/span&gt;æ¬¡ä¿®æ”¹, æ¯æ¬¡å‘Šè¯‰ä½ æŸä¸€å±€æ¸¸æˆçš„ç»“æœæˆ–è€…åˆ é™¤ä¹‹å‰ç»™ä½ çš„ä¿¡æ¯, æ±‚ä¿®æ”¹åæœŸæœ›ä¸‹è·èƒœçš„åœºæ•°ä¸ºå¤šå°‘.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(N, Q \le 2 \times 10 ^ 5\)&lt;/span&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Probability" scheme="http://yoursite.com/tags/Probability/"/>
    
      <category term="Data Structure" scheme="http://yoursite.com/tags/Data-Structure/"/>
    
  </entry>
  
  <entry>
    <title>ä¸¤é“æ¦‚ç‡é¢˜</title>
    <link href="http://yoursite.com/2017/probability-problems/"/>
    <id>http://yoursite.com/2017/probability-problems/</id>
    <published>2017-07-17T13:01:11.000Z</published>
    <updated>2018-11-29T19:43:50.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ç›é‡Œè‹Ÿæ–¯">ç›é‡Œè‹Ÿæ–¯</h3><h4 id="description">Description</h4><blockquote><p>ç»™ä½ ä¸€ä¸ªå¤§å°ä¸ºNçš„å¯é‡é›†åˆ, æ±‚è¯¥é›†åˆå­é›†å¼‚æˆ–å’Œçš„<span class="math inline">\(K\)</span>æ¬¡æ–¹çš„æœŸæœ›, ä¿è¯ç­”æ¡ˆä¸è¶…è¿‡<span class="math inline">\(2 ^ {64}\)</span>.</p></blockquote><p><span class="math inline">\(N \le 100000, K \le 5, A _ i \le 10 ^ 9\)</span></p><a id="more"></a><h4 id="solution">Solution</h4><p>â€ƒâ€ƒ <span class="math inline">\(K=1\)</span> æ—¶æ»¡è¶³æœŸæœ›çš„çº¿æ€§æ€§, å¯ä»¥å¯¹æ¯ä¸€ä¸ªäºŒè¿›åˆ¶ä½åˆ†å¼€è®¡ç®—ç­”æ¡ˆ. ä¸éš¾å‘ç°æ¯ä¸€ä¸ªäºŒè¿›åˆ¶ä½å˜æˆ <span class="math inline">\(1\)</span> çš„æ¦‚ç‡æ°å¥½ä¸º <span class="math inline">\(\frac {1}{2}\)</span> (é›†åˆçš„å¥‡æ•°å’Œå¶æ•°å¤§å°çš„å­é›†æ•°ç›¸åŒ).</p><p>â€ƒâ€ƒ <span class="math inline">\(K=2\)</span> æ—¶è¦æ±‚çš„æ˜¯æœŸæœ›çš„å¹³æ–¹, å³: <span class="math display">\[ \sum_{i=0}^{32} \sum_{j=0}^{32} b_i b_j 2^{i+j} \]</span> å…¶ä¸­ <span class="math inline">\(b_i\)</span>è¡¨ç¤ºæœŸæœ›äºŒè¿›åˆ¶ç¬¬ <span class="math inline">\(i\)</span> ä½çš„å€¼, æšä¸¾ä¸¤ä¸ªäºŒè¿›åˆ¶ä½å†æ±‚ä¸€ä¸‹ä¸¤ä¸ªä½ç½®åŒæ—¶å–åˆ° <span class="math inline">\(1\)</span> çš„æ¦‚ç‡å³å¯.</p><p>â€ƒâ€ƒ <span class="math inline">\(K \ge 3\)</span>æ—¶ç”±äºç­”æ¡ˆä¸è¶…è¿‡ <span class="math inline">\(2^{64}\)</span>, æ‰€ä»¥é›†åˆå†…çš„æ•°ä¹Ÿä¸ä¼šå¾ˆå¤§, ç›´æ¥ç”¨çº¿æ€§åŸºå¤„ç†.</p><h3 id="ä¸»æ—‹å¾‹">ä¸»æ—‹å¾‹</h3><h4 id="description-1">Description</h4><blockquote><p>æ±‚Nä¸ªç‚¹, Mæ¡è¾¹çš„æœ‰å‘å›¾æœ‰å¤šå°‘ç”Ÿæˆå­å›¾æ»¡è¶³æ•´ä¸ªå›¾æ˜¯å¼ºè”é€šçš„.</p></blockquote><p><span class="math inline">\(N \le 15, M \le N(N-1)\)</span></p><h4 id="solution-1">Solution</h4><p>â€ƒâ€ƒ è¿™é¢˜ä¸€çœ¼çœ‹ä¸Šå»ä¸å¤ªå¥½åš, ä¸å¦¨ä»é—®é¢˜çš„åé¢æ¥è€ƒè™‘. é¦–å…ˆä¸€ä¸ªéå¼ºè”é€šçš„å›¾ç¼©æ‰<span class="math inline">\(Scc\)</span> ä¹‹åä¼šå¾—åˆ°è‹¥å¹²ä¸ª <span class="math inline">\(DAG\)</span>. å¦‚æœçŸ¥é“<span class="math inline">\(Scc\)</span> çš„åˆ’åˆ†æƒ…å†µ, è®¡ç®—<span class="math inline">\(DAG\)</span> çš„æ•°é‡å°±å˜æˆä¸€ä¸ªç»å…¸é—®é¢˜äº†:</p><p><span class="math display">\[ E(S, T) = {|\{(u, v) \in E | u \in S, v \in T)\}|} \]</span></p><p><span class="math display">\[ F(S) = \sum _ {T \subset S, T \neq \varnothing} (-1) ^ {|T| - 1}  \times 2 ^ {E(T, S-T)} F(T) \]</span></p><p>â€ƒâ€ƒ ç„¶è€Œæ„Ÿè§‰æšä¸¾<span class="math inline">\(Scc\)</span> åˆ’åˆ†æ›´ä¸å¯åš. å…ˆä¸è€ƒè™‘<span class="math inline">\(Scc\)</span> å¦‚ä½•åˆ’åˆ†, è€ƒè™‘å“ªä¸€äº›ç‚¹é›†æ„æˆå¤šå°‘ä¸ª<span class="math inline">\(Scc\)</span>. å‡è®¾<span class="math inline">\(G _ K(T)\)</span>è¡¨ç¤º<span class="math inline">\(T\)</span> é›†åˆåˆ†æˆ<span class="math inline">\(K\)</span> ä¸ª<span class="math inline">\(Scc\)</span> çš„æ–¹æ¡ˆæ•°, ç±»ä¼¼ä¸Šé¢å¼å­åœ°, æœ‰:</p><p><span class="math display">\[ F(S) = \sum _ {T \subset S, T \neq \varnothing} \sum _ {K = 1}^{|T|} (-1) ^ {K - 1} \times G _ K(T) \times 2 ^ {E(T, S-T) + E(S-T, S-T)} \]</span></p><p><span class="math display">\[ DP(S) = 2 ^ {E(S, S)} - F(S) \]</span></p><p>â€ƒâ€ƒ å®é™…ä¸Šåªéœ€è¦æ±‚å°†æŸä¸ªé›†åˆåˆ†æˆå¥‡æ•°ä¸ª<span class="math inline">\(Scc\)</span> ä¸å¶æ•°ä¸ª<span class="math inline">\(Scc\)</span> çš„æ–¹æ¡ˆæ•°ä¹‹å·® <span class="math inline">\(P(S)\)</span>:</p><p><span class="math display">\[ P(S) = DP(S) + \sum _ {T \subset S, u \in T} - DP(T) \times P(S - T) \]</span></p><blockquote><p>å…¶ä¸­ <span class="math inline">\(u \in T\)</span> é¿å…é‡å¤è®¡æ•°.</p></blockquote><p>â€ƒâ€ƒ è¿™æ ·åŠ ä¸Šä¸€äº›é¢„å¤„ç†çš„æŠ€å·§å¯ä»¥åšåˆ° <span class="math inline">\(O(3 ^ n)\)</span>.</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;ç›é‡Œè‹Ÿæ–¯&quot;&gt;ç›é‡Œè‹Ÿæ–¯&lt;/h3&gt;
&lt;h4 id=&quot;description&quot;&gt;Description&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™ä½ ä¸€ä¸ªå¤§å°ä¸ºNçš„å¯é‡é›†åˆ, æ±‚è¯¥é›†åˆå­é›†å¼‚æˆ–å’Œçš„&lt;span class=&quot;math inline&quot;&gt;\(K\)&lt;/span&gt;æ¬¡æ–¹çš„æœŸæœ›, ä¿è¯ç­”æ¡ˆä¸è¶…è¿‡&lt;span class=&quot;math inline&quot;&gt;\(2 ^ {64}\)&lt;/span&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(N \le 100000, K \le 5, A _ i \le 10 ^ 9\)&lt;/span&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Combinatorial" scheme="http://yoursite.com/tags/Combinatorial/"/>
    
      <category term="Dynamic Programming" scheme="http://yoursite.com/tags/Dynamic-Programming/"/>
    
      <category term="Probability" scheme="http://yoursite.com/tags/Probability/"/>
    
  </entry>
  
  <entry>
    <title>Atcoder é€‰åš</title>
    <link href="http://yoursite.com/2017/atcoder-select/"/>
    <id>http://yoursite.com/2017/atcoder-select/</id>
    <published>2017-06-29T16:00:00.000Z</published>
    <updated>2020-08-17T13:16:07.906Z</updated>
    
    <content type="html"><![CDATA[<p>å…¶å®æ˜¯æ€»ç»“ä¸€ä¸‹æ¯”èµ›ä¸­é‡åˆ°çš„å¥½é¢˜, ç„¶åçåšäº†å‡ åœº AGC çš„é¢˜ç›®ç»ƒä¹ , æ„Ÿè§‰è¿˜æ¯”è¾ƒæœ‰æ„æ€.</p><a id="more"></a><h3 id="agc">AGC</h3><h4 id="agc002-f-leftmost-ball">AGC002 F Leftmost Ball</h4><blockquote><p>ç»™ä½ <span class="math inline">\(N\)</span>ç§ä¸åŒé¢œè‰²çš„çƒ, æ¯ç§æœ‰<span class="math inline">\(K\)</span>ä¸ª, ç°åœ¨ä½ å¯ä»¥å°†çƒä»»æ„æ’åˆ—, ä½†æœ€ç»ˆçš„åºåˆ—ä¸­æ¯ç§é¢œè‰²çš„ç¬¬ä¸€ä¸ªå‡ºç°ä½ç½®è¦è¢«æŸ“æˆ<span class="math inline">\(0\)</span>é¢œè‰², æ±‚èƒ½å¤Ÿå¾—åˆ°çš„æœ¬è´¨ä¸åŒçš„åºåˆ—æ•°, å¯¹<span class="math inline">\(10^9 + 7\)</span>å–æ¨¡.</p></blockquote><p><span class="math inline">\(N, K \leq 2000\)</span></p><p>è¿™é¢˜æ­£ç€å¤„ç†æ²¡æœ‰ä»€ä¹ˆæ€è·¯, ä½†æ˜¯å¦‚æœä»å³å¾€å·¦æ¥ä¼šæ¯”è¾ƒå¥½è€ƒè™‘. æˆ‘ä»¬å¯ä»¥è®°<span class="math inline">\(f(i, j)\)</span>è¡¨ç¤ºå½“å‰ä»å³å¾€å·¦å¡«å‰©ä¸‹<span class="math inline">\(i\)</span>ä¸ª<span class="math inline">\(0\)</span>é¢œè‰²çš„çƒ, è¿˜å‰©ä¸‹<span class="math inline">\(j\)</span>ç§é¢œè‰²æ²¡æœ‰æ”¾çš„æ–¹æ¡ˆæ•°. é‚£ä¹ˆæ¯ä¸€æ¬¡çš„å†³ç­–å°±åŒ…æ‹¬æ”¾å…¥ä¸€ä¸ª<span class="math inline">\(0\)</span>é¢œè‰²çš„çƒä»¥åŠæ·»åŠ ä¸€ç§é¢œè‰²çš„<span class="math inline">\(k-1\)</span>ä¸ªçƒ:</p><p><span class="math display">\[\begin{aligned}    f(i-1, j) &amp; \leftarrow f(i, j) \mid [i &gt; j] \\    f(i, j-1) &amp; \leftarrow f(i, j) \times {n-i + (n-j) \times (k-1) + k-2 \choose k-2}\end{aligned}\]</span></p><blockquote><p>åé¢é‚£ä¸ªå…¬å¼æ˜¯å¯é‡é›†, è¿˜æœ‰æœ€åçš„ç­”æ¡ˆè¦ä¹˜ä»¥<span class="math inline">\(n!\)</span>.</p></blockquote><h4 id="agc005-d-k-perm-counting">AGC005 D ~K Perm Counting</h4><blockquote><p>æ±‚é•¿åº¦ä¸º<span class="math inline">\(N\)</span>çš„æ’åˆ—ä¸­, æ»¡è¶³å¯¹ä»»æ„çš„<span class="math inline">\(i\)</span>, éƒ½æœ‰<span class="math inline">\(|a_i - i| \neq K\)</span>çš„æ’åˆ—æ•°é‡.</p></blockquote><p><span class="math inline">\(1 \leq K &lt; N \leq 2000\)</span></p><p>è€ƒè™‘å®¹æ–¥, è®¡ç®—è‡³å°‘æœ‰<span class="math inline">\(i\)</span>ä¸ªä½ç½®ä¸åˆæ³•çš„æ–¹æ¡ˆæ•°. ç”±äº<span class="math inline">\(K\)</span>æ˜¯ç¡®å®šçš„, é‚£ä¹ˆæ‰€æœ‰ä¸åˆæ³•çš„æ–¹æ¡ˆå¯ä»¥çœ‹æˆæ˜¯å®Œå…¨äºŒåˆ†å›¾åŒ¹é…ä¸­å‡ºç°äº†ä¸€æ¡<span class="math inline">\((i, i+k)\)</span>çš„è¾¹æˆ–è€…ä¸€æ¡<span class="math inline">\((i, i-k)\)</span>çš„è¾¹.</p><p>å°†è¿™æ ·çš„è¾¹åœ¨ç”»å‡ºæ¥å°±æ˜¯è‹¥å¹²æ¡äº¤å‰è·¯å¾„. è§‚å¯Ÿåˆ°è¿™æ ·çš„äº¤å‰è·¯å¾„ä¸ç›¸äº¤, æ‰€ä»¥å¯ä»¥æ‹†å¼€æ‹¼æˆä¸€ä¸ªåºåˆ—, ç„¶ååœ¨åºåˆ—ä¸Š<span class="math inline">\(dp\)</span>å³å¯.</p><h4 id="agc015-d-a-or...or-b-problem">AGC015 D A or...or B Problem</h4><blockquote><p>æ±‚åœ¨<span class="math inline">\([A, B]\)</span>ä¸­ä»»æ„é€‰å‡ºä¸€ä¸ªéç©ºæ•´æ•°é›†åˆçš„å…ƒç´ ä½æˆ–å’Œæœ‰å¤šå°‘ç§ä¸åŒçš„ç­”æ¡ˆ.</p></blockquote><p><span class="math inline">\(1 \le A \le B \le 2^{60}\)</span></p><p>å…ˆè€ƒè™‘ä¸€äº›æ¯”è¾ƒç‰¹æ®Šçš„æƒ…å†µ(ä»¥ä¸‹é»˜è®¤<span class="math inline">\(A, B\)</span>çš„ä½æ•°ç›¸åŒ):</p><ul><li>å½“<span class="math inline">\(B\)</span>å¯ä»¥è¡¨ç¤ºä¸º<span class="math inline">\(2^k - 1\)</span>æ—¶, è¿™ä¸ªä½æˆ–å’Œæ°å¥½å–é<span class="math inline">\([A, B]\)</span>ä¹‹é—´çš„æ‰€æœ‰æ•´æ•°.</li><li>å½“<span class="math inline">\(A\)</span>å¯ä»¥è¡¨ç¤ºä¸º<span class="math inline">\(2^k\)</span>æ—¶, è¿™ä¸ªä½æˆ–å’Œåœ¨åŒºé—´<span class="math inline">\([A, A + 2^{t+1}) \mid t &lt; \log_2 A\)</span>ä¸­, å…¶ä¸­<span class="math inline">\(t\)</span>æ˜¯æœ€å¤§çš„æ»¡è¶³<span class="math inline">\(B\)</span>çš„ç¬¬<span class="math inline">\(t\)</span>ä½ä¸º<span class="math inline">\(1\)</span>çš„æ•°.</li></ul><p>é‚£ä¹ˆä¸€èˆ¬æƒ…å†µä¸‹è¿™äº›æ¡ä»¶æœ‰ä»€ä¹ˆç”¨å‘¢?</p><p>æˆ‘ä»¬è€ƒè™‘æ‰¾åˆ°æœ€å¤§çš„ä¸€ä¸ª<span class="math inline">\(T\)</span>,ä½¿å¾—<span class="math inline">\(B\)</span>çš„ç¬¬<span class="math inline">\(T\)</span>ä½ä¸º<span class="math inline">\(1\)</span>ä¸”<span class="math inline">\(A\)</span>çš„ç¬¬<span class="math inline">\(T\)</span>ä½ä¸ä¸º<span class="math inline">\(1\)</span>, è®°<span class="math inline">\(K = 2 ^ T\)</span>. å½“é€‰æ‹©çš„æ•°çš„é›†åˆåœ¨<span class="math inline">\([A, K)\)</span>ä»¥åŠåœ¨<span class="math inline">\([K, B]\)</span>ä¸­çš„æƒ…å†µå¯ä»¥ç›´æ¥ç”¨ä¸Šè¿°ç»“è®º.</p><p>æ¥ä¸‹æ¥è€ƒè™‘åŒæ—¶é€‰å–ä¸¤ä¸ªé›†åˆä¸­çš„æ•°å¯èƒ½ä¼šäº§ç”Ÿçš„ç­”æ¡ˆ. å› ä¸ºè¿™æ—¶å°äº<span class="math inline">\(K\)</span>çš„éƒ¨åˆ†æ˜¯æ²¡æœ‰è´¡çŒ®çš„, æ‰€ä»¥ç›´æ¥å°†<span class="math inline">\([A, K)\)</span>ä¸­çš„æ‰€æœ‰ç­”æ¡ˆå–å‡º. ä¸éš¾å‘ç°<span class="math inline">\([K, B]\)</span>ä¸­å–ä»»æ„ä¸ªéƒ½ä¸åªä½¿ç”¨<span class="math inline">\(K\)</span>æ²¡æœ‰åŒºåˆ«, é‚£ä¹ˆè¿™æ—¶å€™çš„èŒƒå›´æ˜¯<span class="math inline">\([K+A, 2\times K-1]\)</span>, æ³¨æ„å‡å»é‡å¤è´¡çŒ®.</p><h4 id="agc015-f-kenus-the-ancient-greek">AGC015 F Kenus the Ancient Greek</h4><blockquote><p><span class="math inline">\(Q\)</span> ç»„è¯¢é—®, æ¯ç»„è¯¢é—®çš„å½¢å¼ä¸ºA, B, è¡¨ç¤ºæ±‚<span class="math inline">\(x \in [1, A], y \in [1, B]\)</span>çš„<span class="math inline">\(g(x, y)\)</span>çš„æœ€å¤§å€¼, åŠæœ€å¤§å€¼çš„æ–¹æ¡ˆæ•°, å…¶ä¸­:</p></blockquote><p><span class="math display">\[g(x, y) = \begin{cases}     1, &amp; \text{y = 0} \\    g(y, x), &amp; \text{x &gt; y} \\    g(y \; mod \; x, x) + 1, &amp; \text{otherwise} \\\end{cases}\]</span></p><p><span class="math inline">\(1 \le Q \le 3 \times 10 ^ 5 \,\,, 1 \le A, B \le 10 ^ {18}\)</span></p><p><strong>ä»¥ä¸‹æ— ç‰¹æ®Šè¯´æ˜, å‡é»˜è®¤æ‰€æœ‰<span class="math inline">\(x &lt; y, A &lt; B\)</span></strong> å…ˆè€ƒè™‘ç¬¬ä¸€é—®, å¦‚æœæˆ‘ä»¬ç”±ä¸€ä¸ªç‰¹å®šçš„<span class="math inline">\((x, y)\)</span>, ä»å°åˆ°å¤§åœ°æ„é€ ä½¿å¾—<span class="math inline">\(g(x, y)\)</span>çš„å€¼ä¸æ–­åœ°å˜å¤§, é‚£ä¹ˆå¦‚ä½•æ„é€ ä½¿å¾—è¿™ä¸ªå€¼æœ€å¤§å‘¢? å¯¹äºæ‰€æœ‰<span class="math inline">\((x&#39;, y&#39;)\)</span>æ»¡è¶³<span class="math inline">\(g(x&#39;, y&#39;) = g(x, y) + 1\)</span>, æ˜¾ç„¶æœ‰:</p><p><span class="math display">\[(x&#39;, y&#39;) \in \{ (y, x + ky) \mid k \in Z^+ \} \]</span></p><p>åŒæ—¶, ä¸ºäº†ä½¿å¾—è¿™ä¸ªè¿‡ç¨‹å°½å¯èƒ½çš„å¤šæ¬¡è¿›è¡Œ,æˆ‘ä»¬ä»<span class="math inline">\((0, 1)\)</span>å‡ºå‘, æ¯æ¬¡å–<span class="math inline">\(k = 1\)</span>. å‘ç°è¿™æ ·ç”Ÿæˆäº†ä¸€ç»„<span class="math inline">\(Fibonacci\)</span>æ•°åˆ—, è¿™é‡Œ<span class="math inline">\(Fibonacci\)</span>æ•°åˆ—ä»0å¼€å§‹æ ‡å·. é‚£ä¹ˆç¬¬ä¸€é—®çš„ç­”æ¡ˆå°±æ˜¯æ±‚æ»¡è¶³<span class="math inline">\(Fib_k \le A,\; Fib_{k+1} \le B\)</span>çš„æœ€å¤§çš„<span class="math inline">\(k\)</span>. åŒæ—¶, è¿™æ ·çš„æ•°å¯¹æ˜¯æ»¡è¶³<span class="math inline">\(g(x, y) = k\)</span>çš„æœ€å°çš„æ•°å¯¹. æ¥ä¸‹æ¥è€ƒè™‘ç»Ÿè®¡æ–¹æ¡ˆæ•°. é¦–å…ˆ, å¯¹äºä¸€ç»„è¯¢é—®æˆ‘ä»¬åªéœ€è€ƒè™‘å…¶ä¸­<strong>ä¸æœ€ä¼˜è§£ç›¸å…³</strong>çš„<span class="math inline">\((x, y)\)</span>. è€ƒè™‘æ‰€æœ‰æœ€ä¼˜çš„<span class="math inline">\((x, y)\)</span>ä¼šå…·æœ‰çš„æ€§è´¨:</p><ul><li><span class="math inline">\(x \ge Fib_k, \; y \ge Fib_{k+1}\)</span></li><li>ä¸å­˜åœ¨ä¸€ç»„<span class="math inline">\((x&#39; &lt; x, y&#39; &lt; y)\)</span>, ä½¿å¾—<span class="math inline">\(g(x&#39;, y&#39;) &gt; g(x, y)\)</span></li></ul><p>ç„¶è€Œè¿™æ ·çš„<span class="math inline">\((x, y)\)</span>å¹¶ä¸ä¸€å®šæ˜¯æœ€ä¼˜çš„. æˆ‘ä»¬æ¥ç€åˆ†ææ‰€æœ‰åœ¨æœ€ä¼˜è§£çš„<span class="math inline">\(g\)</span>çš„è®¡ç®—è·¯å¾„ä¸Šçš„æ•°å¯¹<span class="math inline">\((x, y)\)</span>çš„æ€§è´¨: ä¸éš¾å‘ç°, ç»è¿‡ä¸€æ¬¡å˜åŒ–åå¾—åˆ°çš„<span class="math inline">\((x&#39;, y&#39;)\)</span>, ä¸€å®šæ»¡è¶³:</p><ul><li><span class="math inline">\(g(x&#39;, y&#39;) = k-1\)</span></li><li><span class="math inline">\(x&#39; \ge Fib_{k-1}, y&#39; \ge Fib_{k}\)</span></li><li><span class="math inline">\(y&#39; \le Fib_{k+1} + Fib_{k-2}\)</span></li></ul><p>åé¢æ¡ä»¶çš„è§£é‡Š: è‹¥<span class="math inline">\(y&#39; &gt; Fib_{k+1} + Fib_{k-2}\)</span>, åˆ™: <span class="math display">\[(x, y) = (y&#39; &gt; Fib_{k+1} + Fib_{k-2} &gt; Fib_{k+1}, x&#39; + py&#39; \ge x&#39; + y&#39; &gt; Fib_{k+2})\]</span> <span class="math inline">\((x, y)\)</span>ä¸å†æ»¡è¶³ä¸Šè¿°æœ€ä¼˜æ€§è´¨2, çŸ›ç›¾. åŒæ—¶æ¯æ¬¡å‘ä¸‹ä¸€æ­¥è¿›è¡Œæ„é€ çš„æ—¶å€™åªæœ‰<span class="math inline">\((Fib_k, Fib_{k+1})\)</span>å¯èƒ½å–åˆ°<span class="math inline">\(p = 2\)</span>æ‰€ä»¥è¿™æ ·çš„æ•°å¯¹ä¸ªæ•°æ˜¯<span class="math inline">\(O(k)\)</span>çš„. æ‰€ä»¥æˆ‘ä»¬é¢„å¤„ç†æ‰€æœ‰çš„è¿™æ ·çš„æ•°å¯¹, ç„¶åç”¨é™¤æ³•ç®—ä¸‹ç­”æ¡ˆå°±å¥½äº†. å¤æ‚åº¦<span class="math inline">\(O(\log^2{MAX} + Q\log MAX)\)</span>.</p><h3 id="arc">ARC</h3><p>ARC çš„é¢˜ç›®ä¸»è¦æ¥æºæ˜¯æ‰“è¿‡çš„å‡ åœºæ¯”èµ›, æš‚æ—¶ä¸å¤š.</p><h4 id="arc074-e-rgb-sequence">ARC074 E RGB Sequence</h4><blockquote><p>ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º<span class="math inline">\(N\)</span>çš„åºåˆ—å’Œ<span class="math inline">\(M\)</span>ç»„çº¦æŸæ¡ä»¶, æ¯ç»„æ¡ä»¶å½¢å¦‚<span class="math inline">\(L_i, R_i, X_i\)</span>, è¡¨ç¤ºåºåˆ—ä¸Šçš„<span class="math inline">\([L_i, R_i]\)</span>ä¸­æ°å¥½æœ‰<span class="math inline">\(X_i\)</span>ç§é¢œè‰², ç°åœ¨è¦ä½ ç”¨ä¸‰ç§é¢œè‰²ç»™è¿™ä¸ªåºåˆ—æŸ“è‰², æ±‚æ»¡è¶³æ‰€æœ‰çº¦æŸçš„æ–¹æ¡ˆæ•°.</p></blockquote><p><span class="math inline">\(1 \le N, M \le 300\)</span></p><p><span class="math inline">\(dp\)</span>çš„æ€è·¯åº”è¯¥æ¯”è¾ƒæ˜¾ç„¶, ç„¶è€Œæ™®é€šçš„çŠ¶æ€è¡¨ç¤ºä¸å¤ªå¥½å¤„ç†. æˆ‘ä»¬è®°<span class="math inline">\(dp_{r, g, b}\)</span>è¡¨ç¤ºä¸‰ç§é¢œè‰²çš„çƒæœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®åˆ†åˆ«æ˜¯<span class="math inline">\(r, g, b\)</span>æ—¶çš„æ–¹æ¡ˆæ•°.</p><p>ç„¶åè€ƒè™‘çŠ¶æ€çš„åˆæ³•æ€§, å¯ä»¥æŠŠæ¡ä»¶å­˜åœ¨<span class="math inline">\(R_i\)</span>çš„ä½ç½®. å½“é€‰æ‹©ä¸€ä¸ªçŠ¶æ€æ—¶, è€ƒè™‘è¿™ä¸ªçŠ¶æ€çš„æœ€æœ«ä½çš„æ‰€æœ‰çº¦æŸå³å¯.</p><h4 id="arc077-f-ss">ARC077 F SS</h4><blockquote><p>å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²ä¸ºå¶çš„, å½“ä¸”ä»…å½“è¿™ä¸ªå­—ç¬¦ä¸²èƒ½å¤Ÿè¢«åˆ†æˆä¸¤ä¸ªå®Œå…¨ç›¸åŒçš„å­—ç¬¦ä¸².</p></blockquote><p>å®šä¹‰å‡½æ•°<span class="math inline">\(f(s)\)</span>, å…¶ä¸­<span class="math inline">\(s, f(s)\)</span>å‡æ˜¯å­—ç¬¦ä¸²,<span class="math inline">\(f(s)\)</span>ä¸ºåœ¨å­—ç¬¦ä¸²<span class="math inline">\(s\)</span>åæ·»åŠ éç©ºçš„å­—ç¬¦æ»¡è¶³æ–°ä¸²ä¸ºå¶ä¸”é•¿åº¦æœ€å°çš„ä¸². ç°åœ¨ç»™ä½ ä¸²<span class="math inline">\(s\)</span>(åˆå§‹ä¸ºå¶çš„), æ±‚<span class="math inline">\(f^{10^{100}}(s)[L, R]\)</span>ä¸­å„ä¸ªå­—æ¯çš„å‡ºç°æ¬¡æ•°. <span class="math inline">\(1 \le |S| \le 2\times 10^5\)</span> <span class="math inline">\(1 \le L \le R \le 10^{18}\)</span></p><p>é¦–å…ˆå¯¹äºä¸€ä¸ªç»™å®šçš„<span class="math inline">\(s\)</span>, å…¶<span class="math inline">\(f(s)\)</span>å¿…å®šå”¯ä¸€. è€ƒè™‘æ¯æ¬¡æœ€å°‘åŠ ä¸€ä¸ªå­—ç¬¦,<span class="math inline">\(f^{10^{100}}(s)\)</span>å°±ç­‰ä»·äºä¸€ä¸ªé•¿åº¦æ— ç©·çš„å­—ç¬¦ä¸². è¿™ä¸ªç­”æ¡ˆçš„å½¢å¼æ˜¾ç„¶å¯ä»¥å‰ç¼€å’Œ, åˆå› ä¸º<span class="math inline">\(s\)</span>åœ¨å˜åŒ–è¿‡ç¨‹ä¸­å§‹ç»ˆæ˜¯å¶çš„, å®é™…ä¸Šæˆ‘ä»¬åªéœ€è¦å…³æ³¨å·¦åŠéƒ¨åˆ†çš„å­—ç¬¦.</p><p>æˆ‘ä»¬ä»æœ€ç®€å•çš„ä¸€æ¬¡æ“ä½œæ¥è€ƒè™‘. è®°åˆå§‹çš„å­—ç¬¦ä¸²<span class="math inline">\(s\)</span>ä¸º<span class="math inline">\(SS\)</span>, è®°ä¸€æ¬¡å˜åŒ–ä¹‹åå·¦è¾¹çš„éƒ¨åˆ†ä¸º<span class="math inline">\(ST\)</span>, é‚£ä¹ˆå¾—åˆ°çš„æ–°ä¸²å°±æ˜¯<span class="math inline">\(STST\)</span>. è¦ä½¿å¾—åŠ çš„å­—ç¬¦é•¿åº¦æœ€å°, å°±è¦åœ¨<span class="math inline">\(S\)</span>ä¸­æ‰¾åˆ°æœ€é•¿å‰åç¼€åŒ¹é…é•¿åº¦, è¿™æ—¶<span class="math inline">\(T\)</span>å°±æ˜¯<span class="math inline">\(S\)</span>å»æ‰æœ€é•¿åŒ¹é…åç¼€æ‰€å¾—.</p><p>æˆ‘ä»¬å‘ç°, æ¯æ¬¡æ“ä½œéƒ½ç­‰ä»·äºæ‰¾åˆ°å‰åç¼€åŒ¹é…æœ€å¤§é•¿åº¦(å½“ç„¶è¦å°äº<span class="math inline">\(|S|\)</span>), ç„¶åå°†å‰©ä¸‹éƒ¨åˆ†çš„å‰ç¼€<span class="math inline">\(T\)</span>æ·»åŠ åˆ°<span class="math inline">\(S\)</span>çš„æœ«å°¾.</p><ul><li>å½“<span class="math inline">\(|T| \mid |S|\)</span>æ—¶,<span class="math inline">\(|S|\)</span>æœ‰é•¿ä¸º<span class="math inline">\(|T|\)</span>çš„æœ€å°å‘¨æœŸ, æ¯æ¬¡åŠ å…¥çš„<span class="math inline">\(|T|\)</span>ç›¸åŒ.</li><li>å½“<span class="math inline">\(|T| \nmid|S|\)</span>æ—¶, æˆ‘ä»¬<del>é€šè¿‡æ‰“è¡¨</del>å‘ç°, è¿™æ ·çš„<span class="math inline">\(T\)</span>æ˜¯åœ¨æœ‰è§„å¾‹åœ°å˜åŒ–çš„, å› ä¸ºæ¯æ¬¡åŠ å…¥<span class="math inline">\(T\)</span>ä¹‹åçš„ä¸²å‰åç¼€æœ€é•¿åŒ¹é…ä¸€å®šæ˜¯<span class="math inline">\(|T|\)</span>, å¦åˆ™çš„è¯, ä¸Šä¸€æ­¥ä¸­æœ€é•¿åŒ¹é…çš„æ€§è´¨å°±ä¸ä¸€å®šä¼šæ»¡è¶³.</li></ul><p>ç„¶åæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª<span class="math inline">\(Fibonacci\)</span>æ•°åˆ—? ç›´æ¥æš´åŠ›ç®—å°±å¥½äº†... å®é™…ä¸Šç¬¬ä¸€ç§æƒ…å†µä¹Ÿå¯ä»¥ç›´æ¥ç®—, å› ä¸ºæ•´ä¸ªåºåˆ—éƒ½æ˜¯<span class="math inline">\(T\)</span>çš„è‹¥å¹²æ¬¡é‡å¤å¾—åˆ°çš„.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å…¶å®æ˜¯æ€»ç»“ä¸€ä¸‹æ¯”èµ›ä¸­é‡åˆ°çš„å¥½é¢˜, ç„¶åçåšäº†å‡ åœº AGC çš„é¢˜ç›®ç»ƒä¹ , æ„Ÿè§‰è¿˜æ¯”è¾ƒæœ‰æ„æ€.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Combinatorial" scheme="http://yoursite.com/tags/Combinatorial/"/>
    
      <category term="Dynamic Programming" scheme="http://yoursite.com/tags/Dynamic-Programming/"/>
    
      <category term="Summary" scheme="http://yoursite.com/tags/Summary/"/>
    
  </entry>
  
  <entry>
    <title>Codeforces Div2 418E</title>
    <link href="http://yoursite.com/2017/cf-418e/"/>
    <id>http://yoursite.com/2017/cf-418e/</id>
    <published>2017-06-12T12:56:07.000Z</published>
    <updated>2018-11-29T19:43:50.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="description">Description</h3><blockquote><p>æ±‚æ»¡è¶³å¦‚ä¸‹æ¡ä»¶çš„ <span class="math inline">\(N\)</span> ä¸ªç‚¹çš„ç®€å•æ— å‘å›¾çš„ä¸ªæ•°å¯¹ $ 1e9 + 7 $ å–æ¨¡çš„ç»“æœï¼š - æ¯ä¸ªç‚¹çš„åº¦æ•°å‡ä¸º <span class="math inline">\(2\)</span> æˆ– <span class="math inline">\(3\)</span> - ä»ä¸€å·ç‚¹åˆ°ä»»ä½•ä¸€ä¸ªç‚¹çš„æœ€çŸ­è·¯å”¯ä¸€å¹¶ä¸”éšç€ç‚¹æ ‡å·ä¸Šå‡è€Œä¸é™.</p></blockquote><p>(ä¸¤ä¸ªå›¾ä¸åŒå½“ä¸”ä»…å½“è¾¹çš„é›†åˆä¸åŒ). <span class="math inline">\(N &lt;= 50\)</span></p><a id="more"></a><h3 id="solution">Solution</h3><p>æˆ‘ä»¬å¯ä»¥è®°: - <span class="math inline">\(f_{i, j}\)</span> è¡¨ç¤ºè€ƒè™‘å®Œå‰ <span class="math inline">\(i\)</span> ä¸ªç‚¹, æœ€åä¸€å±‚æ°å¥½æœ‰ <span class="math inline">\(j\)</span> ä¸ªç‚¹, ä¸”æœ€åä¸€å±‚ä¹‹å‰çš„ç‚¹åº¦æ•°å·²ç»æ»¡è¶³æ¡ä»¶æ—¶çš„æ–¹æ¡ˆæ•°. - <span class="math inline">\(g_{i, j, k}\)</span> è¡¨ç¤ºå½“å‰å±‚æœ‰ <span class="math inline">\(i\)</span> ä¸ªç‚¹, ä¸Šä¸€å±‚å‰©ä¸‹æ¥ <span class="math inline">\(j\)</span> ä¸ªåº¦ä¸º <span class="math inline">\(2\)</span> çš„ç‚¹, <span class="math inline">\(k\)</span> ä¸ªåº¦ä¸º <span class="math inline">\(3\)</span> çš„ç‚¹æ—¶è¿è¾¹çš„æ–¹æ¡ˆæ•°.</p><p>é‚£ä¹ˆå®¹æ˜“å¾—åˆ°<span class="math inline">\(f_{i, j} = \sum_{k} f_{i-j, k} \times g_{j, c0, c1}\)</span>, å…¶ä¸­<span class="math inline">\(c0\,,c1\)</span>è¡¨ç¤ºæœ€åä¸€å±‚ <span class="math inline">\(k\)</span> ä¸ªç‚¹ä¸­åº¦ä¸º <span class="math inline">\(2\)</span> çš„ç‚¹å’Œåº¦ä¸º <span class="math inline">\(3\)</span> çš„ç‚¹çš„ä¸ªæ•°.</p><p>å¯¹äº <span class="math inline">\(g\)</span>, ä¸éš¾å¾—åˆ°:</p><p><span class="math display">\[ g_{i, j, k} = \begin{cases}     1 &amp; i = 0, j = 0, k = 0 \\    \sum_{l=2}^{k-1} \frac{l!}{2} {k-1 \choose l} g_{i, j, k-l-1} &amp; i = 0, j = 0, k &gt; 0 \\    (j-1) \cdot g_{i, j-2, k} + k \cdot g_{i, j, k-1} &amp; i = 0, j &gt; 0 \\    j \cdot g_{i-1, j-1, k} + k \cdot g_{i-1, j+1, k-1} &amp; i &gt; 0\end{cases}\]</span></p><h3 id="hint">Hint</h3><p>æ³¨æ„åœ¨ç¬¬äºŒä¸ªé€’æ¨å¼ä¸­ <span class="math inline">\(l\)</span> ä» <span class="math inline">\(2\)</span> å¼€å§‹æšä¸¾, å› ä¸ºä¸èƒ½æœ‰é‡è¾¹, æ‰€ä»¥ä¸å­˜åœ¨å¤§å°ä¸º <span class="math inline">\(2\)</span> çš„ç¯.</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;description&quot;&gt;Description&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;æ±‚æ»¡è¶³å¦‚ä¸‹æ¡ä»¶çš„ &lt;span class=&quot;math inline&quot;&gt;\(N\)&lt;/span&gt; ä¸ªç‚¹çš„ç®€å•æ— å‘å›¾çš„ä¸ªæ•°å¯¹ $ 1e9 + 7 $ å–æ¨¡çš„ç»“æœï¼š - æ¯ä¸ªç‚¹çš„åº¦æ•°å‡ä¸º &lt;span class=&quot;math inline&quot;&gt;\(2\)&lt;/span&gt; æˆ– &lt;span class=&quot;math inline&quot;&gt;\(3\)&lt;/span&gt; - ä»ä¸€å·ç‚¹åˆ°ä»»ä½•ä¸€ä¸ªç‚¹çš„æœ€çŸ­è·¯å”¯ä¸€å¹¶ä¸”éšç€ç‚¹æ ‡å·ä¸Šå‡è€Œä¸é™.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;(ä¸¤ä¸ªå›¾ä¸åŒå½“ä¸”ä»…å½“è¾¹çš„é›†åˆä¸åŒ). &lt;span class=&quot;math inline&quot;&gt;\(N &amp;lt;= 50\)&lt;/span&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Combinatorial" scheme="http://yoursite.com/tags/Combinatorial/"/>
    
      <category term="Dynamic Programming" scheme="http://yoursite.com/tags/Dynamic-Programming/"/>
    
  </entry>
  
  <entry>
    <title>ZJOI2017 æ ‘çŠ¶æ•°ç»„</title>
    <link href="http://yoursite.com/2017/zjoi2017-bit/"/>
    <id>http://yoursite.com/2017/zjoi2017-bit/</id>
    <published>2017-06-12T12:04:19.000Z</published>
    <updated>2018-11-29T19:43:50.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="description">Description</h3><blockquote><p>ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º <span class="math inline">\(N\)</span> çš„åºåˆ—ä»¥åŠ <span class="math inline">\(M\)</span> æ¬¡æ“ä½œ, æ¯æ¬¡ç­‰æ¦‚ç‡åœ°ä¿®æ”¹ <span class="math inline">\([L_i, R_i]\)</span> åŒºé—´ä¸­ä¸€ä¸ªå€¼çš„å¥‡å¶æ€§, æˆ–è€…å¯¹äºè¯¢é—®<span class="math inline">\([L_i,R_i]\)</span>åŒºé—´ä¸­çš„å’Œçš„å¥‡å¶æ€§, åˆ¤æ–­ç»™å®šçš„ä¸€ç§é”™è¯¯ç®—æ³•è¾“å‡ºæ­£ç¡®ç­”æ¡ˆçš„æ¦‚ç‡æ˜¯å¤šå°‘ $ N, M &lt;= 10^5 $</p></blockquote><a id="more"></a><h3 id="solution">Solution</h3><p>è€ƒè™‘è¿™ä¸ªé”™è¯¯ç®—æ³•, ç”±äºå¯ä»¥æŠŠ $ + lowbit $ å’Œ $ - lowbit $ éƒ½çœ‹æˆåœ¨ä¸€æ£µæ ‘ä¸Šå‘çˆ¶äº²èŠ‚ç‚¹è·³, æ ¹æ®è¿™ä¸ªæ€§è´¨å¯ä»¥çŸ¥é“é”™è¯¯ç®—æ³•æ±‚äº†ä¸€ä¸ªåç¼€å’Œ, æ‰€ä»¥å½“ä¸”ä»…å½“å¯¹äºè¯¢é—®åŒºé—´ <span class="math inline">\([L_i, R_i]\)</span>, æ»¡è¶³ $ a[L_i-1] = a[R_i] $ æ—¶å®ƒä¼šè¾“å‡ºæ­£ç¡®ç­”æ¡ˆ</p><p>é‚£ä¹ˆæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª $ O(nm) $ çš„æš´åŠ›ç®—æ³•, å³æ¯ä¸€ä¸ªè¯¢é—®éƒ½æš´åŠ›æ‰«ä¹‹å‰çš„æ‰€æœ‰ä¿®æ”¹è®¡ç®—æ¦‚ç‡å³å¯.</p><p>ç„¶è€Œè¿™æ ·è¿˜ä¸èƒ½é€šè¿‡æ‰€æœ‰æ•°æ®, è€ƒè™‘å°†åŒºé—´ <span class="math inline">\([L_i, R_i]\)</span> è¡¨ç¤ºæˆäºŒç»´å¹³é¢ä¸Šçš„ä¸€ä¸ªç‚¹ $ (L_i, R_i)$.</p><p>ç„¶åç”¨ä¸€ä¸ªäºŒç»´çº¿æ®µæ ‘å»ç»´æŠ¤æ¯ä¸ªç‚¹ä»£è¡¨çš„ä¸¤ä¸ªç«¯ç‚¹çš„å€¼ä¸ç›¸ç­‰çš„æ¦‚ç‡.æ˜¾ç„¶åœ°, è¿™ä¸ªæ¦‚ç‡æ˜¯å¯ä»¥å¾ˆæ–¹ä¾¿çš„åˆå¹¶çš„. è¿™æ ·å¯¹äºæ¯æ¬¡ä¿®æ”¹<span class="math inline">\([L_i, R_i]\)</span>çš„æ“ä½œ, ç›¸å½“äº: - å°† $ x , y $ ä¸­çš„ç‚¹ <span class="math inline">\((x, y)\)</span> ä¸ $  $ åˆå¹¶. - å°† $ x , y (R_i, N] $ ä»¥åŠ $ x $ ä¸ $  $ åˆå¹¶.</p><h3 id="hint">Hint</h3><p>æ³¨æ„åˆ°å¯¹äº $ L_i = 1 $ çš„æƒ…å†µ, $ Find(0) $ ç›´æ¥è¿”å›äº† <span class="math inline">\(0\)</span> è€Œé <span class="math inline">\(0\)</span> çš„åç¼€å’Œ è¿™ä¸ªæ—¶å€™å°±è¦ç‰¹åˆ¤ä¸€ä¸‹äº†, æ³¨æ„åˆ°æ¯æ¬¡ä¸ç®¡å¦‚ä½•ä¿®æ”¹, æœ€ç»ˆçš„æ­£ç¡®ç­”æ¡ˆæ˜¯ <span class="math inline">\(R_i\)</span> çš„å‰ç¼€å’Œ, è€Œé¢˜ä¸­æ‰€ç»™çš„æ–¹æ³•è¾“å‡ºçš„ç­”æ¡ˆæ˜¯ <span class="math inline">\(R_i\)</span> çš„åç¼€å’Œ.</p><ul><li>å½“å‰ä¿®æ”¹æ¬¡æ•°ä¸ºå¶æ•°, åˆ™å½“ä¸”ä»…å½“ <span class="math inline">\(R_i = 0\)</span> å‰åç¼€å’Œç›¸åŒ, ç›¸å½“äºæŸ¥è¯¢ <span class="math inline">\(a[R_i] = 0\)</span> çš„æ¦‚ç‡.</li><li>å½“å‰ä¿®æ”¹æ¬¡æ•°ä¸ºå¥‡æ•°, åˆ™å½“ä¸”ä»…å½“ <span class="math inline">\(R_i = 1\)</span> å‰åç¼€å’Œç›¸åŒ, ç›¸å½“äºæŸ¥è¯¢ <span class="math inline">\(a[R_i] = 1\)</span> çš„æ¦‚ç‡.</li></ul><p>å› ä¸º <span class="math inline">\(a[0]\)</span> ä¸å¯èƒ½è¢«ä¿®æ”¹, æ‰€ä»¥ä¸Šè¿°é—®é¢˜ä¹Ÿå¯ä»¥è½¬åŒ–ä¸ºæŸ¥è¯¢ <span class="math inline">\([L_i, R_i]\)</span> ç›¸ç­‰æ¦‚ç‡.</p><h3 id="code">Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fst first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> snd second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> getchar getchar_unlocked</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">chkmax</span><span class="params">(T&amp; a, T b)</span> </span>&#123; <span class="keyword">return</span> a &lt; b ? a = b, <span class="number">1</span> : <span class="number">0</span>; &#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">chkmin</span><span class="params">(T&amp; a, T b)</span> </span>&#123; <span class="keyword">return</span> a &gt; b ? a = b, <span class="number">1</span> : <span class="number">0</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> oo = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar();</span><br><span class="line">    <span class="keyword">for</span>( ;!<span class="built_in">isdigit</span>(ch); ch = getchar()) <span class="keyword">if</span>(ch == <span class="string">'-'</span>) f = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>( ; <span class="built_in">isdigit</span>(ch); ch = getchar()) n = n * <span class="number">10</span> + ch - <span class="number">48</span>;</span><br><span class="line">    <span class="keyword">return</span> n * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (a * (<span class="number">1L</span>L - b + mod) % mod + b * (<span class="number">1L</span>L - a + mod) % mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> N, M, prob;</span><br><span class="line"><span class="keyword">namespace</span> Seg_Tree &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> SZ_X = (maxn &lt;&lt; <span class="number">2</span>) + <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> SZ_Y = (maxn * <span class="number">400</span>) + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> rt[SZ_X];</span><br><span class="line">    <span class="keyword">int</span> val[SZ_Y];</span><br><span class="line">    <span class="keyword">int</span> lc[SZ_Y], rc[SZ_Y], cnt;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LC (u &lt;&lt; 1) </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RC (LC | 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l+r) &gt;&gt; 1)</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Add_Y</span><span class="params">(<span class="keyword">int</span>&amp; u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!u) u = ++cnt;</span><br><span class="line">        <span class="keyword">if</span>(x &lt;= l &amp;&amp; r &lt;= y) &#123;</span><br><span class="line">            val[u] = merge(val[u], prob);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(x &lt;= mid) Add_Y(lc[u], l, mid, x, y);</span><br><span class="line">        <span class="keyword">if</span>(y &gt; mid) Add_Y(rc[u], mid+<span class="number">1</span>, r, x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Add_X</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> x0, <span class="keyword">int</span> y0)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(x &lt;= l &amp;&amp; r &lt;= y) &#123;</span><br><span class="line">            Add_Y(rt[u], <span class="number">0</span>, N, x0, y0);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(x &lt;= mid) Add_X(LC, l, mid, x, y, x0, y0);</span><br><span class="line">        <span class="keyword">if</span>(y &gt; mid) Add_X(RC, mid+<span class="number">1</span>, r, x, y, x0, y0);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query_Y</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l == r) <span class="keyword">return</span> val[u];</span><br><span class="line">        <span class="keyword">return</span> merge(val[u], </span><br><span class="line">                x &lt;= mid ? query_Y(lc[u], l, mid, x) : query_Y(rc[u], mid+<span class="number">1</span>, r, x));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query_X</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x, <span class="keyword">int</span> x0)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l == r) <span class="keyword">return</span> query_Y(rt[u], <span class="number">0</span>, N, x0);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> merge(query_Y(rt[u], <span class="number">0</span>, N, x0), </span><br><span class="line">                x &lt;= mid ? query_X(LC, l, mid, x, x0) : query_X(RC, mid+<span class="number">1</span>, r, x, x0));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fpm</span><span class="params">(<span class="keyword">int</span> base, <span class="keyword">int</span> <span class="built_in">exp</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; <span class="built_in">exp</span> &gt; <span class="number">0</span>; <span class="built_in">exp</span> &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">exp</span> &amp; <span class="number">1</span>) </span><br><span class="line">            res = <span class="number">1L</span>L * res * base % mod;</span><br><span class="line">        base = <span class="number">1L</span>L * base * base % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> tot = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    N = read(); M = read();</span><br><span class="line">    <span class="keyword">while</span>(M--) &#123;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">int</span> ty, l, r;</span><br><span class="line">        ty = read(); l = read(); r = read();</span><br><span class="line">        <span class="keyword">if</span>(ty == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">static</span> LL tmp; </span><br><span class="line">            tmp = fpm(r-l+<span class="number">1</span>, mod<span class="number">-2</span>);</span><br><span class="line">            prob = <span class="number">2</span>*tmp; Seg_Tree::Add_X(<span class="number">1</span>, <span class="number">0</span>, N, l, r, l, r); </span><br><span class="line">            prob = tmp; Seg_Tree::Add_X(<span class="number">1</span>, <span class="number">0</span>, N, l, r, r+<span class="number">1</span>, N);</span><br><span class="line">            prob = tmp; Seg_Tree::Add_X(<span class="number">1</span>, <span class="number">0</span>, N, <span class="number">0</span>, l<span class="number">-1</span>, l, r);</span><br><span class="line">            ++ tot;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">static</span> <span class="keyword">int</span> ans;</span><br><span class="line">            ans = (<span class="number">1</span>-Seg_Tree::query_X(<span class="number">1</span>, <span class="number">0</span>, N, l<span class="number">-1</span>, r)+mod) % mod;</span><br><span class="line">            <span class="keyword">if</span>(!(l<span class="number">-1</span>) &amp;&amp; (tot &amp; <span class="number">1</span>))</span><br><span class="line">                ans = (<span class="number">1</span>-ans+mod) % mod;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></span><br><span class="line">    freopen(<span class="string">"data.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    freopen(<span class="string">"ans.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    solve();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;description&quot;&gt;Description&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&quot;math inline&quot;&gt;\(N\)&lt;/span&gt; çš„åºåˆ—ä»¥åŠ &lt;span class=&quot;math inline&quot;&gt;\(M\)&lt;/span&gt; æ¬¡æ“ä½œ, æ¯æ¬¡ç­‰æ¦‚ç‡åœ°ä¿®æ”¹ &lt;span class=&quot;math inline&quot;&gt;\([L_i, R_i]\)&lt;/span&gt; åŒºé—´ä¸­ä¸€ä¸ªå€¼çš„å¥‡å¶æ€§, æˆ–è€…å¯¹äºè¯¢é—®&lt;span class=&quot;math inline&quot;&gt;\([L_i,R_i]\)&lt;/span&gt;åŒºé—´ä¸­çš„å’Œçš„å¥‡å¶æ€§, åˆ¤æ–­ç»™å®šçš„ä¸€ç§é”™è¯¯ç®—æ³•è¾“å‡ºæ­£ç¡®ç­”æ¡ˆçš„æ¦‚ç‡æ˜¯å¤šå°‘ $ N, M &amp;lt;= 10^5 $&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Data Structure" scheme="http://yoursite.com/tags/Data-Structure/"/>
    
  </entry>
  
  <entry>
    <title>NOI2016 ç½‘æ ¼</title>
    <link href="http://yoursite.com/2017/noi2016-grid/"/>
    <id>http://yoursite.com/2017/noi2016-grid/</id>
    <published>2017-06-10T06:36:06.000Z</published>
    <updated>2018-11-29T19:43:50.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="description">Description</h3><blockquote><p>ç»™å‡ºä¸€ä¸ª $ N M $ çš„ç½‘æ ¼å›¾å’Œå›¾ä¸Šçš„ $ C $ ä¸ªéšœç¢ç‰©, æ±‚æœ€å°‘åˆ å»å¤šå°‘ä¸ªç‚¹å¯ä½¿å¾—åŸå›¾ç©ºæ ¼ä¸å››è¿é€š. $ N, M &lt;= 10 ^ 9, C &lt;= 10 ^ 5 $</p></blockquote><a id="more"></a><h3 id="solution">Solution</h3><p>æˆ‘ä»¬å¯ä»¥å‘ç°, å¯èƒ½çš„ç­”æ¡ˆåªæœ‰ $ { -1, 0, 1, 2 } $ å‡ ç§.</p><p>è€ƒè™‘ä¸€äº›ç®€å•çš„æƒ…å†µ: ç­”æ¡ˆç­‰äº $ -1 $ æ—¶, ç‚¹æ•°å°äº <span class="math inline">\(2\)</span> æˆ–è€…æ°å¥½æœ‰ä¸¤ä¸ªç›¸é‚»çš„ç‚¹. ç­”æ¡ˆä¸º $ 0 $ æ—¶, æ˜¾ç„¶åŸå›¾ä¸è¿é€š.</p><p>é‚£ä¹ˆå°±åªéœ€çŸ¥é“ç­”æ¡ˆæ˜¯å¦ä¸º $ 1 $, å‘ç°ç­”æ¡ˆç­‰äº $ 1 $ å½“ä¸”ä»…å½“åŸå›¾å­˜åœ¨å‰²ç‚¹, æš´åŠ›çš„è¯ä¸éš¾åšåˆ° $ O(n * m) $.</p><p>å°†åˆ°è¾¾æ¯ä¸ªéšœç¢çš„æ›¼å“ˆé¡¿è·ç¦»ä¸è¶…è¿‡ <span class="math inline">\(2\)</span> çš„ç©ºæ ¼ç»™æå‡ºæ¥, ç„¶ååœ¨è¿™äº›ç‚¹ä¸­æ‰¾å‡ºä¸€ä¸ªå‰²ç‚¹, æ»¡è¶³åˆ°è¾¾æœ€è¿‘çš„éšœç¢çš„è·ç¦»ä¸è¶…è¿‡ <span class="math inline">\(1\)</span>.<br>è¿™æ ·çš„ç‚¹å°±ä¸€å®šæ˜¯åŸå›¾ä¸­çš„å‰²ç‚¹.</p><h3 id="code">Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fst first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> snd second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmax</span><span class="params">(T&amp; a, T b)</span> </span>&#123; <span class="keyword">return</span> a &lt; b ? a = b, <span class="number">1</span> : <span class="number">0</span>; &#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmin</span><span class="params">(T&amp; a, T b)</span> </span>&#123; <span class="keyword">return</span> a &gt; b ? a = b, <span class="number">1</span> : <span class="number">0</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2.5e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> oo = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="function">T <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    T n = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar();</span><br><span class="line">    <span class="keyword">for</span>( ;!<span class="built_in">isdigit</span>(ch); ch = getchar()) <span class="keyword">if</span>(ch == <span class="string">'-'</span>) f = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>( ; <span class="built_in">isdigit</span>(ch); ch = getchar()) n = n * <span class="number">10</span> + ch - <span class="number">48</span>;</span><br><span class="line">    <span class="keyword">return</span> n * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Hash_Map</span> &#123;</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1666667</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> st[mod], nxt[maxn], X[maxn], Y[maxn];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(st, <span class="number">0</span>, <span class="keyword">sizeof</span> st);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">idx</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ((<span class="number">233L</span>L*x + (y^<span class="number">888</span>))%mod + mod)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> u = idx(x, y);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = st[u]; i; i = nxt[i]) </span><br><span class="line">            <span class="keyword">if</span>(X[i] == x &amp;&amp; Y[i] == y) </span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> u = idx(x, y);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = st[u]; i; i = nxt[i]) </span><br><span class="line">            <span class="keyword">if</span>(X[i] == x &amp;&amp; Y[i] == y) </span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line"></span><br><span class="line">        ++ cnt;</span><br><span class="line">        X[cnt] = x, Y[cnt] = y;</span><br><span class="line">        nxt[cnt] = st[u]; st[u] = cnt;</span><br><span class="line">        <span class="keyword">return</span> cnt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;HM;</span><br><span class="line"></span><br><span class="line">LL n, m, c;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> dx[] = &#123; <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">-1</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> dy[] = &#123; <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">1</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> st[maxn], nxt[maxn &lt;&lt; <span class="number">3</span>], to[maxn &lt;&lt; <span class="number">3</span>], ecnt = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; </span><br><span class="line">    to[++ecnt] = y; nxt[ecnt] = st[x]; st[x] = ecnt;</span><br><span class="line">    to[++ecnt] = x; nxt[ecnt] = st[y]; st[y] = ecnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> vis[maxn];</span><br><span class="line"><span class="keyword">int</span> mark[maxn], now = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ecnt = <span class="number">1</span>;</span><br><span class="line">    HM.clear();</span><br><span class="line">    <span class="built_in">memset</span>(st, <span class="number">0</span>, <span class="keyword">sizeof</span> st);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">flood_fill</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    mark[u] = now;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = st[u], v; i; i = nxt[i]) <span class="keyword">if</span>(mark[v = to[i]] != now) </span><br><span class="line">        res += flood_fill(v);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">area_count</span><span class="params">(<span class="keyword">int</span> s)</span> </span>&#123; <span class="keyword">return</span> ++ now, flood_fill(s); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">chk</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n*m-c &lt; <span class="number">2</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">int</span> res = area_count(c + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(n*m == <span class="number">2</span> || (res == <span class="number">2</span> &amp;&amp; n*m-c == <span class="number">2</span>)) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> flag;</span><br><span class="line"><span class="keyword">int</span> dfn[maxn], low[maxn], dfs_clock = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa, <span class="keyword">bool</span> f = <span class="literal">false</span>)</span> </span>&#123;</span><br><span class="line">    low[u] = dfn[u] = ++dfs_clock;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = st[u], v; i; i = nxt[i]) <span class="keyword">if</span>((v = to[i]) ^ fa) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!dfn[v]) &#123;</span><br><span class="line">            <span class="keyword">if</span>(dfs(v, u)) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(vis[u] == <span class="number">1</span> &amp;&amp; (low[v] &gt; dfn[u] || (!f &amp;&amp; low[v] == dfn[u]))) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            chkmin(low[u], low[v]);</span><br><span class="line">        &#125;<span class="keyword">else</span> chkmin(low[u], dfn[v]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chk1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    flag = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(dfn, dfs_clock = <span class="number">0</span>, <span class="keyword">sizeof</span> dfn);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = c+<span class="number">1</span>; i &lt;= HM.cnt; i++) <span class="keyword">if</span>(!dfn[i]) &#123;</span><br><span class="line">        <span class="keyword">if</span>(dfs(i, <span class="number">0</span>, <span class="number">1</span>)) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> x(i) HM.X[i]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> y(i) HM.Y[i]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//char ch[1000][1000];</span></span><br><span class="line"><span class="keyword">int</span> X[maxn], Y[maxn], idx[maxn];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chk0</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(idx, <span class="number">0</span>, <span class="keyword">sizeof</span> idx);</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span> vis);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= c; i++) HM.insert(X[i], Y[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> v = <span class="number">1</span>; v &lt;= c; v++) <span class="keyword">if</span>(!vis[v]) &#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; V;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">int</span> q[maxn];</span><br><span class="line">        <span class="keyword">int</span> head = <span class="number">0</span>, tail = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        ecnt = <span class="number">1</span>;</span><br><span class="line">        vis[q[tail++] = v] = <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">while</span>(head &lt; tail) &#123;</span><br><span class="line">            <span class="keyword">int</span> h = q[head++];</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">int</span> nx = x(h) + dx[i];</span><br><span class="line">                <span class="keyword">int</span> ny = y(h) + dy[i];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(nx &gt;= <span class="number">1</span> &amp;&amp; nx &lt;= n &amp;&amp; ny &gt;= <span class="number">1</span> &amp;&amp; ny &lt;= m) &#123;</span><br><span class="line">                    <span class="keyword">int</span> Nxt = HM.insert(nx, ny);</span><br><span class="line"></span><br><span class="line">                    st[Nxt] = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">if</span>(Nxt &lt;= c) &#123;</span><br><span class="line">                        <span class="keyword">if</span>(!vis[Nxt]) &#123;</span><br><span class="line">                            vis[Nxt] = <span class="number">3</span>;</span><br><span class="line">                            q[tail++] = Nxt;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(idx[Nxt] != v) &#123;</span><br><span class="line">                        idx[Nxt] = v, V.pb(Nxt);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">int</span>(V.size()); i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> u = V[i];</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">2</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">int</span> nx = x(u) + dx[j];</span><br><span class="line">                <span class="keyword">int</span> ny = y(u) + dy[j];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(nx &gt;= <span class="number">1</span> &amp;&amp; nx &lt;= n &amp;&amp; ny &gt;= <span class="number">1</span> &amp;&amp; ny &lt;= m) &#123;</span><br><span class="line">                    <span class="keyword">int</span> Nxt = HM.find(nx, ny);</span><br><span class="line">                    <span class="keyword">if</span>(idx[Nxt] == v) addedge(u, Nxt);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(V.size() &amp;&amp; area_count(V[<span class="number">0</span>]) != <span class="keyword">int</span>(V.size()))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span> vis);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> tail = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> q[maxn];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= c; i++) </span><br><span class="line">        HM.insert(X[i], Y[i]), vis[i] = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= c; i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">int</span> nx = X[i] + dx[j];</span><br><span class="line">            <span class="keyword">int</span> ny = Y[i] + dy[j];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(nx &gt;= <span class="number">1</span> &amp;&amp; nx &lt;= n &amp;&amp; ny &gt;= <span class="number">1</span> &amp;&amp; ny &lt;= m) &#123;</span><br><span class="line">                <span class="keyword">int</span> Nxt = HM.insert(nx, ny);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(!vis[Nxt]) &#123;</span><br><span class="line">                    vis[Nxt] = <span class="number">1</span>;</span><br><span class="line">                    q[tail++] = Nxt;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> lim = tail;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; lim; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">int</span> nx = x(q[i]) + dx[j];</span><br><span class="line">            <span class="keyword">int</span> ny = y(q[i]) + dy[j];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(nx &gt;= <span class="number">1</span> &amp;&amp; nx &lt;= n &amp;&amp; ny &gt;= <span class="number">1</span> &amp;&amp; ny &lt;= m) &#123;</span><br><span class="line">                <span class="keyword">int</span> Nxt = HM.insert(nx, ny);</span><br><span class="line">                <span class="keyword">if</span>(!vis[Nxt]) &#123;</span><br><span class="line">                    vis[Nxt] = <span class="number">2</span>;</span><br><span class="line">                    q[tail++] = Nxt;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tail; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">2</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">int</span> nx = x(q[i]) + dx[j];</span><br><span class="line">            <span class="keyword">int</span> ny = y(q[i]) + dy[j];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(nx &gt;= <span class="number">1</span> &amp;&amp; nx &lt;= n &amp;&amp; ny &gt;= <span class="number">1</span> &amp;&amp; ny &lt;= m) &#123;</span><br><span class="line">                <span class="keyword">int</span> Nxt = HM.find(nx, ny);</span><br><span class="line">                <span class="keyword">if</span>(Nxt &gt; c) addedge(q[i], Nxt);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">spe</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(n == <span class="number">1</span>) &#123;</span><br><span class="line">        Y[++c] = <span class="number">0</span>; Y[++c] = m+<span class="number">1</span>; sort(Y+<span class="number">1</span>, Y+c+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= c; i++) <span class="keyword">if</span>(Y[i] - Y[i<span class="number">-1</span>] &gt; <span class="number">1</span>) ++ res;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        X[++c] = <span class="number">0</span>; X[++c] = n+<span class="number">1</span>; sort(X+<span class="number">1</span>, X+c+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= c; i++) <span class="keyword">if</span>(X[i] - X[i<span class="number">-1</span>] &gt; <span class="number">1</span>) ++ res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res &gt;= <span class="number">2</span> ? <span class="number">0</span> : <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></span><br><span class="line">    freopen(<span class="string">"data.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    freopen(<span class="string">"ans.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> T = read&lt;<span class="keyword">int</span>&gt;(); T--; ) &#123;</span><br><span class="line"></span><br><span class="line">        init();</span><br><span class="line"></span><br><span class="line">        n = read&lt;<span class="keyword">int</span>&gt;();</span><br><span class="line">        m = read&lt;<span class="keyword">int</span>&gt;();</span><br><span class="line">        c = read&lt;<span class="keyword">int</span>&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= c; i++) &#123;</span><br><span class="line">            X[i] = read&lt;<span class="keyword">int</span>&gt;();</span><br><span class="line">            Y[i] = read&lt;<span class="keyword">int</span>&gt;();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(chk0()) &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"0"</span>);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        init();</span><br><span class="line">        build();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">int</span> ans;</span><br><span class="line">        <span class="keyword">if</span>((ans = chk()) != <span class="number">-2</span>) &#123; &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(min(n, m) == <span class="number">1</span>) &#123; ans = spe(); &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            ans = chk1() ? <span class="number">1</span> : <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span>(c == <span class="number">0</span>) ans = min(n, m) == <span class="number">1</span> ? <span class="number">1</span> : <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;description&quot;&gt;Description&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å‡ºä¸€ä¸ª $ N M $ çš„ç½‘æ ¼å›¾å’Œå›¾ä¸Šçš„ $ C $ ä¸ªéšœç¢ç‰©, æ±‚æœ€å°‘åˆ å»å¤šå°‘ä¸ªç‚¹å¯ä½¿å¾—åŸå›¾ç©ºæ ¼ä¸å››è¿é€š. $ N, M &amp;lt;= 10 ^ 9, C &amp;lt;= 10 ^ 5 $&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Graph Theory" scheme="http://yoursite.com/tags/Graph-Theory/"/>
    
  </entry>
  
  <entry>
    <title>Codeforces 553E Kyoya and Train</title>
    <link href="http://yoursite.com/2017/cf-553e/"/>
    <id>http://yoursite.com/2017/cf-553e/</id>
    <published>2017-05-03T13:21:27.000Z</published>
    <updated>2020-07-14T12:09:41.580Z</updated>
    
    <content type="html"><![CDATA[<h3 id="description">Description</h3><blockquote><p>ç»™å®š <span class="math inline">\(N\)</span> ä¸ªç‚¹, <span class="math inline">\(M\)</span> æ¡è¾¹çš„æœ‰å‘å›¾.</p></blockquote><p>æ¯æ¡è¾¹æœ‰èŠ±è´¹: é€šè¿‡ç¬¬ <span class="math inline">\(i\)</span> æ¡è¾¹çš„æ—¶é—´æœ‰ $ P _ {i1} $ çš„æ¦‚ç‡ä¸º <span class="math inline">\(1\)</span>, <span class="math inline">\(P _ {i2}\)</span> çš„æ¦‚ç‡ä¸º <span class="math inline">\(2\)</span>... å¦‚æœæ€»ç”¨æ—¶è¶…è¿‡ <span class="math inline">\(T\)</span> åˆ™ä¼šè¢«ç½šé’± <span class="math inline">\(X\)</span> å…ƒ, æ±‚ä» <span class="math inline">\(1\)</span> å·ç‚¹åˆ° <span class="math inline">\(n\)</span> å·ç‚¹çš„æœ€å°æœŸæœ›èŠ±è´¹. $ N , M , T  $</p><h3 id="solution">Solution</h3><p>è€ƒè™‘æš´åŠ›DP, è®°çŠ¶æ€ $ dp _ {i, t} $ è¡¨ç¤ºåˆ°è¾¾ <span class="math inline">\(i\)</span> å·ç‚¹, ä¸”ç»è¿‡çš„æ—¶é—´ä¸º <span class="math inline">\(t\)</span> çš„æœ€å°æœŸæœ›èŠ±è´¹, è½¬ç§»ååˆ†æ˜¾ç„¶. åŒæ—¶å› ä¸ºçŠ¶æ€ä¹‹é—´æŒ‰ç…§æ—¶é—´æ„æˆä¸€ä¸ªæ‹“æ‰‘å›¾, æ‰€ä»¥è½¬ç§»ä¸å­˜åœ¨ç¯.</p><a id="more"></a><p>å¯ä»¥è®° <span class="math inline">\(S_{e, t}\)</span> è¡¨ç¤ºè¾¹ <span class="math inline">\(e\)</span> åœ¨æ—¶åˆ» <span class="math inline">\(t\)</span> ä¹‹ååç»§çŠ¶æ€çš„æœ€å°æœŸæœ›èŠ±è´¹. åˆ™å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªå¼å­è®¡ç®— <span class="math inline">\(dp _ {e, t}\)</span>:</p><p><span class="math display">\[d_{i, t} = \min \left\{ S_{e, t} + cost_e \right\}\]</span></p><p><span class="math inline">\(e\)</span> æ˜¯ <span class="math inline">\(i\)</span> çš„å‡ºè¾¹.</p><p>æ¥ä¸‹æ¥è€ƒè™‘å¦‚ä½•è®¡ç®— <span class="math inline">\(S(e,t)\)</span>, åˆ©ç”¨å®šä¹‰:</p><p><span class="math display">\[S_{e, t} = \sum_{i = 1}^{T} dp_{to_e, t+i} * P_{ei}\]</span></p><p>è¿™æ ·å˜æˆå·ç§¯å½¢å¼, åˆ†æ²» <span class="math inline">\(FFT\)</span> å³å¯.</p><h3 id="code">Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> oo = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">200000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmax</span><span class="params">(T&amp; a, T b)</span> </span>&#123; <span class="keyword">return</span> a &lt; b ? a = b, <span class="number">1</span> : <span class="number">0</span>; &#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">bool</span> <span class="title">chkmin</span><span class="params">(T&amp; a, T b)</span> </span>&#123; <span class="keyword">return</span> a &gt; b ? a = b, <span class="number">1</span> : <span class="number">0</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fst first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> snd second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="meta-string">":"</span> &lt;&lt; (x) &lt;&lt; endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, a, b) for(int i = (a), i##end = (b); i &lt; i##end; ++i)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DREP(i, a, b) for(int i = (a)-1, i##bgn = (b); i &gt;= i##bgn; --i)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="function">T <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    T n = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = getchar();</span><br><span class="line">    <span class="keyword">for</span>( ;!<span class="built_in">isdigit</span>(ch); ch = getchar()) <span class="keyword">if</span>(ch == <span class="string">'-'</span>) f = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>( ; <span class="built_in">isdigit</span>(ch); ch = getchar()) n = n * <span class="number">10</span> + ch - <span class="number">48</span>;</span><br><span class="line">    <span class="keyword">return</span> n * f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Complex</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> real, imag;</span><br><span class="line">    Complex(<span class="keyword">double</span> r = <span class="number">0.0</span>, <span class="keyword">double</span> i = <span class="number">0.0</span>): real(r), imag(i) &#123;&#125;</span><br><span class="line">    Complex <span class="keyword">operator</span> + (<span class="keyword">const</span> Complex&amp; rhs) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Complex(real + rhs.real, imag + rhs.imag);</span><br><span class="line">    &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span> - (<span class="keyword">const</span> Complex&amp; rhs) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Complex(real - rhs.real, imag - rhs.imag);</span><br><span class="line">    &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span> * (<span class="keyword">const</span> Complex&amp; rhs) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Complex(real*rhs.real - imag*rhs.imag, real*rhs.imag + imag*rhs.real);</span><br><span class="line">    &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span> / (<span class="keyword">const</span> <span class="keyword">double</span>&amp; div) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Complex(real / div, imag / div);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> rev[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFT</span><span class="params">(Complex *x, <span class="keyword">int</span> N, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) </span><br><span class="line">        <span class="keyword">if</span>(i &lt; rev[i]) swap(x[i], x[rev[i]]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> l = <span class="number">2</span>; l &lt;= N; l &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        Complex wn = Complex(<span class="built_in">cos</span>(<span class="number">2</span>*PI*t/l), <span class="built_in">sin</span>(<span class="number">2</span>*PI*t/l));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i += l) &#123;</span><br><span class="line">            Complex w = Complex(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; (l &gt;&gt; <span class="number">1</span>); j++, w = w * wn) &#123;</span><br><span class="line">                Complex L = x[i + j];</span><br><span class="line">                Complex R = x[i + j + (l &gt;&gt; <span class="number">1</span>)] * w;</span><br><span class="line">                x[i + j] = L + R;</span><br><span class="line">                x[i + j + (l &gt;&gt; <span class="number">1</span>)] = L - R;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!~t) <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) x[i] = x[i] / N;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> dis[N][N];</span><br><span class="line"><span class="keyword">int</span> n, m, t, x;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> u, v, c;</span><br><span class="line">    <span class="keyword">double</span> p[maxn];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        u = read&lt;<span class="keyword">int</span>&gt;(), v = read&lt;<span class="keyword">int</span>&gt;(), c = read&lt;<span class="keyword">int</span>&gt;();</span><br><span class="line"></span><br><span class="line">        chkmin(dis[u][v], c);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= t; i++) p[i] = <span class="keyword">double</span>(read&lt;<span class="keyword">int</span>&gt;()) / <span class="number">100000.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;E[N];</span><br><span class="line"></span><br><span class="line">Complex A[maxn], B[maxn];</span><br><span class="line"><span class="keyword">double</span> S[N][maxn], f[N][maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> mid)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> base, len;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; m; k++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = E[k].v;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(base = <span class="number">1</span>, len = <span class="number">0</span>; base &lt;= <span class="number">2</span>*r-l-mid+<span class="number">1</span>; base &lt;&lt;= <span class="number">1</span>) ++ len;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; base; i++) rev[i] = (rev[i&gt;&gt;<span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i&amp;<span class="number">1</span>) &lt;&lt; (len<span class="number">-1</span>));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; base; i++) A[i] = B[i] = Complex(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; r-mid; i++) A[i] = Complex(f[v][r-i], <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= r-l; i++) B[i<span class="number">-1</span>] = Complex(E[k].p[i], <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        DFT(A, base, <span class="number">1</span>); DFT(B, base, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; base; i++) A[i] = A[i] * B[i];</span><br><span class="line">        DFT(A, base, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = l; i &lt;= mid; i++) S[k][i] += A[r-i<span class="number">-1</span>].real;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cdq_solve</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) </span><br><span class="line">            chkmin(f[E[i].u][l], S[i][l] + E[i].c);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    cdq_solve(mid+<span class="number">1</span>, r);</span><br><span class="line">    calc(l, r, mid);</span><br><span class="line">    cdq_solve(l, mid);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></span><br><span class="line">    freopen(<span class="string">"data.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    freopen(<span class="string">"ans.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(dis, oo, <span class="keyword">sizeof</span> dis);</span><br><span class="line">    n = read&lt;<span class="keyword">int</span>&gt;(), m = read&lt;<span class="keyword">int</span>&gt;(), t = read&lt;<span class="keyword">int</span>&gt;(), x = read&lt;<span class="keyword">int</span>&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) dis[i][i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) E[i].input();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) </span><br><span class="line">                chkmin(dis[i][j], dis[i][k] + dis[k][j]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> T = <span class="number">0</span>; T &lt;= t; T++) f[i][T] = (i == n) ? <span class="number">0</span> : oo;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> T = t+<span class="number">1</span>; T &lt;= <span class="number">2</span>*t; T++) f[i][T] = dis[i][n] + x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    calc(<span class="number">1</span>, t*<span class="number">2</span>, t);</span><br><span class="line">    cdq_solve(<span class="number">0</span>, t);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.10lf\n"</span>, f[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;description&quot;&gt;Description&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&quot;math inline&quot;&gt;\(N\)&lt;/span&gt; ä¸ªç‚¹, &lt;span class=&quot;math inline&quot;&gt;\(M\)&lt;/span&gt; æ¡è¾¹çš„æœ‰å‘å›¾.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ¯æ¡è¾¹æœ‰èŠ±è´¹: é€šè¿‡ç¬¬ &lt;span class=&quot;math inline&quot;&gt;\(i\)&lt;/span&gt; æ¡è¾¹çš„æ—¶é—´æœ‰ $ P _ {i1} $ çš„æ¦‚ç‡ä¸º &lt;span class=&quot;math inline&quot;&gt;\(1\)&lt;/span&gt;, &lt;span class=&quot;math inline&quot;&gt;\(P _ {i2}\)&lt;/span&gt; çš„æ¦‚ç‡ä¸º &lt;span class=&quot;math inline&quot;&gt;\(2\)&lt;/span&gt;... å¦‚æœæ€»ç”¨æ—¶è¶…è¿‡ &lt;span class=&quot;math inline&quot;&gt;\(T\)&lt;/span&gt; åˆ™ä¼šè¢«ç½šé’± &lt;span class=&quot;math inline&quot;&gt;\(X\)&lt;/span&gt; å…ƒ, æ±‚ä» &lt;span class=&quot;math inline&quot;&gt;\(1\)&lt;/span&gt; å·ç‚¹åˆ° &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; å·ç‚¹çš„æœ€å°æœŸæœ›èŠ±è´¹. $ N , M , T  $&lt;/p&gt;
&lt;h3 id=&quot;solution&quot;&gt;Solution&lt;/h3&gt;
&lt;p&gt;è€ƒè™‘æš´åŠ›DP, è®°çŠ¶æ€ $ dp _ {i, t} $ è¡¨ç¤ºåˆ°è¾¾ &lt;span class=&quot;math inline&quot;&gt;\(i\)&lt;/span&gt; å·ç‚¹, ä¸”ç»è¿‡çš„æ—¶é—´ä¸º &lt;span class=&quot;math inline&quot;&gt;\(t\)&lt;/span&gt; çš„æœ€å°æœŸæœ›èŠ±è´¹, è½¬ç§»ååˆ†æ˜¾ç„¶. åŒæ—¶å› ä¸ºçŠ¶æ€ä¹‹é—´æŒ‰ç…§æ—¶é—´æ„æˆä¸€ä¸ªæ‹“æ‰‘å›¾, æ‰€ä»¥è½¬ç§»ä¸å­˜åœ¨ç¯.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Dynamic Programming" scheme="http://yoursite.com/tags/Dynamic-Programming/"/>
    
      <category term="Probability" scheme="http://yoursite.com/tags/Probability/"/>
    
      <category term="Generating Function" scheme="http://yoursite.com/tags/Generating-Function/"/>
    
  </entry>
  
</feed>
